var n="login",r="",h="",a="";function onSubmit(i){return new Promise(function(e,t){"login"==n?B("newLogin",{email:r,pass:h,token:i}):"reg"==n&&B("newSignup",{user:a,email:r,pass:h,token:i}),grecaptcha.reset(),e()})}function e(e,t){var i=document.createElement("a");i.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),i.setAttribute("download",e),document.createEvent?((t=document.createEvent("MouseEvents")).initEvent("click",!0,!0),i.dispatchEvent(t)):i.click()}var o=io(),Vt=0;function Mt(){return xe?0:navigator.userAgent.match(new RegExp("firefox","i"))?33*Vt:Vt}function p(){open("https://discord.gg/B77pTZp")}function b(){open("https://www.patreon.com/tetrogem")}function t(e){open(e)}function x(e){return!0}window.addEventListener("wheel",e=>{Vt=e.deltaY,e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},{passive:!1});var w,l,qt=!1,f=!1,d=!1,C=!1,y=!1,E=!1,P=!1,S=!1,Zt=!1,jt=!1,R=!1,k=!1,Gt=!1,N=!1,Q=!1,Yt=!1,I=!1,A=!1,F=(window.addEventListener("keydown",e=>{"F11"!==e.code&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation());var t=window.navigator.platform.match("Mac")?e.metaKey:e.ctrlKey;if(!_o.active)if(ft.pressed.push(e),ft.pressedTime=millis(),e.code,"ScrollLock"==e.code&&(e.preventDefault(),y=!0),t&&"KeyC"==e.code&&(e.preventDefault(),Zt=!0),t&&"KeyV"==e.code&&(e.preventDefault(),jt=!0),t&&"KeyA"==e.code&&(e.preventDefault(),I=!0),N=t,"Pause"==e.code&&(e.preventDefault(),P=!0),8==e.keyCode&&(R=!0,e.preventDefault()),46==e.keyCode&&(k=!0,e.preventDefault()),Gt=e.shiftKey,Yt=e.altKey,"AltGraph"===e.key&&(Q=!0),t&&"KeyX"==e.code&&(e.preventDefault(),A=!0),"PrintScreen"==e.code&&(e.preventDefault(),d=!0),t&&"KeyQ"==e.code&&(e.preventDefault(),f=!0),t&&83==e.keyCode&&(e.preventDefault(),qt=!0),"Escape"===e.code&&(Le=!0),Nt.active)"Enter"===e.key||"NumpadEnter"===e.key?ki("submit"):"ArrowLeft"===e.key?!1===Nt.anchor&&Gt?(Nt.anchor=Nt.cursor,Nt.cursor--,Gt=!1):!1===Nt.anchor||Gt?Nt.cursor--:(Nt.cursor=Nt.cursor>Nt.anchor?Nt.anchor:Nt.cursor,Nt.anchor=!1):"ArrowRight"===e.key?!1===Nt.anchor&&Gt?(Nt.anchor=Nt.cursor,Nt.cursor++,Gt=!1):!1===Nt.anchor||Gt?Nt.cursor++:(Nt.cursor=Nt.cursor<Nt.anchor?Nt.anchor:Nt.cursor,Nt.anchor=!1):!("Delete"!==e.key&&"Backspace"!==e.key&&!I&!Zt)||A||jt||"ControlLeft"===e.key||"ControlRight"===e.key||"AltLeft"===e.key||"AltRight"===e.key||"ShiftLeft"===e.key||"ShiftRight"===e.key||"CapsLock"===e.key||"ArrowUp"===e.key||"ArrowDown"===e.key||"Home"===e.key||"End"===e.key||"PageUp"===e.key||"PageDown"===e.key||"ScrollLock"===e.code||"NumLock"===e.key||"Tab"===e.key||"Insert"===e.key||N&&!Q||Dn(ys(e.key));else if("menu"!==He||"c"!==key.toString().toLowerCase()||"05d4ce4f-a3c1-4632-a792-6381ecece78e"!==T.uuid&&!Xe.active||Ri({var:[Xe,"replayID"],title:["Replay ID"],type:"string",allowEmpty:!0,after:function(){0<Xe.replayID.length&&B("findReplayByID",{id:Xe.replayID})}}),"game"===He){if(!1===Tt.edit&&!Tt.failed&&!Tt.paused){if(!Tt.replay.on&&!Tt.mods.auto)for(var i=0;i<Tt.keys.length;i++)if(Array.isArray(Tt.keys[i]))for(var o=0;o<Tt.keys[i].length;o++)e.code===Tt.keys[i][o]&&xn(i);else e.code===Tt.keys[i]&&xn(i);"Backquote"===e.code&&(Tt.showGUI=!Tt.showGUI),"Backspace"===e.code&&(Tt.retry=!0,Tt.quickRetry=!0)}!0===Tt.edit&&(Tt.timelineBPM,Tt.bpm,"ArrowRight"!==e.code&&"KeyD"!==e.code||qn("RIGHT",e.shiftKey,e.altKey),"ArrowLeft"!==e.code&&"KeyA"!==e.code||qn("LEFT",e.shiftKey,e.altKey),"Space"===e.code&&en(),"Backquote"===e.code&&(Tt.showGUI=!Tt.showGUI),"KeyQ"===e.code&&kn("objType"),"KeyE"===e.code&&kn("editMode"),"KeyR"===e.code&&kn("holdLength"),"KeyF"===e.code&&kn("clickMode"),"KeyS"!==e.code||qt||kn("timelineSnap"))}}),window.addEventListener("keyup",t=>{if(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),"ScrollLock"==t.code&&(t.preventDefault(),E=!0),"Pause"==t.code&&(t.preventDefault(),S=!0),"PrintScreen"==t.code&&(t.preventDefault(),C=!0),ft.pressed=ft.pressed.filter(e=>e.key!==t.key),ft.pressedTime=!1,"ShiftLeft"!==t.code&&"ShiftRight"!==t.code||(Gt=!1),"ControlLeft"!==t.code&&"ControlRight"!==t.code||(N=!1),"AltRight"!==t.code&&"AltGraph"!==t.key||(Q=!1),"AltLeft"!==t.code&&"AltRight"!==t.code||(Yt=!1),1===Tt.disMode&&!Tt.edit&&!Tt.replay.on&&!Tt.mods.auto)for(var e=0;e<Tt.keys.length;e++)if(Array.isArray(Tt.keys[e]))for(var i=0;i<Tt.keys[e].length;i++)t.code===Tt.keys[e][i]&&bn(e);else t.code===Tt.keys[e]&&bn(e)}),window.addEventListener("blur",()=>{Yt=Q=N=Gt=!1}),document.addEventListener("contextmenu",e=>e.preventDefault()),window.onbeforeunload=function(e){if(!We.client||We.client&&!Be)return(e=e||window.event)&&(e.returnValue="Are you sure you want to leave this page?"),"Are you sure you want to leave this page?"},{}),D={};function X(e){if(void 0!==e)return JSON.parse(JSON.stringify(e))}function Jt(e,t){return F[Qe?"en":t]?.[e]??F.en[e]}function Pt(e,t,i,o,n,s,r){t=F[Qe?"en":t];return t?(t[e]??F.en[e])?.replace("`1`",i).replace("`2`",o).replace("`3`",n).replace("`4`",s).replace("`5`",r)??"[NOTFOUND]"+e:"Loading..."}function W(e,t,i,o,n){if(t+="C",void 0===e)return Pt("menu_account_countryUndefined",xt);void 0===D[t]||void 0===D[t][e]||void 0===D[t][e].name?s="Invalid Country":null==(s=Qe?s:D[t][e].name)&&(s=D.enC[e].name);for(var s,r=s.split(""),h=null,a=0;a<r.length;a++)if("`"===r[a]&&"1"===r[a+1]&&"`"===r[a+2]){h=a;break}if(t=null!==h?s.substr(0,h)+i+s.substr(h+3,s.length):s,void 0!==o){for(r=t.split(""),h=null,a=0;a<r.length;a++)if("`"===r[a]&&"2"===r[a+1]&&"`"===r[a+2]){h=a;break}t=null!==h?t.substr(0,h)+o+t.substr(h+3,s.length):s}if(void 0!==n){for(r=t.split(""),h=null,a=0;a<r.length;a++)if("`"===r[a]&&"3"===r[a+1]&&"`"===r[a+2]){h=a;break}t=null!==h?t.substr(0,h)+n+t.substr(h+3,s.length):s}return t}function U(e){for(var t="",i=e.length-2;0<=i;i--)i===e.length-2?t+=Pt("credits_listEnding",xt,e[i],e[i+1]):t=Pt("credits_list",xt,e[i],t);return t}Number.prototype.format=function(e,t){var i=String(this).split(".")[0],o=String(this).split(".")[1];if(void 0!==o)for(var n=(o=o.substr(0,e)).length-1;n<e-1;n++)o+="0";else if(t){o="";for(n=0;n<e;n++)o+="0"}return(i=i.split("")).forEach(function(e,t,i){t%3==(i.length-1)%3&&t<i.length-1&&(i[t]=e+",")}),(i=i.join(""))+(void 0===o?"":"."+o)};var Ot=Math.round;function L(e,t){return Math.random()*(t-e)+e}function K(){let t=0;for(let e=0;e<localStorage.length;e++)t+=2*localStorage.getItem(localStorage.key(e)).length;return t}function i(e){e=e.target;if(!e.crossOrigin)return print("Failed to reload "+e.src+"!");print("Attempting to reload it as a tainted image now..."),e.crossOrigin=null,e.src=e.src}function V(e,t){var i;void 0===e?t(""):e.match(/^data:image\/[a-zA-Z]+;base64,[a-zA-Z0-9+\/]+$/g)?t(e):((i=new XMLHttpRequest).onload=function(){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(i.response)},i.open("GET",e),i.responseType="blob",i.send())}var M="",q={},Z={};function j(e,t){q[e]=loadImage(t)}function _t(t){return void 0===q[t]?(void 0===Z[t]&&(V(t,function(e){j(t,e)}),Z[t]=!0),St.loading):q[t]}function ie(e){return 1e9<e?(e/1e9).toFixed(1)+" GB":1e6<e?(e/1e6).toFixed(1)+" MB":1e3<e?(e/1e3).toFixed(1)+" KB":e.toFixed(1)+" B"}function oe(e){e=String(e).split("base64,")[1];return void 0===e?null:Math.round(e.length/4*3)}function ne(e){e=String(e).split(";")[0];return void 0===(e=e.split("/")[1])?"TXT":0===e.length?"UNKNOWN":e.toUpperCase()}function se(e){return Pt(e,xt)}var re={sizeLimit:0,type:"image",success:function(e){},submit:function(e){console.log(re.sizeLimit),e.type!==re.type?Gn({type:"error",message:"file_wrongType",keys:[ne(e.data),se(re.type)]}):(console.log("File size: "+e.size),e.size>re.sizeLimit?Gn({type:"error",message:"file_tooLarge",keys:[ie(e.size),ie(re.sizeLimit)]}):re.success(e))}};function B(e,t){v.queueType.unshift(e),v.queueData.unshift(t)}function G(){if(100<v.queueType.length&&(v.queueType=v.queueType.splice(0,100)),10<=millis()-v.lastEmit&&0<v.queueType.length)for(var e=0;e<ceil((millis()-v.lastEmit)/10);e++){v.lastEmit=millis();var t=v.queueType[0];o.emit(v.queueType[0],v.queueData[0]);for(var i=v.queueType.length-1;0<=i;i--)0!==i&&(v.queueType[i]!==t||-1===v.exclusiveEmit.indexOf(t)&&X(v.queueData[i])!==X(v.queueData[0]))||(v.queueType.splice(i,1),v.queueData.splice(i,1))}}var Y,J,_,he,ae,le,de,ge,ce,fe,ue,ve,me,pe,be,we,Ce,ye,Ee,Pe,Oe,ze,zt,xe,Se=!1,Be=!1,Te=!0,He="click",Re="",ke="",Ne=!1,xt="en",Qe=!1,Ie=0,Ae=0,s={textA:0,drop:!1,boxY:-100,boxYC:0,dropTime:0,size:100/350,theta:0,strC:[0,0,0,255],fillC:[0,0,0,255],bg:255,pulse:0,pulseTime:0,pulseBackR:!1,pulseBackS:0,w:0,h:0,cross:0,startTime:0,wave:Ot(L(0,1e3))},Fe={dis:60,count:60,mi:0,log:[]},St={},Bt={screen:"logo",side:!1,sideBtn:{es:.2,l1:[0,0,25,0],l2:[0,12.5,25,12.5],l3:[0,25,25,25]},sideX:-1,sideW:1,sideTextA:1,nav:[["menu_levels_title","lvl","editorModeGameplay"],["menu_songs_title","song","song"],["menu_account_title","account","account"],["menu_online_title","online","leaderboard"],["settings_title","settings","menu"],["morePulsus_title","morePulsus","discordLogo"]],sideHoverY:75,sideHovering:0,navBox:0,trans:!1,loopVol:100,loopPlayState:0,fpsHoverTrans:0,versionInfoHoverTrans:0,account:{mode:!1,buttonA:255,loginA:0,user:"",email:"",pass:"",passConf:"",wrongPass:!1,wrongPassA:0,wrongUser:!1,wrongUserA:0,created:!1,self:{ppFade:0,bioFade:0,countryFade:0},buttonHover:[0],overlayX:0,overlayOn:!1,errors:[],errorY:0,blankErrors:[],takenErrors:[],code:"",codeUuid:"",resetPassComplete:!1,countryScreen:!1,countryScroll:0,countrySel:0,countrySelX:0,countrySelY:0,friendsScreen:!1,incFR:{scroll:0},viewFriend:!1,friendSearch:"",onlineOnly:!1,tabHighlight:[0,0],ppInput:0},lvl:{sel:!1,scrollSize:0,scroll:0,prevPlay:"",uploading:!1,finishUploading:!1,uploadVar:{a:0,id:0},downloading:!1,downloadVar:{id:0,beat:0,bpm:0,ar:0,hpD:0,song:0,bg:0,author:0,title:0,desc:0},loadingUserData:!0,selGlow:[],loading:!1,tab:1,search:"",tabHighlight:[0,0,0,0,0,0,0,0],scrollNewLock:!1,searchMode:"title",searchModes:["title","levelID","author"],deleteBanner:0,deleteConfirm:!1,buttonHover:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],sortMode:"starsAsc",sortModes:["dateAsc","dateDesc","alphanumAsc","alphanumDesc","starsAsc","starsDesc"],showUnranked:!1,showLeaderboard:!1,leaderboardX:0,leaderboardData:[],leaderboardScroll:0,newLeaderboard:0,showMods:!1,modsX:0,modsNSM:{},viewSkip:0,pageAmount:1e3,uploadConfirm:!1,refreshArrowR:0,searchSent:!1},online:{viewUser:"",viewUserUUIDCheck:!1,mode:"main",buttonHover:[],onlineOnly:!1,searchedUsers:[],scroll:0,search:"",searchOnline:!1,tabHighlight:[0]},song:{data:[],selGlow:[],sel:!1,scrollSize:0,scroll:0,listening:!1,songObject:0,playing:!1,listeningFade:0,loading:!1,tab:1,search:"",tabHighlight:[0,0,0,0,0,0,0],scrollNewLock:!1,searchMode:"title",searchModes:["title","songID","artist"],buttonHover:[0,0,0,0,0,0,0,0,0],playbackX:0,playbackR:0,playbackS:.75,loadR:22.5,mode:"song",sortMode:"dateDesc",sortModes:["dateAsc","dateDesc","alphanumAsc","alphanumDesc"],viewSkip:0,pageAmount:1e3,overlayX:0,overlayOn:!1,errors:[],errorY:0,blankErrors:[],takenErrors:[]},newSong:{title:"",artist:"",link:"",verify:!1,verifyDim:0,songObject:0,verifyError:!1,songPlaying:!1,songLoading:!1,failedLinks:[],failedLinksCheck:!1,uploaded:!1,uploadID:0,sizeLimit:32e6},settings:{musicVolume:25,keyboard:3,keyboardK:[['lang("settings_keyboard_typeUS",langSel)',0],['lang("settings_keyboard_typeDE",langSel)',1],['lang("settings_keyboard_typeNUMPAD",langSel)',2],['lang("settings_keyboard_typeLETTERS",langSel)',3],['lang("settings_keyboard_typeFUNCTION",langSel)',4],['lang("settings_keyboard_typeDUAL",langSel)',5]],language:0,languageK:[['lang("language","en")',0],['lang("language","de")',1],['lang("language","es")',2],['lang("language","fr")',3],['lang("language","ru")',4],['lang("language","nl")',5],['lang("language","th")',6],['lang("language","ro")',7],['lang("language","pt_BR")',8],['lang("language","pl")',9],['lang("language","tl")',10],['lang("language","tr")',11]],bgDim:78,hitsoundVolume:50,tilePush:6,boardOverlay:39,themesK:[['lang("theme_classic",langSel)',0],['lang("theme_light",langSel)',1],['lang("theme_dark",langSel)',2],['lang("theme_contributor",langSel)',3],['lang("theme_platinum",langSel)',4],['lang("theme_gold",langSel)',5],['lang("theme_blackGold",langSel)',6],['lang("theme_premium",langSel)',7],['lang("theme_ruby",langSel)',8],['lang("theme_amethyst",langSel)',9]],themeSel:0,debugOverlay:!0,beatTransparency:0,noteEdgeOpacity:85,holdProgressOpacity:85,notePaneOpacity:0,holdAngle:0,holdDirection:0,missShake:5,hitParticles:10,hitParticlesThickness:5,hitParticlesOpacity:100,hitParticlesSpread:3,hitParticlesDuration:250,fpsLimit:60,fpsLimitK:[['lang("settings_fpsLimit_vsync",langSel)',"vsync"],["25",25],["30",30],["50",50],["60",60],["75",75],["90",90],["120",120],["144",144],["240",240],['lang("settings_fpsLimit_unlimited",langSel)',2400]],disableEase:!1,menuMusic:"",defaultBackground:"",defaultBGInput:0,offset:0,overlayText:!1,overlayTextK:[['lang("default",langSel)',!1],['lang("settings_keyboard_typeNUMPAD",langSel)',2],['lang("settings_keyboard_typeLETTERS",langSel)',3]],disableMarvelouses:!1,disableGreats:!1,disableGoods:!1,disableOks:!1,disableMisses:!1,additionalGUI:!0,beatThickness:2,holdThickness:2,headerWidth:1,holdProgressThickness:10,showAccuracy:!0,showUR:!0,showHP:!0,showProgress:!0,showScore:!0,showCombo:!0,showSections:!0,showJudgements:!0,menuMusicVolume:25,comboBreakVolume:50,menu:{}},onlineLvl:{data:[],selGlow:[],sel:0,scrollSize:0,scroll:0,listening:!1,songObject:0,playing:!1,listeningFade:0,loading:!1},socialMedia:{buttonHover:[0]},changelog:{scroll:0}},Xe={input:"",active:!1,replayID:"",replayLoad:!1},T={id:"",name:"",pass:"",uuid:"",pp:"",recievedAll:!1,session:""},u={screenY:0,boxY:0,dropTime:0,boxR:0,theta:0,finished:!1,finishFade:0},Tt={edit:!1,loaded:!1,lineFade:0,disMode:0,transBackA:255,board:{w:.75,h:.75,c:0,str:0},headerY:-1,beat:[[0,0,!1,0,!1,0],[1,1,!1,0,!1,0],[2,2,!1,0,!1,0],[3,3,!1,0,!1,0],[4,4,!1,0,!1,0],[5,5,!1,0,!1,0],[6,6,!1,0,!1,0],[7,7,!1,0,!1,0],[8,8,!1,0,!1,1,2,0,0]],next:[],prt:[],song:0,songPlaying:!1,bpm:140,ar:2,arInit:0,hw:0,hpD:15,hp:100,hpDis:100,hpPerm:[],hpPermFreq:200,hpPermScan:[0,0],failed:!1,time:0,timeStart:!1,timeEnd:null,keys:["R","T","Y","F","G","H","V","B","N"],keysHeld:[!1,!1,!1,!1,!1,!1,!1,!1,!1],keysPressed:[!1,!1,!1,!1,!1,!1,!1,!1,!1],score:0,scoreDis:0,scoreMax:0,scoreFinal:0,combo:0,comboMax:0,comboCalc:0,hitStats:[0,0,0,0],winEase:[0,0,0,0],acc:100,accDis:0,accScore:0,accHits:0,missPrt:[],missTiles:[[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],songVol:1,bg:!1,timeScroll:0,headerH:0,toolsH:0,tools:[],playing:!1,playingOffset:0,objType:0,holdLength:1,menu:!1,menuSize:0,menuTabSel:0,menuHLX:0,menuHLW:0,menuNSM:{},title:"",desc:"",menuItems:[],lvlSel:-1,songLoadState:0,songLoadBytes:0,songLoadTotal:0,songObject:0,dropdownX:0,dropdown:[-1,-1,!1],songOffset:0,keyDisplay:[["R","T","Y","F","G","H","V","B","N"],["R","T","Z","F","G","H","V","B","N"],["R","T","Y","F","G","H","V","B","N"],["R","T","Y","F","G","H","V","B","N"],["К","Е","Н","А","П","Р","М","И","Т"],["R","T","Y","F","G","H","V","B","N"],["R","T","Y","F","G","H","V","B","N"],["R","T","Y","F","G","H","V","B","N"],["R","T","Y","F","G","H","V","B","N"],["R","T","Y","F","G","H","V","B","N"],["R","T","Y","F","G","H","V","B","N"],["R","T","Y","F","G","H","V","B","N"]],keyDisplayNum:["7","8","9","4","5","6","1","2","3"],keyDisplayFunc:["PRS","SCL","PSE","INS","HOM","PGU","DEL","END","PGD"],playbackRate:1,snap:.25,paused:!1,editorMode:0,effects:[],effectsTabSel:0,effectsMenuHLX:0,effectsMenuHLW:0,effectsDropdownX:0,effectsDropdown:[-1,-1,!1],effected:{boardX:0,boardY:0,boardW:0,boardH:0,boardR:0,boardA:0,tileX:[0,0,0,0,0,0,0,0,0],tileY:[0,0,0,0,0,0,0,0,0],tileW:[0,0,0,0,0,0,0,0,0],tileH:[0,0,0,0,0,0,0,0,0],tileR:[0,0,0,0,0,0,0,0,0],tileA:[0,0,0,0,0,0,0,0,0],subtitles:[]},effectSel:!1,effectSelLast:0,effectTypeLast:0,effectTypeNames:["Move Board","Scale Board","Rotate Board","Move Tiles","Scale Tiles","Rotate Tiles","Change Foresight","Opaque Board","Opaque Tiles","Subtitle","Vignette","Letterbox","Color Tiles","Color Overlay","Trail Tiles"],effectsNSM:{},sections:[],sectionsSelected:[],sectionsTabSel:0,sectionsMenuHLX:0,sectionsMenuHLW:0,sectionsDropdownX:0,sectionsDropdown:[-1,-1,!1],sectionsSelectedLast:[],sectionsHighlight:[],sectionsNSM:{},editorHS:[],editorHSH:[],editorHSStart:0,metronomeLast:0,metronome:!1,scoreSubmitted:!1,buttonHover:[0,0],tilePress:[0,0,0,0,0,0,0,0,0],tilePressDis:[0,0,0,0,0,0,0,0,0],tilePressRelease:[!0,!0,!0,!0,!0,!0,!0,!0,!0],beatTransition:0,timelineMode:"scroll",selectedBeats:[],sbeatsTabSel:0,sbeatsMenuHLX:0,sbeatsMenuHLW:0,sbeatsDropdownX:0,sbeatsDropdown:[-1,-1,!1],sbeatsLast:[],beatNSM:{},saved:!1,timelineBPM:120,timelineOffset:0,hitError:[],ctrlHeld:!1,saveNotice:0,saveNoticeDis:0,beatClipboard:[],effectMultiSel:[],effectMultiSelLast:[],effectClipboard:[],showGUI:!0,guiAlpha:1,holdDesign:1,lastHitTile:4,flashlightX:0,flashlightY:0,author:"",transitionIn:0,transitionOut:3,beatColor:141,metronomeFlip:!1,drawEffects:[],textAlignNames:[],queueEditorMusic:!1,newHits:[],sectionPerformance:[],sectionAcc:[],endMillis:!1,performanceChart:!1,sectionCarouselIndex:0,sectionBarWidth:0,bgInput:0,lastDraw:0,tileTrail:[],tileTrailLast:[0,0,0,0,0,0,0,0,0],tileTrailSpacing:[25,25,25,25,25,25,25,25,25],tileTrailLength:[0,0,0,0,0,0,0,0,0],tileTrailAlpha:[.5,.5,.5,.5,.5,.5,.5,.5,.5],beatSaturation:255,beatBrightness:255,newScore:{cur:0,curMult:0,past:0,miss:1,log:[],press:[],release:[]},mods:{bpm:1,foresight:1,hitWindow:1,noFail:!1,hidden:!1,noEffects:!1,auto:!1,startPos:0,endPos:0,instantFail:!1,perfect:!1,mirror:!1,noRelease:!1,offset:0,noPitch:!1,random:!1,flashlight:!1},modsDef:{bpm:1,foresight:1,hitWindow:1,noFail:!1,hidden:!1,noEffects:!1,auto:!1,startPos:0,endPos:0,instantFail:!1,perfect:!1,mirror:!1,noRelease:!1,offset:0,noPitch:!1,random:!1,flashlight:!1},replay:{on:!1,press:[],release:[],pressI:0,releaseI:0,logI:0,log:[],preMods:{bpm:1,foresight:1,hitWindow:1,noFail:!1,hidden:!1,noEffects:!1,auto:!1,instantFail:!1,perfect:!1,mirror:!1,noRelease:!1,offset:0,noPitch:!1,random:!1,flashlight:!1}},hitValues:[],ranks:[],submittedScore:null,bpmNew(){return Tt.timelineBPM/Tt.bpm},timelineTickFor(e){return Math.round((e+Tt.bpm/60/1e3*Tt.timelineOffset)*Tt.bpmNew()*1e6)/1e6},quickRetry:!1,performanceDotCallback:null},v={queueType:[],queueData:[],lastEmit:0,exclusiveEmit:["searchLevels","grabIncFriendReqs","grabOutFriendReqs","grabFriends","grabScores","newSessionResume","sessionResume"],userStatus:[["TetroGem",0]],grabbedUserData:[[]],grabbedUserDataTime:[[]],grabbedSongData:[[]],grabbedSongDataTime:[[]],grabbedSongDataAllTime:0,grabbedLevelData:[],grabbedLevelDataTime:[[]],grabbedLevelDataAllTime:0,newGrabbedLevels:[],newGLRequested:[],newGLRequestedT:[],newGLDownloading:[],newGrabbedUsers:[],newGUUnix:[],newGURequested:[],newGURequestedT:[],newGrabbedSongs:[],newGSRequested:[],newGSRequestedT:[],grabbedScoresUser:[],grabbedScoresLevel:[],grabbedScoresTime:0,newGrabbedUsersUsername:[],newGUUUnix:[],newGUURequested:[],newGUURequestedT:[],newLoginT:0,grabbedIncFriendReqs:[],grabbedIncFriendReqsT:[],grabbedFriends:[],grabbedFriendsT:[],grabbedOutFriendReqs:[],grabbedOutFriendReqsT:[],searchUsersT:0,grabPerfTime:[]},Ht=(o.on("savedScore",e=>{Tt.submittedScore=e}),{saved:[],scores:[],onlineScores:[],search:[],localOffsets:[],onlineOffsets:[],savedDiffReq:[]}),O={saved:[],search:[]},We={client:!1},Ue=!0,Le=!1,Ke=0,$t=!1,Rt=[],z=0,Ve=0,kt=0,Me=[],$={},qe=[],Ze=[],Nt={active:!1,inp:"",title:"",buttonHover:[0,0],fade:0,check:!1,variable:0,allowEmptyString:!1,afterPrmpt:0,vSet:"",i:0,m:0,password:!1,cursor:0,anchor:!1},g={active:!1,title:"",buttonHover:[0,0],fade:0,variable:[],hsbNSM:{},rgbNSM:{},afterPrmpt:0,currentColor:0,hue:0,saturation:0,brightness:0,red:0,green:0,blue:0,alpha:0,loops:0,smooth:!1,old:{hue:0,saturation:0,brightness:0,red:0,green:0,blue:0,alpha:0,loops:0,smooth:!1,mode:!1},hex:"#00000000"},Qt=[0],je=[0],Ge=[0],ei=!1,ti=!1,Ye="",Rt=[],Je={n:"",b:"",i:"",c:""},_e={},$e="",et=!1,tt=!1,it=0,ot="normal",nt="string",st=0,rt=0,ht={},at=[],lt=[],dt=!1,gt=4,ct=!1,ft={pressed:[],pressedTime:!1,pressedRepeatStartTime:600,pressedRepeatDelay:35};function ut(){var e;return!1!==Bt.lvl.sel?"number"==typeof(e=Rt[Bt.lvl.sel])?v.newGrabbedLevels[e]:e:null}const vt={sections:[],callback:null,active:!1,trans:0,buttonHover:[],computeSections(){this.sections.length=0;var e=ut();if(e){var t=e.sections??[];0!==t[0]?.time&&this.sections.push({name:Pt("start",xt),startMS:0});for(const i of t)i.visible&&this.sections.push({name:i.name,startMS:i.time/e.bpm*60*1e3});this.sections.push({name:Pt("end",xt),startMS:0})}}};function mt(){return{x:0,y:0,w:1,h:1,r:0}}function pt(){this.data=[mt()],this.cache=mt()}function bt(e){e.hsbGrid=createGraphics(512,512,P2D),e.brightnessSlider=createGraphics(512,64,P2D),e.redSlider=createGraphics(512,64,P2D),e.greenSlider=createGraphics(512,64,P2D),e.blueSlider=createGraphics(512,64,P2D),e.alphaSlider=createGraphics(512,64,P2D),e.hsbGrid.noStroke(),e.hsbGrid.colorMode(HSB);for(var t=0;t<512;t++)for(var i=0;i<512;i++)e.hsbGrid.fill(t/512*360,i/512*100,100),e.hsbGrid.rect(t,i,1,1);e.brightnessSlider.noStroke(),e.brightnessSlider.colorMode(HSB);for(t=0;t<512;t++)e.brightnessSlider.fill(0,0,t/512*100),e.brightnessSlider.rect(t,0,1,64);e.redSlider.noStroke(),e.redSlider.colorMode(RGB);for(t=0;t<512;t++)e.redSlider.fill(t/512*255,0,0),e.redSlider.rect(t,0,1,64);e.greenSlider.noStroke(),e.greenSlider.colorMode(RGB);for(t=0;t<512;t++)e.greenSlider.fill(0,t/512*255,0),e.greenSlider.rect(t,0,1,64);e.blueSlider.noStroke(),e.blueSlider.colorMode(RGB);for(t=0;t<512;t++)e.blueSlider.fill(0,0,t/512*255),e.blueSlider.rect(t,0,1,64);e.alphaSlider.noStroke(),e.alphaSlider.colorMode(RGB);for(t=0;t<64;t++)for(i=0;i<4;i++)e.alphaSlider.fill((t+i)%2==0?color(30):color(10)),e.alphaSlider.rect(8*t,16*i,8,16);for(t=0;t<512;t++)e.alphaSlider.fill(255,255,255,t/512*255),e.alphaSlider.rect(t,0,1,64)}function ee(e,t){for(var i=e[0],o=(o=e[1]).split("."),n=1;n<o.length-1;n++)i=i[o[n]];i[o[o.length-1]]=t}function te(e){for(var t=e[0],i=(i=e[1]).split("."),o=1;o<i.length-1;o++)t=t[i[o]];return t[i[i.length-1]]}function wt(e,t,i,o){return e=constrain(Ot(e),0,255).toString(16).padStart(2,"0"),t=constrain(Ot(t),0,255).toString(16).padStart(2,"0"),i=constrain(Ot(i),0,255).toString(16).padStart(2,"0"),void 0!==o&&255!==o&&(i+=o=constrain(Ot(o),0,255).toString(16).padStart(2,"0")),"#"+(e+t+i).toUpperCase()}function Ct(e){"#"===(e=e.split(""))[0]&&e.splice(0,1);for(var t=(e=(e=(e=(e=e.join("")).substr(0,8)).padEnd(8,"F")).split("")).length-2;0<=t;t-=2)e[t]=e[t]+e[t+1],e.splice(t+1,1),e[t]=parseInt(e[t],16),isNaN(e[t])&&(e[t]=0);return{red:e[0],green:e[1],blue:e[2],alpha:void 0===e[3]?255:e[3]}}ct&&document.addEventListener("touchstart",function(e){e.preventDefault()},{passive:!1}),pt.prototype.get=function(e){if(void 0===e&&(e=0),this.cache=mt(),e<=0)for(var t=0;t<this.data.length+e;t++)for(var i in this.cache)this.cache[i]+=this.data[t][i];else if(0<e)for(t=this.data.length-e;t<this.data.length;t++)for(var i in this.cache)this.cache[i]+=this.data[t][i];return{x:this.cache.x,y:this.cache.y,w:this.cache.w,h:this.cache.h,r:this.cache.r}};var yt=function(e,t,i,o,n){return o*(t/=n)*t+i},Et=function(e,t,i,o,n){return-o*(t/=n)*(t-2)+i},ii=function(e,t,i,o,n){return(t/=n/2)<1?o/2*t*t+i:-o/2*(--t*(t-2)-1)+i},oi=function(e,t,i,o,n){return o*(t/=n)*t*t+i},ni=function(e,t,i,o,n){return o*((t=t/n-1)*t*t+1)+i},si=function(e,t,i,o,n){return(t/=n/2)<1?o/2*t*t*t+i:o/2*((t-=2)*t*t+2)+i},ri=function(e,t,i,o,n){return o*(t/=n)*t*t*t+i},hi=function(e,t,i,o,n){return-o*((t=t/n-1)*t*t*t-1)+i},ai=function(e,t,i,o,n){return(t/=n/2)<1?o/2*t*t*t*t+i:-o/2*((t-=2)*t*t*t-2)+i},li=function(e,t,i,o,n){return o*(t/=n)*t*t*t*t+i},di=function(e,t,i,o,n){return o*((t=t/n-1)*t*t*t*t+1)+i},gi=function(e,t,i,o,n){return(t/=n/2)<1?o/2*t*t*t*t*t+i:o/2*((t-=2)*t*t*t*t+2)+i},ci=function(e,t,i,o,n){return-o*Math.cos(t/n*(Math.PI/2))+o+i},fi=function(e,t,i,o,n){return o*Math.sin(t/n*(Math.PI/2))+i},ui=function(e,t,i,o,n){return-o/2*(Math.cos(Math.PI*t/n)-1)+i},vi=function(e,t,i,o,n){return 0==t?i:o*Math.pow(2,10*(t/n-1))+i},mi=function(e,t,i,o,n){return t==n?i+o:o*(1-Math.pow(2,-10*t/n))+i},pi=function(e,t,i,o,n){return 0==t?i:t==n?i+o:(t/=n/2)<1?o/2*Math.pow(2,10*(t-1))+i:o/2*(2-Math.pow(2,-10*--t))+i},bi=function(e,t,i,o,n){return-o*(Math.sqrt(1-(t/=n)*t)-1)+i},wi=function(e,t,i,o,n){return o*Math.sqrt(1-(t=t/n-1)*t)+i},Ci=function(e,t,i,o,n){return(t/=n/2)<1?-o/2*(Math.sqrt(1-t*t)-1)+i:o/2*(Math.sqrt(1-(t-=2)*t)+1)+i},yi=function(e,t,i,o,n){var s=1.70158,r=0,h=o;return 0===t?i:1==(t/=n)?i+o:(r=r||.3*n,s=h<abs(o)?(h=o,r/4):r/(2*PI)*asin(o/h),-(h*pow(2,10*--t)*sin((t*n-s)*(2*PI)/r))+i)},Ei=function(e,t,i,o,n){var s=1.70158,r=0,h=o;return 0==t?i:1==(t/=n)?i+o:(r=r||.3*n,s=h<Math.abs(o)?(h=o,r/4):r/(2*Math.PI)*Math.asin(o/h),h*Math.pow(2,-10*t)*Math.sin((t*n-s)*(2*Math.PI)/r)+o+i)},Pi=function(e,t,i,o,n){var s=1.70158,r=0,h=o;return 0==t?i:2==(t/=n/2)?i+o:(r=r||n*(.3*1.5),s=h<Math.abs(o)?(h=o,r/4):r/(2*Math.PI)*Math.asin(o/h),t<1?h*Math.pow(2,10*--t)*Math.sin((t*n-s)*(2*Math.PI)/r)*-.5+i:h*Math.pow(2,-10*--t)*Math.sin((t*n-s)*(2*Math.PI)/r)*.5+o+i)},Oi=function(e,t,i,o,n,s){return o*(t/=n)*t*(((s=null==s?1.70158:s)+1)*t-s)+i},zi=function(e,t,i,o,n,s){return o*((t=t/n-1)*t*(((s=null==s?1.70158:s)+1)*t+s)+1)+i},xi=function(e,t,i,o,n,s){return null==s&&(s=1.70158),(t/=n/2)<1?o/2*(t*t*((1+(s*=1.525))*t-s))+i:o/2*((t-=2)*t*((1+(s*=1.525))*t+s)+2)+i},Si=function(e,t,i,o,n){return o-Bi(e,n-t,0,o,n)+i},Bi=function(e,t,i,o,n){return(t/=n)<1/2.75?o*(7.5625*t*t)+i:t<2/2.75?o*(7.5625*(t-=1.5/2.75)*t+.75)+i:t<2.5/2.75?o*(7.5625*(t-=2.25/2.75)*t+.9375)+i:o*(7.5625*(t-=2.625/2.75)*t+.984375)+i},Ti=function(e,t,i,o,n){return t<n/2?.5*Si(e,2*t,0,o,n)+i:.5*Bi(e,2*t-n,0,o,n)+.5*o+i};function It(e,t,i,o){if(t<e&&(e=t),0===t||0===i)return i;switch(o){case 0:return e/t*i;case 1:return yt(0,e,0,i,t);case 2:return Et(0,e,0,i,t);case 3:return ii(0,e,0,i,t);case 4:return oi(0,e,0,i,t);case 5:return ni(0,e,0,i,t);case 6:return si(0,e,0,i,t);case 7:return ri(0,e,0,i,t);case 8:return hi(0,e,0,i,t);case 9:return ai(0,e,0,i,t);case 10:return li(0,e,0,i,t);case 11:return di(0,e,0,i,t);case 12:return gi(0,e,0,i,t);case 13:return ci(0,e,0,i,t);case 14:return fi(0,e,0,i,t);case 15:return ui(0,e,0,i,t);case 16:return vi(0,e,0,i,t);case 17:return mi(0,e,0,i,t);case 18:return pi(0,e,0,i,t);case 19:return bi(0,e,0,i,t);case 20:return wi(0,e,0,i,t);case 21:return Ci(0,e,0,i,t);case 22:return yi(0,e,0,i,t);case 23:return Ei(0,e,0,i,t);case 24:return Pi(0,e,0,i,t);case 25:return Oi(0,e,0,i,t);case 26:return zi(0,e,0,i,t);case 27:return xi(0,e,0,i,t);case 28:return Si(0,e,0,i,t);case 29:return Bi(0,e,0,i,t);case 30:return Ti(0,e,0,i,t)}}var Hi=[["Linear"],["Quad In"],["Quad Out"],["Quad In Out"],["Cubic In"],["Cubic Out"],["Cubic In Out"],["Quart In"],["Quart Out"],["Quart In Out"],["Quint In"],["Quint Out"],["Quint In Out"],["Sine In"],["Sine Out"],["Sine In Out"],["Exponential In"],["Exponential Out"],["Exponential In Out"],["Circ In"],["Circ Out"],["Circ In Out"],["Elastic In"],["Elastic Out"],["Elastic In Out"],["Back In"],["Back Out"],["Back In Out"],["Bounce In"],["Bounce Out"],["Bounce In Out"]];function At(e,t,i){return Number.isNaN(e)?t:Number.isNaN(t)||Number.isNaN(i)?e:Bt.settings.disableEase?e-t:(i=1.2*i*(Math.min(rt,100)/(1e3/60)),lerp(t,e,constrain(i,0,1))-t)}function Ri(e){var t;Nt.active=!0,Nt.title=e.title,t=void 0===e.display?te(e.var):e.display,0<String(t).length&&void 0!==t?Nt.inp=String(t):Nt.inp="",Nt.anchor=!1,Nt.cursor=Nt.inp.length,Nt.check=e.type,Nt.allowEmptyString=!0===e.allowEmpty,Nt.var=e.var,Nt.password=!0===e.password,Nt.afterPrmpt=e.after,Nt.convert=e.convert}function ki(e){null!==(e="submit"===e?Nt.inp:null)&&("number"===Nt.check?(e=parseFloat(e),isNaN(e)&&(e=te(Nt.var))):"string"===Nt.check?(e=String(e)).length<=0&&!Nt.allowEmptyString&&(e=te(Nt.var)):e=null,void 0!==Nt.convert&&(e=Nt.convert(e)),ee(Nt.var,e),void 0!==Nt.afterPrmpt)&&Nt.afterPrmpt(),Nt.afterPrmpt=!1,Nt.active=!1}function Ni(e){g.active=!0,g.title=e.title,g.hsbNSM.pages[0].items=[{type:"number",name:"prmpt_hue",hint:"edit_effects_item_startTime_sub",var:[g,"hue"],min:0,max:255,bigChange:16,smallChange:1},{type:"number",name:"prmpt_saturation",hint:"edit_effects_item_startTime_sub",var:[g,"saturation"],min:0,max:255,bigChange:16,smallChange:1},{type:"slider",name:"prmpt_brightness",var:[g,"brightness"],min:0,max:255,step:1,hint:"settings_musicVolume_sub",noName:!0,barTexture:ht.brightnessSlider},{type:"number",name:"prmpt_brightness",hint:"edit_effects_item_startTime_sub",var:[g,"brightness"],min:0,max:255,bigChange:16,smallChange:1},{type:"string",name:"prmpt_hex",hint:"edit_effects_item_displayName_sub",var:[g,"hex"],after:function(){var e=Ct(g.hex);g.red=e.red,g.green=e.green,g.blue=e.blue,!1!==g.old.alpha&&(g.alpha=e.alpha)}}],g.rgbNSM.pages[0].items=[{type:"slider",name:"prmpt_red",var:[g,"red"],min:0,max:255,step:1,hint:"settings_musicVolume_sub",noName:!0,barTexture:ht.redSlider},{type:"number",name:"prmpt_red",hint:"edit_effects_item_startTime_sub",var:[g,"red"],min:0,max:255,bigChange:16,smallChange:1},{type:"slider",name:"prmpt_green",var:[g,"green"],min:0,max:255,step:1,hint:"settings_musicVolume_sub",noName:!0,barTexture:ht.greenSlider},{type:"number",name:"prmpt_green",hint:"edit_effects_item_startTime_sub",var:[g,"green"],min:0,max:255,bigChange:16,smallChange:1},{type:"slider",name:"prmpt_blue",var:[g,"blue"],min:0,max:255,step:1,hint:"settings_musicVolume_sub",noName:!0,barTexture:ht.blueSlider},{type:"number",name:"prmpt_blue",hint:"edit_effects_item_startTime_sub",var:[g,"blue"],min:0,max:255,bigChange:16,smallChange:1}],void 0!==e.alpha&&g.rgbNSM.pages[0].items.push({type:"slider",name:"prmpt_alpha",var:[g,"alpha"],min:0,max:255,step:1,hint:"settings_musicVolume_sub",noName:!0,barTexture:ht.alphaSlider},{type:"number",name:"prmpt_alpha",hint:"edit_effects_item_startTime_sub",var:[g,"alpha"],min:0,max:255,bigChange:16,smallChange:1}),void 0!==e.loops&&g.hsbNSM.pages[0].items.push({type:"number",name:"prmpt_loops",hint:"edit_effects_item_startTime_sub",var:[g,"loops"],min:!1,max:!1,bigChange:3,smallChange:1,step:1}),void 0!==e.smooth&&g.rgbNSM.pages[0].items.push({type:"boolean",name:"prmpt_smooth",hint:"edit_effects_item_startTime_sub",var:[g,"smooth"]}),colorMode(HSB),e.multiple?g.currentColor=color(te(e.hues[0]),te(e.saturations[0]),te(e.brightnesses[0]),void 0!==e.alphas?te(e.alphas[0]):255):g.currentColor=color(te(e.hue),te(e.saturation),te(e.brightness),void 0!==e.alpha?te(e.alpha):255),g.hue=Ot(hue(g.currentColor)),g.saturation=Ot(saturation(g.currentColor)),g.brightness=Ot(brightness(g.currentColor)),g.red=Ot(red(g.currentColor)),g.green=Ot(green(g.currentColor)),g.blue=Ot(blue(g.currentColor)),g.alpha=Ot(alpha(g.currentColor)),void 0!==e.loops&&(g.loops=te(e.loops)),void 0!==e.smooth&&(g.smooth=te(e.smooth)),g.hex=wt(g.red,g.green,g.blue,g.alpha),g.old={hue:void 0!==e.hue&&e.hue,saturation:void 0!==e.saturation&&e.saturation,brightness:void 0!==e.brightness&&e.brightness,red:void 0!==e.red&&e.red,green:void 0!==e.green&&e.green,blue:void 0!==e.blue&&e.blue,alpha:void 0!==e.alpha&&e.alpha,loops:void 0!==e.loops&&e.loops,smooth:void 0!==e.smooth&&e.smooth,mode:e.mode,multiple:void 0!==e.multiple&&e.multiple,hues:void 0!==e.hues&&e.hues,saturations:void 0!==e.saturations&&e.saturations,brightnesses:void 0!==e.brightnesses&&e.brightnesses,alphas:void 0!==e.alphas&&e.alphas},g.afterPrmpt=e.after}function Qi(e){if("submit"===e)if(g.old.multiple)if(g.old.mode===HSB)for(var t=0;t<g.old.hues.length;t++)ee(g.old.hues[t],g.hue),ee(g.old.saturations[t],g.saturation),ee(g.old.brightnesses[t],g.brightness);else g.old.mode,RGB;else g.old.mode===HSB?(ee(g.old.hue,g.hue),ee(g.old.saturation,g.saturation),ee(g.old.brightness,g.brightness)):g.old.mode===RGB&&(ee(g.old.red,g.red),ee(g.old.green,g.green),ee(g.old.blue,g.blue)),!1!==g.old.alpha&&ee(g.old.alpha,g.alpha),!1!==g.old.loops&&ee(g.old.loops,g.loops),!1!==g.old.smooth&&ee(g.old.smooth,g.smooth);void 0!==g.afterPrmpt&&g.afterPrmpt(),g.afterPrmpt=!1,g.active=!1}function Ii(e){var t,e=e.split(":");return 1===e.length?parseFloat(e[0])*(120/Tt.timelineBPM):1<e.length&&(t=0,(60*parseFloat(e[0])+parseFloat(e[1])+(t=void 0!==e[2]?parseFloat(e[2]):t)/1e3)/60*120)}function Ft(e,t,i,o,n,s,r){if(void 0!==s&&void 0!==r||(s=mouseX,r=mouseY),n<0&&(i+=n,n=abs(n)),o<0&&(t+=o,o=abs(o)),"rcorner"===e)return t<s&&s<t+o&&i<r&&r<i+n;if("rcenter"===e)return t-o/2<s&&s<t+o/2&&i-n/2<r&&r<i+n/2;if("ccenter"===e)return pow(s-t,2)/pow(o/2,2)+pow(r-i,2)/pow(n/2,2)<=1;if("ccorner"===e)return pow(s-t-o/2,2)/pow(o/2,2)+pow(r-i-n/2,2)/pow(n/2,2)<=1;if("rcornerP"===e)return pmouseX>t&&pmouseX<t+o&&pmouseY>i&&pmouseY<i+n;throw"Undocumented hitbox type: "+e}function Ai(e,t){if(textFont(Je.n),$e!==t){switch(t){case"italic":case"italics":textStyle(ITALIC);break;case"bold":textStyle(BOLD);break;default:textStyle(NORMAL)}$e=t}return textSize(20),void 0===_e[e]&&(_e[e]=textWidth(e)),void 0===_e[e]?20:_e[e]}function Fi(e,t,i){var o=e.split(" "),n=[];let s=0,r=0;for(let e=0;e<o.length;e++){o[e];var h=textWidth(o[e]+" ");void 0===n[r]&&(n[r]=[]),s+h<=t||0===n[r].length?(n[r].push(o[e]),s+=h):(r++,s=0,e--)}for(let e=0;e<n.length;e++)n[e]=n[e].join(" ");return n.join("\n")}function Di(e,t,i){var o;return t=t||textSize(),i=i||textLeading(),0!==(e=String(e||"")).length&&void 0!==e&&(o=e.split("\n"),0<e.length)?(o.length-1)*i+(0<o[o.length-1].length?t:0)-textDescent()/4-textAscent()/4:0}function Dt(e,t,i,o,n,s){Je.n=Ee,textSize(min(20*o/Ai(e,s),n)),text(e,t,i),textStyle(NORMAL)}function Xi(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}function Wi(e,t,i,o,n,s,r,h){var a=width>height?width/64:height/64,l=(rectMode(CORNER),fill(10),rect(o,n,s,r,a),fill($.text),textAlign(LEFT,TOP),Dt(i,o,n-r-a/2,s,r),""),i=255;if(0===e.length&&(e=t,i=127.5),"password"===h)for(var d=0;d<e.length;d++)l+="•";else l=e;fill(255,i),textAlign(LEFT,CENTER),Dt(512<l.length?"[Long String]":l,o+r/4,n+r/2,s-r/2,r/2,127.5===i&&"italics")}function Ui(e,t,i){""===e?Bt.account.wrongUser=!0:""!==t&&t===i?B("signUp",{user:e,pass:t,passConf:i}):Bt.account.wrongPass=!0}function Li(e,t){""===e?Bt.account.wrongUser=!0:""===t?Bt.account.wrongPass=!0:B("signIn",{user:e,pass:t})}function Ki(e,t){""===e||e!==e.name?alert("Uh, this shouldn't happen.\nPlease email pulsusgame@gmail.com and document the instructions prior to the error.\nPlease include error code signoutIncorrectUser"):t.match(/[\da-f]{64}/)?B("signOut",{user:e,session:t}):alert("Uh, this shouldn't happen.\nPlease email pulsusgame@gmail.com and document the instructions prior to the error.\nPlease include error code invalidSessionCheck")}function Vi(e,t){Ne=!0,Re=e,ke=t,u.dropTime=millis(),u.screenY=0,u.boxY=0,u.boxR=0,u.theta=0}function Mi(){for(var e=endTime=0;e<Tt.beat.length;e++)0===Tt.beat[e][5]?Tt.beat[e][1]>endTime&&(endTime=Tt.beat[e][1]):1===Tt.beat[e][5]&&Tt.beat[e][1]+Tt.beat[e][6]>endTime&&(endTime=Tt.beat[e][1]+Tt.beat[e][6]);return endTime+2*(Tt.ar<Tt.hw?Tt.hw:Tt.ar)}function Xt(e){switch(e.recieve){case"bpm":return Ot(1e6*(e.time*(e.bpm/e.lvlBPM)-e.bpm/60/1e3*e.offset))/1e6;case"raw":return(e.time+e.bpm/60/1e3*e.offset)/(e.bpm/e.lvlBPM)}}function qi(e,t,i){if("new"!==t?(Rt=[],Rt=Uo(Ht.search,Bt.lvl.sortMode)):(Rt=Uo(Ht.saved,"dateDesc"),Bt.lvl.tab=0,Bt.lvl.sortMode="dateDesc",Bt.lvl.sel=e,Bt.lvl.search=""),Tt.timelineBPM=!1,!(Tt.timelineOffset=!1)===Rt[e].local){Tt.title=Rt[e].title,Tt.author=Rt[e].author,Tt.bpm=Rt[e].bpm;var o=[!1,!1];Tt.beat=[];for(var n=0;n<Rt[e].beat.length;n++){Tt.beat[n]=[];for(var s=0;s<Rt[e].beat[n].length;s++)Tt.beat[n][s]=Rt[e].beat[n][s];void 0===Tt.beat[n][9]&&(Tt.bpm=120,Tt.beat[n][9]=Rt[e].bpm,Tt.beat[n][1]=Tt.beat[n][1]*(120/Tt.beat[n][9]),Tt.beat[n][6]=Tt.beat[n][6]*(120/Tt.beat[n][9])),void 0===Tt.beat[n][10]&&(Tt.beat[n][10]=0),void 0===Tt.beat[n][11]&&(Tt.beat[n][11]=141),void 0!==Tt.beat[n][13]&&null!==Tt.beat[n][13]||(Tt.beat[n][13]=0),void 0!==Tt.beat[n][14]&&null!==Tt.beat[n][14]||(Tt.beat[n][14]=3),(Tt.beat[n][1]<o[0]||!1===o[0])&&(o[0]=Tt.beat[n][1],o[1]=n)}if(!1!==o[1]&&(Tt.timelineBPM=Tt.beat[o[1]][9],Tt.timelineOffset=Tt.beat[o[1]][10]),Tt.oldAr=Rt[e].ar,Tt.hw=Rt[e].hw,Tt.hpD=Rt[e].hpD,Tt.song=Rt[e].song,Tt.bg=Rt[e].bg,Tt.songOffset=void 0===Rt[e].songOffset?0:Rt[e].songOffset,Tt.title=Rt[e].title,Tt.desc=Rt[e].desc,Tt.stars=Bn(Rt[e]),Tt.gameVersion=Rt[e].gameVersion,Tt.lvlSel=e,Tt.effects=[],void 0!==Rt[e].effects&&null!==Rt[e].effects&&0<Rt[e].effects.length){Tt.effects=JSON.parse(JSON.stringify(Rt[e].effects));for(n=0;n<Rt[e].effects.length;n++)void 0===Tt.effects[n].bpm&&(Tt.bpm=120,Tt.effects[n].bpm=Rt[e].bpm,Tt.effects[n].time=Tt.effects[n].time*(120/Tt.effects[n].bpm),Tt.effects[n].moveTime=Tt.effects[n].moveTime*(120/Tt.effects[n].bpm)),void 0===Tt.effects[n].offset&&(Tt.effects[n].offset=0)}if(Tt.sections=[],void 0!==Rt[e].sections&&null!==Rt[e].sections&&0<Rt[e].sections.length){Tt.sections=JSON.parse(JSON.stringify(Rt[e].sections));for(n=0;n<Rt[e].sections.length;n++)void 0===Tt.sections[n].bpm&&(Tt.bpm=120,Tt.sections[n].bpm=Rt[e].bpm,Tt.sections[n].time=Tt.sections[n].time*(120/Tt.sections[n].bpm)),void 0===Tt.sections[n].offset&&(Tt.sections[n].offset=0)}}else{Tt.title=m(Rt[e],"id").title,Tt.author=m(Rt[e],"id").author,Tt.beat=[],Tt.bpm=m(Rt[e],"id").bpm;for(n=0;n<m(Rt[e],"id").beat.length;n++){Tt.beat[n]=[];for(s=0;s<m(Rt[e],"id").beat[n].length;s++)Tt.beat[n][s]=m(Rt[e],"id").beat[n][s];void 0===Tt.beat[n][9]&&(Tt.bpm=120,Tt.beat[n][9]=m(Rt[e],"id").bpm,Tt.beat[n][1]=Tt.beat[n][1]*(120/Tt.beat[n][9]),Tt.beat[n][6]=Tt.beat[n][6]*(120/Tt.beat[n][9])),void 0===Tt.beat[n][10]&&(Tt.beat[n][10]=0),void 0===Tt.beat[n][11]&&(Tt.beat[n][11]=141),void 0!==Tt.beat[n][13]&&null!==Tt.beat[n][13]||(Tt.beat[n][13]=0),void 0!==Tt.beat[n][14]&&null!==Tt.beat[n][14]||(Tt.beat[n][14]=3)}if(Tt.oldAr=m(Rt[e],"id").ar,Tt.hw=m(Rt[e],"id").hw,Tt.hpD=m(Rt[e],"id").hpD,Tt.song=m(Rt[e],"id").song,Tt.bg=m(Rt[e],"id").bg,Tt.songOffset=null===m(Rt[e],"id").songOffset?0:m(Rt[e],"id").songOffset,Tt.title=m(Rt[e],"id").title,Tt.desc=m(Rt[e],"id").desc,Tt.stars=Bn(Rt[e]),Tt.gameVersion=m(Rt[e],"id").gameVersion,Tt.lvlSel=e,void 0===m(Rt[e],"id").effects||null===m(Rt[e],"id").effects)Tt.effects=[];else{Tt.effects=[];for(n=0;n<m(Rt[e],"id").effects.length;n++){for(var r in Tt.effects[n]=[],m(Rt[e],"id").effects[n])Tt.effects[n][r]=m(Rt[e],"id").effects[n][r];void 0===Tt.effects[n].bpm&&(Tt.bpm=120,Tt.effects[n].bpm=m(Rt[e],"id").bpm,Tt.effects[n].time=Tt.effects[n].time*(120/Tt.effects[n].bpm),Tt.effects[n].moveTime=Tt.effects[n].moveTime*(120/Tt.effects[n].bpm)),void 0===Tt.effects[n].offset&&(Tt.effects[n].offset=0)}}if(void 0===m(Rt[e],"id").sections||null===m(Rt[e],"id").sections)Tt.sections=[];else{Tt.sections=[];for(n=0;n<m(Rt[e],"id").sections.length;n++){for(var r in Tt.sections[n]=[],m(Rt[e],"id").sections[n])Tt.sections[n][r]=m(Rt[e],"id").sections[n][r];void 0===Tt.sections[n].bpm&&(Tt.bpm=120,Tt.sections[n].bpm=m(Rt[e],"id").bpm,Tt.sections[n].time=Tt.sections[n].time*(120/Tt.sections[n].bpm)),void 0===Tt.sections[n].offset&&(Tt.sections[n].offset=0)}}}void 0!==Tt.hw&&null!==Tt.hw||(Tt.hw=Tt.oldAr),Tt.beat.sort(function(e,t){return e[1]-t[1]});for(n=Tt.beat.length-1;0<=n;n--)(isNaN(Tt.beat[n][0])||isNaN(Tt.beat[n][1])||null===Tt.beat[n][0]||null===Tt.beat[n][1])&&Tt.beat.splice(n,1),void 0===Tt.beat[n][16]&&(Tt.beat[n][16]=255),void 0===Tt.beat[n][17]&&(Tt.beat[n][17]=255);Tt.effects.sort(function(e,t){return e.time-t.time}),Tt.sections.sort(function(e,t){return e.time-t.time});for(n=Tt.sections.length-1;0<=n;n--)void 0===Tt.sections[n].saturation&&(Tt.sections[n].saturation=255),void 0===Tt.sections[n].brightness&&(Tt.sections[n].brightness=255);if(!1===Tt.edit)for(n=Tt.sections.length-1;0<=n;n--)!1===Tt.sections[n].visible&&Tt.sections.splice(n,1);Tt.overlayGraphics={wide:[],normal:[]};for(var h=[],h=2!==Bt.settings.keyboard?Tt.keyDisplay[Bt.settings.language]:Tt.keyDisplayNum,n=0;n<9;n++){var a=2*ceil((width<height?height:width)/24/2);Tt.overlayGraphics.normal[n]=createGraphics(a,a,P2D),Tt.overlayGraphics.normal[n].background(0,0),Tt.overlayGraphics.normal[n].textAlign(CENTER,CENTER),Tt.overlayGraphics.normal[n].fill(255),Tt.overlayGraphics.normal[n].noStroke(),Tt.overlayGraphics.normal[n].strokeWeight(0),Tt.overlayGraphics.normal[n].textFont(Ee),Tt.overlayGraphics.normal[n].textSize(a),Tt.overlayGraphics.normal[n].text(h[n],a/2,a/2)}if(Ie=height<width?height/4:width/4,Ae=height<width?height/4:width/4,u.boxR=0,Tt.lineFade=0,Tt.loaded=!1,u.dropTime=0,u.finished=!1,Tt.disMode=0,!1===Tt.edit?Tt.time="set":!0===Tt.edit&&(Tt.time=0),Tt.timeStart=!1,Tt.next=[],Tt.prt=[],Tt.songPlaying=!1,Tt.hp=100,Tt.hpDis=100,Tt.hpPerm=[],Tt.hpPermScan=[0,0],Tt.keysHeld=[!1,!1,!1,!1,!1,!1,!1,!1,!1],Tt.score=0,Tt.scoreDis=0,Tt.combo=0,Tt.comboMax=0,Tt.hitStats=[0,0,0,0],Tt.winEase=[0,0,0,0],Tt.acc=100,Tt.accDis=0,Tt.accScore=0,Tt.accHits=0,Tt.missPrt=[],Tt.missTiles=[[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],Tt.headerY=0,u.finishFade=0,Tt.transBackA=255,Tt.board.str=0,Tt.failed=!1,Tt.paused=!1,Tt.playingOffset=0,Tt.resumeTime=!1,Tt.playbackRate=1,Tt.scoreSubmitted=!1,Tt.selectedBeats=[],Tt.saved=!1,Tt.menu=!1,Tt.exiting=!1,Tt.hitError=[],Tt.ctrlHeld=!1,Tt.shiftHeld=!1,Tt.keysPressed=[!1,!1,!1,!1,!1,!1,!1,!1,!1],Tt.tilePress=[0,0,0,0,0,0,0,0,0],Tt.tilePressDis=[0,0,0,0,0,0,0,0,0],Tt.tilePressRelease=[!0,!0,!0,!0,!0,!0,!0,!0,!0],Tt.lastHitTile=4,Tt.newScore.cur=0,Tt.newScore.curMult=0,Tt.newScore.past=0,Tt.newScore.miss=1,Tt.newScore.log=[],Tt.newScore.press=[],Tt.newScore.release=[],Tt.replay.pressI=0,Tt.replay.releaseI=0,Tt.replay.logI=0,Tt.selectedBeats=[],Tt.selectedBeatsLast=[],Tt.effectMultiSel=[],Tt.effectMultiSelLast=[],Tt.effectClipboard=[],Tt.beatClipboard=[],Tt.transitionIn=0,Tt.transitionOut=3,Tt.beatColor=141,Tt.beatSaturation=255,Tt.beatBrightness=255,Tt.metronomeFlip=!1,Tt.drawEffects=[],Tt.queueEditorMusic=!1,Tt.effectsFinished=[],Tt.effectsCache={},Tt.lastPrt=void 0,Tt.preLevelStart=!1,Tt.sectionsSelected=[],Tt.sectionsSelectedLast=[],Tt.newHits=[],Tt.outroTimer=!1,Tt.sectionPerformance=[],Tt.sectionAcc=[],Tt.endMillis=!1,Tt.performanceChart=!1,Tt.sectionCarouselIndex=0,Tt.sectionBarWidth=0,Tt.tileTrail=[],Tt.tileTrailLast=[0,0,0,0,0,0,0,0,0],Tt.retry?Tt.quickRetry?(Tt.preLevelStart=millis()-5e3+1e3,Tt.playingOffset=-1/60*Tt.bpm):Tt.preLevelStart=millis()-5e3+2e3:Tt.preLevelStart=millis()-5e3+5e3,(Tt.songEnded=!1)===Tt.timelineBPM&&!1===Tt.timelineOffset&&(Tt.timelineBPM=120,Tt.timelineOffset=0),void 0!==Bt.lvl.prevPlay&&void 0!==Qt[Bt.lvl.prevPlay]&&(soundManager.stop(Bt.lvl.prevPlay),Qt[Bt.lvl.prevPlay].stop()),soundManager.stop(Tt.song),soundManager.setVolume(Tt.song,Bt.settings.musicVolume),soundManager.setPlaybackRate(Tt.song,1),void 0!==Qt[Tt.song]&&(Qt[Tt.song].stop(),Qt[Tt.song].volume(Bt.settings.musicVolume/100),Qt[Tt.song].rate(1)),ti=ei=!1,Tt.edit)for(var r in Tt.mods)Tt.mods[r]=Tt.modsDef[r];else{if(soundManager.setPlaybackRate(Tt.song,Tt.mods.bpm),Tt.bpm*=Tt.mods.bpm,Tt.oldAr*=Tt.mods.foresight,Tt.hw*=Tt.mods.hitWindow,Tt.mods.random)for(n=0;n<Tt.beat.length;n++)Tt.beat[n][0]=Ot(L(0,8));else if(Tt.mods.mirror){for(n=0;n<Tt.beat.length;n++)0===Tt.beat[n][0]?Tt.beat[n][0]=2:2===Tt.beat[n][0]?Tt.beat[n][0]=0:3===Tt.beat[n][0]?Tt.beat[n][0]=5:5===Tt.beat[n][0]?Tt.beat[n][0]=3:6===Tt.beat[n][0]?Tt.beat[n][0]=8:8===Tt.beat[n][0]&&(Tt.beat[n][0]=6);for(n=0;n<Tt.effects.length;n++)Tt.effects[n].moveX=-Tt.effects[n].moveX,Tt.effects[n].moveD=-Tt.effects[n].moveD,0===Tt.effects[n].tileID?Tt.effects[n].tileID=2:2===Tt.effects[n].tileID?Tt.effects[n].tileID=0:3===Tt.effects[n].tileID?Tt.effects[n].tileID=5:5===Tt.effects[n].tileID?Tt.effects[n].tileID=3:6===Tt.effects[n].tileID?Tt.effects[n].tileID=8:8===Tt.effects[n].tileID&&(Tt.effects[n].tileID=6)}if(0!==Tt.mods.startPos){var l=Tt.bpm*(Tt.mods.startPos/Tt.mods.bpm/1e3/60);for(const g of Tt.beat)g[1]-=l;Tt.beat=Tt.beat.filter(e=>-1e-5<=e[1]);for(const d of Tt.effects)d.time-=l;for(const c of Tt.sections)c.time-=l;Tt.songOffset+=Tt.mods.startPos}if(0!==Tt.mods.endPos){const f=Tt.bpm*((Tt.mods.endPos-Tt.mods.startPos)/Tt.mods.bpm/1e3/60);Tt.beat=Tt.beat.filter(e=>e[1]<=1e-5+f)}}if(Tt.timeEnd=Mi(),Tt.scoreMax=100*Tt.beat.length*10,Tt.ar=Tt.bpm/60/2*Tt.oldAr,Tt.arInit=Tt.ar,Tt.hw=Tt.bpm/60/2*Tt.hw,"new"===t&&(Rt=Uo(Ht.saved,"dateDesc"),Bt.lvl.searchSent=!1),void 0===Tt.gameVersion||Tt.gameVersion<4)for(n=0;n<Tt.effects.length;n++){var d=Tt.effects[n];void 0!==d.tileID&&!1===Array.isArray(d.tileID)&&(!1===isNaN(d.tileID)?d.tileID=[constrain(d.tileID,0,9)]:d.tileID=[]),9===d.type&&(void 0===d.backgroundAlpha&&(void 0!==d.transparency?(d.backgroundAlpha=d.transparency,d.highlightAlpha=d.transparency,d.targetBackgroundAlpha=d.transparency+d.moveTransparency,d.targetHighlightAlpha=d.transparency+d.moveTransparency):(d.backgroundAlpha=255,d.highlightAlpha=255,d.targetBackgroundAlpha=255,d.targetHighlightAlpha=255)),void 0===d.targetHighlightColor&&(void 0!==d.moveHighlightColor?(d.targetHighlightColor=d.highlightColor+d.moveHighlightColor,255<d.targetHighlightColor&&(d.targetHighlightLoops=floor(d.targetHighlightColor/255),d.targetHighlightColor=d.targetHighlightColor%255,d.targetHighlightSmooth=!1),d.moveHighlightColor=void 0):(d.targetHighlightLoops=0,d.targetHighlightColor=d.highlightColor,d.targetHighlightSmooth=!1)),void 0===d.highlightSaturation)&&(d.highlightSaturation=255,d.targetHighlightSaturation=255,d.highlightBrightness=255,d.targetHighlightBrightness=255,d.backgroundColor=141,d.targetBackgroundColor=141,d.backgroundSaturation=0,d.targetBackgroundSaturation=0,d.backgroundBrightness=255,d.targetBackgroundBrightness=255),void 0===d.displaySaturation&&(d.displaySaturation=255,d.displayBrightness=255)}for(n=0;n<Tt.effects.length;n++){d=Tt.effects[n];14===d.type&&(null!==d.trailLength&&void 0!==d.trailLength||(d.trailLength=0),null!==d.trailSpacing&&void 0!==d.trailSpacing||(d.trailSpacing=0),null!==d.trailAlpha&&void 0!==d.trailAlpha||(d.trailAlpha=0),null!==d.trailDelete&&void 0!==d.trailDelete||(d.trailDelete=!1),null!==d.trailColor&&void 0!==d.trailColor||(d.trailColor=!0))}!(Tt.submittedScore=null)!==i&&(Vi("game","menu"),Bt.lvl.loading=!0)}function Zi(e){var t,i,o=0;0===Tt.beat[e][5]?o=(Tt.time-Tt.beat[e][1])/Tt.hw:1===Tt.beat[e][5]&&(t=(Tt.time-Tt.beat[e][8]-Tt.beat[e][1])/Tt.hw,i=(Tt.time-(Tt.beat[e][1]+Tt.beat[e][6]))/Tt.hw,o=(abs(t)<abs(i)?abs(i):abs(t))*(i<0?-1:1),o=constrain(o,-Tt.hitValues[Tt.hitValues.length-1].timing,Tt.hitValues[Tt.hitValues.length-1].timing));for(var n=0;n<Tt.hitValues.length;n++){var s=Tt.hitValues[n];if(!(s.timing<abs(o)&&n!==Tt.hitValues.length-1)){Tt.newScore.log.push(s.points),Tt.sectionPerformance.push([Tt.beat[e][1],n,o]),Tt.score+=s.points,s.comboBreak?(0!==Tt.combo&&lowLag.play("comboBreak",Bt.settings.comboBreakVolume/100),Tt.combo=0):Tt.combo++,Tt.hitStats[n]++,Tt.hp+=s.hp*(s.hp<0?Tt.hpD:1),Tt.newHits.push({type:n,time:Tt.time,error:o,tile:Tt.beat[e][0],noteType:Tt.beat[e][5]});break}}}function ji(e){for(var t=0,i=0,o=1,n=0;n<e.length;n++)0!==e[n]?(t/=0<i?i:1,i+=(100===e[n]||150===e[n]?1:50===e[n]?.8:.6)/o,t=(t+e[n])*i,o-=1<o?1:0):o=16;return t/2}function Gi(e){var t=0;if(null!=e){for(var i=0;i<e.length;i++)t+=150===e[i]?125:e[i];t*=Math.pow(Zo(e,!0),3)}return isNaN(t)?0:10*t}function Yi(e){Ht.saved[e].stars=void 0,Ht.saved[e].beat=[];for(var t=0;t<Tt.beat.length;t++){Ht.saved[e].beat[t]=[];for(var i=0;i<Tt.beat[t].length;i++)Ht.saved[e].beat[t][i]=Tt.beat[t][i]}Ht.saved[e].bpm=Tt.bpm,Ht.saved[e].ar=Tt.oldAr,Ht.saved[e].hw=Tt.hw,Ht.saved[e].hpD=Tt.hpD,Ht.saved[e].song=Tt.song,Ht.saved[e].bg=Tt.bg,Ht.saved[e].songOffset=Tt.songOffset,Ht.saved[e].title=Tt.title,Ht.saved[e].desc=Tt.desc,Ht.saved[e].gameVersion=gt,Ht.saved[e].effects=JSON.parse(JSON.stringify(Tt.effects)),Ht.saved[e].sections=JSON.parse(JSON.stringify(Tt.sections)),console.log("a\n"+Ht.saved),localStorage.setItem("pulsusGammaNewLvl",JSON.stringify(Ht.saved)),Ht.savedDiffReq[e]=!1,Tt.saved=!0,Tt.saveNotice=1}function Ji(){Ht.saved[Ht.saved.length]={};var e=Ht.saved.length-1;Ht.saved[e].local=!0,Ht.saved[e].beat=[],Ht.saved[e].effects=[],Ht.saved[e].sections=[],Ht.saved[e].bpm=120,Ht.saved[e].ar=2,Ht.saved[e].hw=2,Ht.saved[e].hpD=15,Ht.saved[e].song=1203,Ht.saved[e].bg=De.bg,Ht.saved[e].songOffset=0,Ht.saved[e].title="New Map",Ht.saved[e].desc="",Ht.saved[e].author=0<T.uuid.length?T.uuid:null,Tt.edit=!0,qi(e,"new")}function _i(e){B("downloadLevel",{id:e})}function $i(e){return Ot(1e4*parseFloat(e))/1e4}function eo(){soundManager.setup({debugMode:!1,onready:function(){soundManager.createSound({id:eo,url:"/client/resources/sound/pulsusOpen.mp3"});soundManager.play(eo,{onfinish:function(){}})},ontimeout:function(){alert("Switch to a better browser you memehead\nSeriously though, if you're seeing this message, contact us at pulsusgame@gmail.com with error openSound")}})}function to(){soundManager.setup({onready:function(){var e=soundManager.createSound({id:"menuMusic",url:0===Bt.settings.menuMusic.length?"/client/resources/sound/pulsusMenu.mp3":Bt.settings.menuMusic});soundManager.play("menuMusic",{onfinish:function(){to()}}),Bt.loopPlayState=e.playState},ontimeout:function(){alert("Switch to a better browser you memehead\nSeriously though, if you're seeing this message, contact us at pulsusgame@gmail.com with error menuMusic")}})}var oo=new(window.AudioContext||window.webkitAudioContext),no=oo.createGain();const so=new Set,ro=new Set;function ho(e,t){"Loading..."!==Lt(e,"id").link&&("Deactivated"!==Lt(e,"id").link||so.has(e)||(Gn({type:"error",message:"menu_lvl_deactivatedSong"}),so.add(e)),Qt=Tt.mods.noPitch?Ge:je,ti||(void 0===je[e]&&!Tt.mods.noPitch||void 0===Ge[e]&&Tt.mods.noPitch?Tt.mods.noPitch?(ti=!0,Ge[e]=new Howl({src:[Lt(e,"id").link],html5:!0})):(ti=!0,je[e]=new Howl({src:[Lt(e,"id").link],html5:!1})):ro.has(e)&&(console.log("Loaded else"),ei=!0,Qt[e].volume(Bt.settings.musicVolume/100))),Qt[e].on("load",function(){console.log("Loaded callback"),ei=!0,Qt[e].volume(Bt.settings.musicVolume/100),ro.add(e)}))}function ao(e,t){"Loading..."!==Lt(e,"id").link&&soundManager.setup({onready:function(){soundManager.createSound({id:e,url:Lt(e,"id").link})},ontimeout:function(){alert("Switch to a better browser you memehead\nSeriously though, if you're seeing this message, contact us at pulsusgame@gmail.com with error lvlSong ID"+e)}})}function lo(e){soundManager.setup({onready:function(){soundManager.createSound({id:e+"verify",url:e})},ontimeout:function(){alert("Switch to a better browser you memehead\nSeriously though, if you're seeing this message, contact us at pulsusgame@gmail.com with error verifySong ID"+e)}})}function go(e,t,i){i?(Bt.sideBtn.l1[0]+=At(0,Bt.sideBtn.l1[0],Bt.sideBtn.es),Bt.sideBtn.l1[1]+=At(0,Bt.sideBtn.l1[1],Bt.sideBtn.es),Bt.sideBtn.l1[2]+=At(height/32,Bt.sideBtn.l1[2],Bt.sideBtn.es),Bt.sideBtn.l1[3]+=At(height/32,Bt.sideBtn.l1[3],Bt.sideBtn.es),Bt.sideBtn.l2[0]+=At(0,Bt.sideBtn.l2[0],Bt.sideBtn.es),Bt.sideBtn.l2[1]+=At(height/32,Bt.sideBtn.l2[1],Bt.sideBtn.es),Bt.sideBtn.l2[2]+=At(height/32,Bt.sideBtn.l2[2],Bt.sideBtn.es),Bt.sideBtn.l2[3]+=At(0,Bt.sideBtn.l2[3],Bt.sideBtn.es),Bt.sideBtn.l3[0]+=At(0,Bt.sideBtn.l3[0],Bt.sideBtn.es),Bt.sideBtn.l3[1]+=At(height/32,Bt.sideBtn.l3[1],Bt.sideBtn.es),Bt.sideBtn.l3[2]+=At(height/32,Bt.sideBtn.l3[2],Bt.sideBtn.es),Bt.sideBtn.l3[3]+=At(0,Bt.sideBtn.l3[3],Bt.sideBtn.es),Ot(Bt.sideBtn.l1[3])===height/16*2&&(Bt.sideBtn.l1[0]=0,Bt.sideBtn.l1[1]=0,Bt.sideBtn.l1[2]=height/32,Bt.sideBtn.l1[3]=height/32,Bt.sideBtn.l2[0]=0,Bt.sideBtn.l2[1]=height/32,Bt.sideBtn.l2[2]=height/32,Bt.sideBtn.l2[3]=0,Bt.sideBtn.l3[0]=0,Bt.sideBtn.l3[1]=height/32,Bt.sideBtn.l3[2]=height/32,Bt.sideBtn.l3[3]=0)):(Bt.sideBtn.l1[0]+=At(0,Bt.sideBtn.l1[0],Bt.sideBtn.es),Bt.sideBtn.l1[1]+=At(0,Bt.sideBtn.l1[1],Bt.sideBtn.es),Bt.sideBtn.l1[2]+=At(height/32,Bt.sideBtn.l1[2],Bt.sideBtn.es),Bt.sideBtn.l1[3]+=At(0,Bt.sideBtn.l1[3],Bt.sideBtn.es),Bt.sideBtn.l2[0]+=At(0,Bt.sideBtn.l2[0],Bt.sideBtn.es),Bt.sideBtn.l2[1]+=At(height/64,Bt.sideBtn.l2[1],Bt.sideBtn.es),Bt.sideBtn.l2[2]+=At(height/32,Bt.sideBtn.l2[2],Bt.sideBtn.es),Bt.sideBtn.l2[3]+=At(height/64,Bt.sideBtn.l2[3],Bt.sideBtn.es),Bt.sideBtn.l3[0]+=At(0,Bt.sideBtn.l3[0],Bt.sideBtn.es),Bt.sideBtn.l3[1]+=At(height/32,Bt.sideBtn.l3[1],Bt.sideBtn.es),Bt.sideBtn.l3[2]+=At(height/32,Bt.sideBtn.l3[2],Bt.sideBtn.es),Bt.sideBtn.l3[3]+=At(height/32,Bt.sideBtn.l3[3],Bt.sideBtn.es),0===Ot(Bt.sideBtn.l1[3])&&(Bt.sideBtn.l1[0]=0,Bt.sideBtn.l1[1]=0,Bt.sideBtn.l1[2]=height/32,Bt.sideBtn.l1[3]=0,Bt.sideBtn.l2[0]=0,Bt.sideBtn.l2[1]=height/64,Bt.sideBtn.l2[2]=height/32,Bt.sideBtn.l2[3]=height/64,Bt.sideBtn.l3[0]=0,Bt.sideBtn.l3[1]=height/32,Bt.sideBtn.l3[2]=height/32,Bt.sideBtn.l3[3]=height/32)),push(),translate(e,t),line(Bt.sideBtn.l1[0],Bt.sideBtn.l1[1],Bt.sideBtn.l1[2],Bt.sideBtn.l1[3]),line(Bt.sideBtn.l2[0],Bt.sideBtn.l2[1],Bt.sideBtn.l2[2],Bt.sideBtn.l2[3]),line(Bt.sideBtn.l3[0],Bt.sideBtn.l3[1],Bt.sideBtn.l3[2],Bt.sideBtn.l3[3]),pop()}function co(e){for(var t=0;t<v.userStatus.length+1;t++){if(!(t<v.userStatus.length))return 0;if(v.userStatus[t][0]===e)return v.userStatus[t][1]<w-10?0:1}}function fo(e){var t=e.substr(0,2),i=e.substr(3,3),e=e.substr(7,4),o="";switch(i){case"Jan":o=Pt("month_jan",xt);break;case"Feb":o=Pt("month_feb",xt);break;case"Mar":o=Pt("month_mar",xt);break;case"Apr":o=Pt("month_apr",xt);break;case"May":o=Pt("month_may",xt);break;case"Jun":o=Pt("month_jun",xt);break;case"Jul":o=Pt("month_jul",xt);break;case"Aug":o=Pt("month_aug",xt);break;case"Sep":o=Pt("month_sep",xt);break;case"Oct":o=Pt("month_oct",xt);break;case"Nov":o=Pt("month_nov",xt);break;case"Dec":o=Pt("month_dec",xt)}return"es"===xt?t+" de "+o+", "+e:"fr"===xt?t+" "+o+" "+e:"ru"===xt?t+" "+o+", "+e:"nl"===xt?t+" "+o+" "+e:"th"===xt?t+" "+o+" "+(parseInt(e)+543):"ro"===xt?t+" "+o+" "+e:o+" "+t+", "+e}function uo(e,t){""!==e&&("incoming"===t?void 0===v.grabbedIncFriendReqs[e]&&B("grabIncFriendReqs",{user:e,session:T.session}):"outgoing"===t&&void 0===v.grabbedOutFriendReqs[e]&&B("grabOutFriendReqs",{user:e,session:T.session}))}function vo(e,t){return""===e?[]:"incoming"===t?void 0===v.grabbedIncFriendReqs[e]?[]:v.grabbedIncFriendReqs[e]:"outgoing"===t?void 0===v.grabbedOutFriendReqs[e]?[]:v.grabbedOutFriendReqs[e]:void 0}const mo=new Set;function po(e,t){return 0===e.length?[]:void 0===v.grabbedFriends[e]?(mo.has(e)||(B("grabFriends",{user:e,session:T.session}),mo.add(e)),[]):v.grabbedFriends[e]}function bo(e){""===T.uuid.length&&(uo(T.uuid,"incoming"),po(T.uuid)),Ut(e,"uuid")}function wo(e,t){kt=width>height?width/64:height/64,fill($.overlayShade),rect(kt,height/16+kt,width/3*1.5,height/3,kt),rectMode(CORNER),fill($.text),"Loading..."!==Ut(e,"uuid").pp&&void 0!==Ut(e,"uuid").pp&&Wt(_t(Ut(e,"uuid").pp),"stretch",2*kt,height/16+2*kt,(width>height?height:width)/3-2*kt,(width>height?height:width)/3-2*kt),"self"===t&&(Ft("rcorner",2*kt,height/16+2*kt,(width>height?height:width)/3-2*kt,(width>height?height:width)/3-2*kt)?Bt.account.self.ppFade+=At(1,Bt.account.self.ppFade,.2):Bt.account.self.ppFade+=At(0,Bt.account.self.ppFade,.2),noStroke(),fill(0,200*Bt.account.self.ppFade),rect(2*kt,height/16+2*kt,(width>height?height:width)/3-2*kt,(width>height?height:width)/3-2*kt),fill(255,200*Bt.account.self.ppFade),textAlign(CENTER,CENTER),Dt(Pt("menu_account_changePP",xt),2*kt+((width>height?height:width)/3-2*kt)/2,height/16+2*kt+((width>height?height:width)/3-2*kt)/2,(width>height?height:width)/3-4*kt,(width>height?height:width)/3-4*kt)),fill(0,200),strokeWeight(kt/2),ellipseMode(CENTER),stroke($.overlayShade),v.newGUUnix[e]-Ut(e,"uuid").online<4?fill(0,255,0):fill(200),ellipse(2*kt+(width>height?height:width)/3-2*kt-2*kt/4,height/16+2*kt+(width>height?height:width)/3-2*kt-2*kt/4,2*kt,2*kt),noStroke(),fill($.text),textAlign(LEFT,CENTER),Dt(Ut(e,"uuid").user+"\n#"+Ut(e,"uuid").rank+" "+Pt("performancePoints",xt,floor(100*Tn(e))/100),3*kt+(width>height?height:width)/3-2*kt,height/16+kt+(width>height?height:width)/3/4*1.5,width/3*1.5-(width>height?height:width)/3-2*kt,(width>height?height:width)/3/2/2),"Loading..."!==Ut(e,"uuid").country&&Dt(W(Ut(e,"uuid").country,xt),3*kt+(width>height?height:width)/3-2*kt,height/16+kt+(width>height?height:width)/3/4*3,width/3*1.5-(width>height?height:width)/3-2*kt,(width>height?height:width)/3/4/1.5);Dt(v.newGUUnix[e]-Ut(e,"uuid").online<15?"game"===Ut(e,"uuid").statusScreen[0]?"local"!==Ut(e,"uuid").statusScreen[1]?Pt("menu_account_status_gameOnline",xt,H(Ut(e,"uuid").statusScreen[1],"id").title,void 0!==Ut(H(Ut(e,"uuid").statusScreen[1],"id").author,"uuid").user?Ut(H(Ut(e,"uuid").statusScreen[1],"id").author,"uuid").user:Pt("defaultUsername",xt),Ut(e,"uuid").statusScreen[1]):Pt("menu_account_status_gameLocal",xt):"edit"===Ut(e,"uuid").statusScreen[0]?Pt("menu_account_status_edit",xt):Pt("menu_account_status_menu",xt):(i="menu_account_status_lastOnline_seconds",60<=(o=w-Ut(e,"uuid").online)&&(i="menu_account_status_lastOnline_minutes",60<=(o/=60))&&(i="menu_account_status_lastOnline_hours",24<=(o/=60))&&(i="menu_account_status_lastOnline_days",30.5<=(o/=24))&&(o/=30.5,i="menu_account_status_lastOnline_months"),Pt("menu_account_status_lastOnline",xt,floor(o),Pt(i,xt))),3*kt+(width>height?height:width)/3-2*kt,height/16+kt+(width>height?height:width)/3/4*3+1.5*kt,width/3*1.5-(width>height?height:width)/3-2*kt,(width>height?height:width)/3/4/1.5/2),"self"===t&&(Ft("rcorner",3*kt+(width>height?height:width)/3-2*kt,height/16+kt+(width>height?height:width)/3/4*3-(width>height?height:width)/3/4/1.5/2,width/3*1.5-(width>height?height:width)/3-2*kt,(width>height?height:width)/3/4/1.5)?Bt.account.self.countryFade+=At(1,Bt.account.self.countryFade,.2):Bt.account.self.countryFade+=At(0,Bt.account.self.countryFade,.2),fill(0,200*Bt.account.self.countryFade),rect(3*kt+(width>height?height:width)/3-2*kt,height/16+kt+(width>height?height:width)/3/4*3-(width>height?height:width)/3/4/1.5/2,width/3*1.5-(width>height?height:width)/3-2*kt,(width>height?height:width)/3/4/1.5),textAlign(CENTER,CENTER),fill(255,255*Bt.account.self.countryFade),Dt(Pt("menu_account_changeCountry",xt),3*kt+(width>height?height:width)/3-2*kt+(width/3*1.5-(width>height?height:width)/3-2*kt)/2,height/16+kt+(width>height?height:width)/3/4*3-(width>height?height:width)/3/4/1.5/2+(width>height?height:width)/3/4/1.5/2,width/3*1.5-(width>height?height:width)/3-4*kt,(width>height?height:width)/3/4/1.5/1.5)),!0===Ut(e,"uuid").contributor&&(fill(0,255,0),image(St.contributorBadge,kt+width/3*1.5-2.5*kt*(Ut(e,"uuid").patreon>w?2:1),height/16+kt+height/3-2.5*kt,2*kt,2*kt)),Ut(e,"uuid").patreon>w&&(fill(0,255,0),image(St.platinumBadge,kt+width/3*1.5-2.5*kt,height/16+kt+height/3-2.5*kt,2*kt,2*kt)),fill($.overlayShade),rect(kt,height/16+2*kt+height/3,width/3*1.5,height/3*2-height/16-3*kt,kt),fill($.text),textAlign(LEFT,TOP),textSize(kt);var i,o=Ut(e,"uuid"),n=(void 0!==o?.bio?text('"'+o.bio+'"',2*kt,height/16+3*kt+height/3,width/3*1.5-2*kt,height/3*2-height/16-5*kt):(textAlign(CENTER,CENTER),Dt(Pt("menu_account_noBio",xt),kt+width/3*1.5/2,height/16+2*kt+height/3+(height/3*2-height/16-3*kt-3*kt)/2,width/3*1.5/1.5,kt)),"self"===t&&(Ft("rcorner",kt,height/16+2*kt+height/3,width/3*1.5,height/3*2-height/16-3*kt-3*kt)?Bt.account.self.bioFade+=At(1,Bt.account.self.bioFade,.2):Bt.account.self.bioFade+=At(0,Bt.account.self.bioFade,.2),fill(0,200*Bt.account.self.bioFade),rect(kt,height/16+2*kt+height/3,width/3*1.5,height/3*2-height/16-3*kt-3*kt,kt,kt,0,0),fill(255,255*Bt.account.self.bioFade),textAlign(CENTER,CENTER),Dt(Pt("menu_account_changeBio",xt),kt+width/3*1.5/2,height/16+2*kt+height/3+(height/3*2-height/16-3*kt-3*kt)/2,width/3*1.5/1.5,(height/3*2-height/16-3*kt-3*kt)/1.5)),fill($.main),rect(kt,height-4*kt,width/3*1.5,kt),textAlign(LEFT,CENTER),fill($.text),Dt(Pt("menu_account_joinedSince",xt,void 0===o?.joined?Pt("menu_account_unknownJoinDate",xt):fo(new Date(1e3*o.joined).toUTCString().slice(5,16))),2*kt,height-2*kt,width/3*1.5,kt),fill($.overlayShade),rect(2*kt+width/3*1.5,height/16+kt,width/3.5,height-height/16-2*kt,kt),pn(e,"user")),s=0;if("Loading..."!==n&&"no scores"!==n){for(var r=0;r<n.length;r++)n[r].performance>s&&(s=n[r].performance);for(r=0;r<(16<n.length?16:n.length);r++){var h=Ot(n[r].score*wn(n[r].mods)),a=(push(),translate(2*kt+width/3*1.5,height/16+kt+(height-height/16-2*kt)/16*r),fill($.text),textAlign(LEFT,CENTER),H(n[r].lvl,"id").title);Dt(a=n[r].mods!==Tt.modsDef?a+"\n"+Vo(n[r].mods):a,2*kt,(height-height/16-2*kt)/16/2,width/3.5/2,(height-height/16-2*kt)/16/1.5/2),textAlign(RIGHT,CENTER),Dt(h+"\n"+Pt("performancePoints",xt,floor(100*n[r].performance)/100),width/3.5-2*kt,(height-height/16-2*kt)/16/2,width/3.5/2,(height-height/16-2*kt)/16/1.5/2),fill(on(n[r].failed?Tt.ranks.length-1:tn(h/rn(n[r].lvl,"online")))),textAlign(CENTER,CENTER),Dt((n[r].failed?Tt.ranks[Tt.ranks.length-1]:Tt.ranks[tn(h/rn(n[r].lvl,"online"))]).symbol,width/3.5-kt,(height-height/16-2*kt)/16/2,2*kt,(height-height/16-2*kt)/16/1.5,"bold"),imageMode(CENTER),Po(kt,(height-height/16-2*kt)/16/2,kt,kt,Bn(n[r].lvl),H(n[r].lvl,"id").ranked,H(n[r].lvl,"id").special),pop()}}"self"===t?(fill(255),rectMode(CORNER),noStroke(),Kt(3*kt+width/3*1.5+width/3.5,height/16+kt,width/6.5,height/16,Pt("menu_account_friends",xt),Bt.account.buttonHover,6),fill(255),rectMode(CORNER),noStroke(),Kt(3*kt+width/3*1.5+width/3.5,2*(height/16+kt),width/6.5,height/16,Pt("menu_account_friendRequests",xt,vo(o.uuid,"incoming").length),Bt.account.buttonHover,7),fill(255),rectMode(CORNER),noStroke(),Kt(3*kt+width/3*1.5+width/3.5,3*(height/16+kt),width/6.5,height/16,Pt("refresh",xt),Bt.account.buttonHover,8),fill(255),rectMode(CORNER),noStroke(),Kt(3*kt+width/3*1.5+width/3.5,4*(height/16+kt),width/6.5,height/16,Pt("menu_account_logOut",xt),Bt.account.buttonHover,5)):0===o.uuid.length?(fill(255),rectMode(CORNER),noStroke(),Kt(3*kt+width/3*1.5+width/3.5,height/16+kt,width/6.5,height/16,Pt("refresh",xt),Bt.account.buttonHover,8),fill(255),rectMode(CORNER),noStroke(),Kt(3*kt+width/3*1.5+width/3.5,2*(height/16+kt),width/6.5,height/16,Pt("menu_back",xt),Bt.account.buttonHover,5)):-1!==vo(o.uuid,"incoming").indexOf(e)?(fill(255),rectMode(CORNER),noStroke(),Kt(3*kt+width/3*1.5+width/3.5,height/16+kt,width/6.5,height/16,Pt("menu_account_acceptFriendRequest",xt),Bt.account.buttonHover,6),fill(255),rectMode(CORNER),noStroke(),Kt(3*kt+width/3*1.5+width/3.5,2*(height/16+kt),width/6.5,height/16,Pt("menu_account_denyFriendRequest",xt),Bt.account.buttonHover,7),fill(255),rectMode(CORNER),noStroke(),Kt(3*kt+width/3*1.5+width/3.5,3*(height/16+kt),width/6.5,height/16,Pt("refresh",xt),Bt.account.buttonHover,8),fill(255),rectMode(CORNER),noStroke(),Kt(3*kt+width/3*1.5+width/3.5,4*(height/16+kt),width/6.5,height/16,Pt("menu_back",xt),Bt.account.buttonHover,5)):(fill(255),rectMode(CORNER),noStroke(),Kt(3*kt+width/3*1.5+width/3.5,height/16+kt,width/6.5,height/16,-1!==vo(o.uuid,"outgoing").indexOf(e)?Pt("menu_account_revokeFriendRequest",xt):-1!==vo(o.uuid,"incoming").indexOf(e)?Pt("menu_account_acceptFriendRequest",xt):-1!==po(o.uuid).indexOf(e)?Pt("menu_account_removeFriend",xt):Pt("menu_account_sendFriendRequest",xt),Bt.account.buttonHover,6),fill(255),rectMode(CORNER),noStroke(),Kt(3*kt+width/3*1.5+width/3.5,2*(height/16+kt),width/6.5,height/16,Pt("refresh",xt),Bt.account.buttonHover,7),fill(255),rectMode(CORNER),noStroke(),Kt(3*kt+width/3*1.5+width/3.5,3*(height/16+kt),width/6.5,height/16,Pt("menu_back",xt),Bt.account.buttonHover,5))}function Co(e){var t=width>height?width/64:height/64;0!==Mt()&&("main"===e?Bt.online.scroll-=height/12/2*(Mt()/100):"incFR"===e&&(Bt.account.incFR.scroll-=height/12/2*(Mt()/100))),Vt*=.25,-(t+height/16+height/24+5*t*floor((Bt.online.searchedUsers.length-1)/3))+height-5*t<0?"main"===e?Bt.online.scroll=constrain(Bt.online.scroll,-(t+height/16+height/24+5*t*floor((Bt.online.searchedUsers.length-1)/3))+height-5*t,0):"incFR"===e&&(Bt.online.incFR.scroll=constrain(Bt.online.incFR.scroll,-(t+height/16+height/24+5*t*floor((Bt.online.searchedUsers.length-1)/3))+height-5*t,0)):"main"===e?Bt.online.scroll=constrain(Bt.online.scroll,-(t+height/16+height/24+5*t*floor((height/(4*t)*3-1)/3))+height-5*t,0):"incFR"===e&&(Bt.account.incFR.scroll=constrain(Bt.account.incFR.scroll,-(t+height/16+height/24+5*t*floor((height/(4*t)*3-1)/3))+height-5*t,0)),0===Bt.online.searchedUsers.length&&!1===Bt.trans&&("main"===e?Fo(0===Bt.online.search.length?0:Bt.online.search,Bt.online.searchOnline,e):Fo(0===Bt.account.friendSearch.length?0:Bt.account.friendSearch,Bt.account.onlineOnly,e)),rectMode(CORNER),ellipseMode(CENTER),textAlign(LEFT,CENTER),push(),-(t+height/16+height/24+5*t*floor((Bt.online.searchedUsers.length-1)/3))+height-5*t<0&&translate(0,Bt.online.scroll);for(var i=0;i<Bt.online.searchedUsers.length;i++)0<t+height/16+height/24+5*t*floor(i/3)+Bt.online.scroll&&t+height/16+height/24+5*t*floor(i/3)+Bt.online.scroll<height&&(fill($.overlayShade),noStroke(),rect(t+((width-width/48-4*t)/3+t)*(i%3),t+height/16+height/24+5*t*floor(i/3),(width-width/48-4*t)/3,4*t,t),fill($.text),Dt(Ut(Bt.online.searchedUsers[i],"uuid").user+" #"+Ut(Bt.online.searchedUsers[i],"uuid").rank,5*t+((width-width/48-4*t)/3+t)*(i%3),t+height/16+height/24+5*t*floor(i/3)+4*t/4*3/2,(width-width/48-4*t)/3-5*t,2*t),Dt("Loading..."!==Ut(Bt.online.searchedUsers[i],"uuid").country?W(Ut(Bt.online.searchedUsers[i],"uuid").country,xt):Ut(Bt.online.searchedUsers[i],"uuid").country,5*t+((width-width/48-4*t)/3+t)*(i%3),t+height/16+height/24+5*t*floor(i/3)+3*t,(width-width/48-4*t)/3-5*t,t),imageMode(CORNER),"Loading..."!==Ut(Bt.online.searchedUsers[i],"uuid").pp&&void 0!==Ut(Bt.online.searchedUsers[i],"uuid").pp&&Wt(_t(Ut(Bt.online.searchedUsers[i],"uuid").pp),"stretch",t+((width-width/48-4*t)/3+t)*(i%3)+t/2,t+height/16+height/24+5*t*floor(i/3)+t/2,3*t,3*t),v.newGUUnix[Bt.online.searchedUsers[i]]-Ut(Bt.online.searchedUsers[i],"uuid").online<=4?fill(0,255,0):fill(200,200,200),stroke($.overlayShade),strokeWeight(t/4),ellipse(t+((width-width/48-4*t)/3+t)*(i%3)+t/2+3*t-t/4,t+height/16+height/24+5*t*floor(i/3)+t/2+3*t-t/4,t,t));pop(),noStroke(),fill(30),rect(0,height/16,width,height/24),push(),imageMode(CENTER),translate(height/24/2,height/24/2),fill(255),("main"===e?Bt.online.searchOnline:Bt.account.onlineOnly)?image(St.userOnline,0,height/16,height/24/1.5,height/24/1.5):image(St.userOffline,0,height/16,height/24/1.5,height/24/1.5),pop(),!1===Bt.side&&(("main"===e?Bt.online.searchOnline:Bt.account.onlineOnly)?Xo(0,height/16,height/24,height/24,Pt("menu_online_tab_dontShowOffline",xt),("main"===e?Bt.online:Bt.account).tabHighlight,0):Xo(0,height/16,height/24,height/24,Pt("menu_online_tab_showOffline",xt),("main"===e?Bt.online:Bt.account).tabHighlight,0)),"main"!==e&&(Xo(height/24+width-height/24*4,height/16,height/24*3,height/24,!1,("main"===e?Bt.online:Bt.account).tabHighlight,1),textAlign(CENTER,CENTER),fill(255),Dt(Pt("menu_back",xt),height/24+width-height/24*4+height/24*3/2,height/16+height/24/2,height/24*3/1.5,height/24/1.5)),fill(10),rect(height/24,height/16,width-height/24*("main"!==e?4:1),height/24),textAlign(LEFT,CENTER);var e=0===Bt.online.search.length?Pt("menu_lvl_search",xt):Bt.online.search,o=0===Bt.online.search.length&&"italics",n=0===Bt.online.search.length?127.5:255;fill(255,n),Dt(e,height/24+height/24/2/2,height/16+height/24/2,width-height/24-height/24/2,height/24/2,o),fill(30),rect(width-width/48,height/16+height/24,width/48,height-(height/16+height/24)),fill($.scrollbar),rect(width-width/48,height/16+height/24+Bt.online.scroll/(-(t+height/16+height/24+5*t*floor((Bt.online.searchedUsers.length-1)/3))+height-5*t<0?-(t+height/16+height/24+5*t*floor((Bt.online.searchedUsers.length-1)/3))+height-5*t:-(t+height/16+height/24+5*t*floor((height/(4*t)*3-1)/3))+height-5*t)*(height-(height/16+height/24)-(height-(height/16+height/24))/12),width/48,(height-(height/16+height/24))/12),mouseIsPressed&&Ft("rcorner",width-width/48,height/16+height/24,width/48,height-(height/16+height/24))&&(Bt.online.scroll=(mouseY-(height/16+height/24)-(height-(height/16+height/24))/12/2)/(height-(height/16+height/24)-(height-(height/16+height/24))/12)*(-(t+height/16+height/24+5*t*floor((Bt.online.searchedUsers.length-1)/3))+height-5*t<0?-(t+height/16+height/24+5*t*floor((Bt.online.searchedUsers.length-1)/3))+height-5*t:-(t+height/16+height/24+5*t*floor((height/(4*t)*3-1)/3))+height-5*t))}function Wt(e,t,i,o,n,s){var r,h,a,l;"stretch"===t?image(e,i,o,n,s):"zoom"===t?(r=n/e.width,a=(h=s/e.height)<r?r:h,l=rectMode()._renderer._imageMode===CORNER,image(e,i-(l?(e.width*a-e.width*r)/2:0),o-(l?(e.height*a-e.height*h)/2:0),e.width*a,e.height*a)):"contain"===t&&(a=(r=n/e.width)<(h=s/e.height)?r:h,l=rectMode()._renderer._imageMode===CORNER,image(e,i-(l?(e.width*a-e.width*r)/2:0),o-(l?(e.height*a-e.height*h)/2:0),e.width*a,e.height*a))}class yo{static all=[];args;mode;static of(...e){return void 0===globalThis.color?new yo(...e):color(...arguments)}static resolveAll(){yo.all.forEach(e=>e.resolve())}constructor(){this.args=[...arguments],yo.all.push(this)}resolve(){var e,t=color(...this.args);for(e in Object.setPrototypeOf(this,t),this)delete this[e];Object.assign(this,t)}setRed(){throw"PromisedColor is not resolved"}setGreen(){throw"PromisedColor is not resolved"}setBlue(){throw"PromisedColor is not resolved"}setAlpha(){throw"PromisedColor is not resolved"}}class Eo{static maxDifficulty=6;static colors=new Map;static getColor(e){e="stars"+Math.floor(constrain(e,0,Eo.maxDifficulty));return Eo.colors.get(e)}difficulty;awarded;special;constructor(e,t,i=!1){this.difficulty=constrain(Math.floor(e)??0,0,Eo.maxDifficulty),this.awarded=t??!1,this.special=i}draw(e,t,i,o){push(),smooth(),rectMode(CENTER),ellipseMode(CENTER),angleMode(DEGREES),noStroke(),fill(255),ellipse(e,t,i,o),fill(this.#getBackgroundColor()),ellipse(e,t,.9*i,.9*o);var n=Math.ceil(i/25);fill(0,100),this.#drawSymbol(e+n,t+n,i,o),fill(this.#getSymbolColor()),this.#drawSymbol(e,t,i,o),pop(),ellipseMode(CENTER)}#getBackgroundColor(){return Eo.colors.get(this.awarded?this.#getMainColorKey():"na")??Eo.colors.get("na")}#getSymbolColor(){return Eo.colors.get(this.awarded?"white":this.#getMainColorKey())??Eo.colors.get("na")}#getMainColorKey(){return this.#isAwardedUnranked()?this.#getAwardKey():"stars"+this.difficulty}#isAwardedUnranked(){return this.special}#getAwardKey(){if(this.special)return"special"}#drawSymbol(e,t,i,o){if(push(),translate(e,t),this.special)for(var n=0;n<3;n++)push(),rotate(60*n),rect(0,0,i/9,o*(4/9),i),pop();else[0].includes(this.difficulty)&&rect(0,0,1.5*i/9,1.5*i/9,1.5*i/9),[1,3,5].includes(this.difficulty)&&rect(0,0,i/9,o*(4/9),i),[2,3,4,5,6].includes(this.difficulty)&&(rect(-i/9*1.5,0,i/9,o*(4/14),i),rect(i/9*1.5,0,i/9,o*(4/14),i)),[4,5,6].includes(this.difficulty)&&(rect(-i/9*3,0,i/9,i/9,i),rect(i/9*3,0,i/9,i/9,i)),[6].includes(this.difficulty)&&(e=i*(4/9),t=o*(4/14)/1.5,rect(0,-(e/2-t/2),i/9,t,i),rect(0,e/2-t/2,i/9,t,i));pop()}}function Po(e,t,i,o,n,s,r){new Eo(n,s,r).draw(e,t,i,o)}function Oo(e,t,i,o,n){var s;null==e&&(s=St.naDiff),s=e<=1?St.easyDiff:e<=2?St.mediumDiff:e<=3?St.hardDiff:e<=4?St.advancedDiff:4<e?St.insaneDiff:St.naDiff,smooth(),image(s,t,i,Ot(o/447*500),Ot(n/447*500))}function zo(e,t){Tt.edit=!1,Tt.replay.on=!0,Yn(Tt.mods,Tt.replay.preMods),"leaderboardData"===t?(Tt.replay.log=Bt.lvl.leaderboardData[e].log,Tt.replay.press=Bt.lvl.leaderboardData[e].press,Tt.replay.release=Bt.lvl.leaderboardData[e].release,Tt.replay.user=Bt.lvl.leaderboardData[e].user,Yn(Bt.lvl.leaderboardData[e].mods)):"id"===t&&(Tt.replay.log=e.log,Tt.replay.press=e.press,Tt.replay.release=e.release,Tt.replay.user=e.user,Yn(e.mods)),qi(Bt.lvl.sel)}function xo(){We.client?Dn(We.paste):navigator.clipboard.readText().then(e=>{Dn(e)}).catch(e=>{console.error("Failed to read clipboard contents: ",e)})}function So(e){We.client?window.parent.postMessage({type:"copyText",copy:e},"*"):navigator.clipboard.writeText(e)}var Bo=[],To=JSON.parse(localStorage.getItem("pulsusGammaSettings"));function Ho(e){B("upload",{level:{beat:Rt[e].beat,bpm:Rt[e].bpm,ar:Rt[e].ar,hw:Rt[e].hw,hpD:Rt[e].hpD,effects:Rt[e].effects,song:Rt[e].song,bg:Rt[e].bg,songOffset:Rt[e].songOffset,sections:Rt[e].sections,title:Rt[e].title,desc:Rt[e].desc,author:Rt[e].author},session:T.session}),Bt.lvl.uploadVar.a=Bt.lvl.sel}function Ro(e){B("updateLevel",{lvl:e,session:T.session})}function ko(e,t){for(var i=!1,o=0;o<v.grabbedUserData.length;o++)if("uuid"===t&&v.grabbedUserData[o][0]===e||"user"===t&&v.grabbedUserData[o][1]===e){if(void 0===v.grabbedUserDataTime[o]||null===v.grabbedUserDataTime[o]||millis()<v.grabbedUserDataTime[o]+3e3)return void 0!==v.grabbedUserDataTime[o]&&null!==v.grabbedUserDataTime[o]||(v.grabbedUserDataTime[o]=millis()),i=!0,{uuid:v.grabbedUserData[o][0],user:v.grabbedUserData[o][1],pp:v.grabbedUserData[o][2]};v.grabbedUserDataTime[o]=null,B("grabUserData",{a:e,mode:t,replace:o})}if(!1===i)return B("grabUserData",{a:e,mode:t,replace:!1}),{uuid:"ERROR",user:"ERROR",pp:"ERROR"}}function No(e,t){if("all"===t)B("grabSongDataAll"),v.grabbedSongDataAllTime=millis();else{for(var i=!1,o=0;o<v.grabbedSongData.length;o++)if("id"===t&&v.grabbedSongData[o][0]===e){if(void 0===v.grabbedSongDataTime[o]||null===v.grabbedSongDataTime[o]||millis()<v.grabbedSongDataTime[o]+3e3)return void 0!==v.grabbedSongDataTime[o]&&null!==v.grabbedSongDataTime[o]||(v.grabbedSongDataTime[o]=millis()),i=!0,{id:v.grabbedSongData[o][0],name:v.grabbedSongData[o][1],artist:v.grabbedSongData[o][2],link:v.grabbedSongData[o][3]};v.grabbedSongDataTime[o]=null,B("grabSongData",{a:e,mode:t,replace:o})}if(!1===i)return B("grabSongData",{a:e,mode:t,replace:!1}),{id:"ERROR",name:"ERROR",artist:"ERROR",link:"ERROR",error:!0}}}function Qo(e,t){if("all"===t)B("grabLevelDataAll"),v.grabbedLevelDataAllTime=millis();else{for(var i=!1,o=0;o<v.grabbedLevelData.length;o++)if("id"===t&&v.grabbedLevelData[o].id===e&&void 0!==e){if(void 0===v.grabbedLevelDataTime[o]||null===v.grabbedLevelDataTime[o]||millis()<v.grabbedLevelDataTime[o]+3e3)return void 0!==v.grabbedLevelDataTime[o]&&null!==v.grabbedLevelDataTime[o]||(v.grabbedLevelDataTime[o]=millis()),i=!0,{id:v.grabbedLevelData[o].id,diff:v.grabbedLevelData[o].diff};v.grabbedLevelDataTime[o]=null,B("grabLevelData",{a:e,mode:t,replace:o})}if(!1===i)return"id"===t&&void 0===e||B("grabLevelData",{a:e,mode:t,replace:!1}),{id:"ERROR",diff:0,error:!0}}}function m(e,t,i){var o={id:0,beat:[],bpm:0,ar:0,hw:0,hpD:0,effects:[],sections:[],bg:"Loading...",song:0,songOffset:0,title:"Loading...",desc:"Loading...",author:"Loading...",ranked:!1};return"number"!=typeof e?o:"id"===t?void 0===v.newGrabbedLevels[e]||"Metadata"===v.newGrabbedLevels[e].beat?(!0===v.newGLRequested[e]&&!i||(B("newGrabLevel",{mode:"id",a:e}),v.newGLRequested[e]=!0,v.newGLRequestedT[e]=millis(),v.newGLDownloading[e]=!0),5e3<=millis()-v.newGLRequestedT[e]&&(v.newGLRequested[e]=!1),o):v.newGrabbedLevels[e]:void 0}function H(e,t){var i={id:0,beat:[],bpm:0,ar:0,hw:0,hpD:0,effects:[],sections:[],bg:"Loading...",len:0,bpmDis:120,arDis:2,beatLen:0,song:0,songOffset:0,title:"Loading...",desc:"Loading...",author:"Loading...",ranked:!1,special:!1};return"number"!=typeof e?i:"id"===t?null!==e?void 0===v.newGrabbedLevels[e]?(!0!==v.newGLRequested[e]&&(B("newGrabLevelMeta",{mode:"id",a:e}),v.newGLRequested[e]=!0,v.newGLRequestedT[e]=millis()),5e3<=millis()-v.newGLRequestedT[e]&&(v.newGLRequested[e]=!1),i):v.newGrabbedLevels[e]:i:void 0}function Ut(e,t){var i={uuid:"Loading...",user:"Loading...",pp:"Loading...",joined:"Loading...",country:"Loading...",bio:"Loading...",online:"Loading...",patreon:0},o={uuid:"Loading...",user:Pt("defaultUsername",xt),pp:"Loading...",joined:"Loading...",country:"Loading...",bio:"Loading...",online:"Loading...",patreon:0};return null==e||"object"==typeof e||e.length<=0?o:"uuid"===t?(void 0===v.newGrabbedUsers[e]||void 0===v.newGURequestedT[e])&&(!0!==v.newGURequested[e]&&(B("newGrabUser",{mode:"uuid",a:e}),v.newGURequested[e]=!0,v.newGURequestedT[e]=millis()),3e3<=millis()-v.newGURequestedT[e]&&(v.newGURequested[e]=!1),void 0===v.newGrabbedUsers[e])?i:v.newGrabbedUsers[e]:"user"===t?(void 0===v.newGrabbedUsersUsername[e]||void 0===v.newGUURequestedT[e])&&(!0!==v.newGUURequested[e]&&(B("newGrabUser",{mode:"user",a:e}),v.newGUURequested[e]=!0,v.newGUURequestedT[e]=millis()),1e3<=millis()-v.newGUURequestedT[e]&&(v.newGUURequested[e]=!1),void 0===v.newGrabbedUsersUsername[e])?i:v.newGrabbedUsersUsername[e]:void 0}function Lt(e,t){var i={id:0,name:"Loading...",artist:"Loading...",link:"Loading...",explicit:!1};if("id"===t)return 0===e||void 0===e||isNaN(e)?i:void 0===v.newGrabbedSongs[e]?(!0!==v.newGSRequested[e]&&(B("newGrabSong",{mode:"id",a:e}),v.newGSRequested[e]=!0,v.newGSRequestedT[e]=millis()),1e3<=millis()-v.newGSRequestedT[e]&&(v.newGSRequested[e]=!1),i):v.newGrabbedSongs[e]}function Io(e,t,i,o){if(Bt.lvl.searchSent=!0,1===i)B("searchLevels",{a:e,mode:t,viewSkip:Bt.lvl.viewSkip,sort:o,showUnranked:Bt.lvl.showUnranked});else if(0===i){if("recent"===t){Ht.search=X(Ht.saved);for(var n=0;n<Ht.saved.length;n++)Ht.search[n].index=n}else if("title"===t){Ht.search=[];for(n=0;n<Ht.saved.length;n++)null!==(!0===Ht.saved[n].local?Ht.saved[n]:H(Ht.saved[n],"id")).title.match(new RegExp(e,"i"))&&(Ht.search.push(X(Ht.saved[n])),Ht.search[Ht.search.length-1].index=n)}else if("levelID"===t){Ht.search=[];for(n=0;n<Ht.saved.length;n++)(!0===Ht.saved[n].local?Ht.saved[n].id:Ht.saved[n])===parseInt(e)&&(Ht.search.push(X(Ht.saved[n])),Ht.search[Ht.search.length-1].index=n)}else if("author"===t){Ht.search=[];for(n=0;n<Ht.saved.length;n++)(!0===Ht.saved[n].local?Ut(Ht.saved[n].author,"uuid"):Ut(H(Ht.saved[n],"id").author,"uuid")).user===e&&(Ht.search.push(X(Ht.saved[n])),Ht.search[Ht.search.length-1].index=n)}if(!Bt.lvl.showUnranked)for(n=Ht.search.length-1;0<=n;n--)!0!==Ht.search[n].local&&H(Ht.search[n],"id").ranked||Ht.search.splice(n,1)}}function Ao(e,t,i){if(1===i)B("searchSongs",{a:e,mode:t,viewSkip:Bt.song.viewSkip});else if(0===i)if("recent"===t)O.search=O.saved;else if("title"===t){O.search=[];for(var o=0;o<O.saved.length;o++)null!==Lt(O.saved[o],"id").name.match(new RegExp(e,"i"))&&O.search.push(O.saved[o])}else if("songID"===t){O.search=[];for(o=0;o<O.saved.length;o++)O.saved[o]===parseInt(e)&&O.search.push(O.saved[o])}else if("artist"===t){O.search=[];for(o=0;o<O.saved.length;o++)null!==Lt(O.saved[o],"id").artist.match(new RegExp(e,"i"))&&O.search.push(O.saved[o])}}function Fo(e,t,i){3e3<=millis()-v.searchUsersT&&(v.searchUsersT=millis(),"main"===i?B("searchUsers",{a:e,mode:t,mode2:i,unix:w}):"incFR"===i?B("searchUsers",{a:e,mode:t,mode2:i,to:T.uuid,unix:w}):"friends"===i&&B("searchUsers",{a:e,mode:t,mode2:i,user:T.uuid,unix:w}))}function Do(){Sn.clear(),v.newGrabbedLevels=[],v.newGLRequested=[],Ht.search=[],Bt.lvl.sel=!1}function Xo(e,t,i,o,n,s,r){fill(255,100*s[r]),rect(e,t,i,o),Ft("rcorner",e,t,i,o)?(s[r]+=At(1,s[r],.2),!1!==n&&($t=n)):"online"!==Bt.screen&&"account"!==Bt.screen?s[r]+=At(Ve!==r?0:.5,s[r],.2):s[r]+=At(0,s[r],.2)}function Kt(e,t,i,o,n,s,r,h){void 0===h&&(h={discord:!1}),void 0===s[r]&&(s[r]=0),Ft("rcenter",e+i/2+zt.get().x,t+o/2+zt.get().y,i,o)?s[r]+=At(1,s[r],.2):s[r]+=At(0,s[r],.2),push();var a=width>height?width/64:height/64,l=[!1,!1];if(n===Pt("menu_lvl_mods",xt))for(var d in l[0]=!0,Tt.mods)Tt.mods[d]!==Tt.modsDef[d]&&(l[1]=!0);translate(e+i/2,t+o/2),scale(1+((i+2*(width<width>height?width/64:height/64))/i-1)*s[r]),rectMode(CENTER),h.discord?(imageMode(CENTER),image(St.discordLogo,0,0,i,o)):(push(),translate(cos(30)*(a/2)*lerp(0,1,s[r]),sin(30)*(a/2)*lerp(0,1,s[r])),fill(0,100),rect(0,0,i,o),pop(),l[0]&&l[1]||!0===h.alert?fill($.modText):fill(lerpColor($.buttonDown,$.buttonUp,s[r])),rect(0,0,i,o)),textAlign(CENTER,CENTER),l[0]&&l[1]||!0===h.alert?fill($.buttonUp):fill($.buttonText),noStroke(),Dt(n,0,0,i-2*a,o/1.5),pop()}function Wo(e,t){if("min:sec"===t)return 1===(i=floor(e/1e3)%60).toString().length&&(i="0"+i),floor(e/6e4)+":"+i;if("min:sec:ms"===t){1===(i=floor(e/1e3)%60).toString().length&&(i="0"+i);for(var i,o=floor(e%1e3),n=0;n<2;n++)o.toString().length<3&&(o="0"+o);return floor(e/6e4)+":"+i+":"+o}}function Uo(e,t){if(0!==Bt.lvl.tab)return e;var i=[...e];switch(t){default:return i;case"dateAsc":return i.reverse();case"dateDesc":return i;case"alphanumAsc":for(var o=[],n=0;n<i.length;n++)!0===i[n].local?"lvl"===Bt.screen?o.push([i[n].title.toLowerCase(),n]):"song"===Bt.screen&&o.push([i[n].name.toLowerCase(),n]):"lvl"===Bt.screen?o.push([H(i[n],"id").title.toLowerCase(),n]):"song"===Bt.screen&&o.push([Lt(i[n],"id").name.toLowerCase(),n]);o.sort();for(var s=[],n=0;n<o.length;n++)s[n]=i[o[n][1]];return s;case"alphanumDesc":for(o=[],n=0;n<i.length;n++)!0===i[n].local?"lvl"===Bt.screen?o.push([i[n].title.toLowerCase(),n]):"song"===Bt.screen&&o.push([i[n].name.toLowerCase(),n]):"lvl"===Bt.screen?o.push([H(i[n],"id").title.toLowerCase(),n]):"song"===Bt.screen&&o.push([Lt(i[n],"id").name.toLowerCase(),n]);o.sort();for(s=[],n=0;n<o.length;n++)s[n]=i[o[n][1]];return s.reverse();case"starsAsc":for(o=[],n=0;n<i.length;n++)i[n].local,"lvl"===Bt.screen?o.push([Bn(i[n]),n]):"song"===Bt.screen&&o.push([i[n].name.toLowerCase(),n]);o.sort(function(e,t){return e[0]-t[0]});for(s=[],n=0;n<o.length;n++)s[n]=i[o[n][1]];return s;case"starsDesc":for(o=[],n=0;n<i.length;n++)i[n].local,"lvl"===Bt.screen?o.push([Bn(i[n]),n]):"song"===Bt.screen&&o.push([i[n].name.toLowerCase(),n]);o.sort(function(e,t){return e[0]-t[0]});for(s=[],n=0;n<o.length;n++)s[n]=i[o[n][1]];return s.reverse()}}function Lo(e,t){for(var i=0,o=0;o<e.length;o++)0===e[o][5]?i<e[o][1]&&(i=e[o][1]):1===e[o][5]&&i<e[o][1]+e[o][6]&&(i=e[o][1]+e[o][6]);return i/t*60*1e3}function Ko(e,t){return Pt("menu_lvl_foresight_range",xt,0===e?Pt("start",xt):Pt("milliseconds_short",xt,Math.round(e)),0===t?Pt("end",xt):Pt("milliseconds_short",xt,Math.round(t)))}function Vo(e){var t,i="";if(void 0!==e)return t=0,e.bpm!==Tt.modsDef.bpm&&(i=i+" "+Pt("mods_bpm_short",xt)+" "+Pt("mods_multiplier",xt,Ot(1e4*e.bpm)/1e4),t++),e.foresight!==Tt.modsDef.foresight&&(0<t&&(i+=","),i=i+" "+Pt("mods_foresight_short",xt)+" "+Pt("mods_multiplier",xt,Ot(1e4*e.foresight)/1e4),t++),e.hitWindow!==Tt.modsDef.hitWindow&&void 0!==e.hitWindow&&(0<t&&(i+=","),i=i+" "+Pt("mods_hitWindow_short",xt)+" "+Pt("mods_multiplier",xt,Ot(1e4*e.hitWindow)/1e4),t++),e.noFail!==Tt.modsDef.noFail&&(0<t&&(i+=","),i=i+" "+Pt("mods_noFail_short",xt),t++),e.hidden!==Tt.modsDef.hidden&&(0<t&&(i+=","),i=i+" "+Pt("mods_hidden_short",xt),t++),e.noEffects!==Tt.modsDef.noEffects&&(0<t&&(i+=","),i=i+" "+Pt("mods_noEffects_short",xt),t++),e.auto!==Tt.modsDef.auto&&(0<t&&(i+=","),i=i+" "+Pt("mods_auto_short",xt),t++),e.instantFail!==Tt.modsDef.instantFail&&e.perfect===Tt.modsDef.perfect&&void 0!==e.instantFail&&(0<t&&(i+=","),i=i+" "+Pt("mods_instantFail_short",xt),t++),e.perfect!==Tt.modsDef.perfect&&void 0!==e.perfect&&(0<t&&(i+=","),i=i+" "+Pt("mods_perfect_short",xt),t++),e.mirror!==Tt.modsDef.mirror&&void 0!==e.mirror&&(0<t&&(i+=","),i=i+" "+Pt("mods_mirror_short",xt),t++),e.noPitch!==Tt.modsDef.noPitch&&void 0!==e.noPitch&&(0<t&&(i+=","),i=i+" "+Pt("mods_noPitch_short",xt),t++),e.noRelease!==Tt.modsDef.noRelease&&void 0!==e.noRelease&&(0<t&&(i+=","),i=i+" "+Pt("mods_noRelease_short",xt),t++),e.random!==Tt.modsDef.random&&void 0!==e.random&&(0<t&&(i+=","),i=i+" "+Pt("mods_random_short",xt),t++),e.flashlight!==Tt.modsDef.flashlight&&void 0!==e.flashlight&&(0<t&&(i+=","),i=i+" "+Pt("mods_flashlight_short",xt),t++),(void 0!==e.startPos&&0!==e.startPos||void 0!==e.endPos&&0!==e.endPos)&&(i=i+" "+Ko(e.startPos,e.endPos),t++),0===i.length?Pt("mods_none",xt):i.substr(1,i.length)}function Mo(e){Ht.saved[Ht.saved.length]={};var t=Ht.saved.length-1;Ht.saved[t].local=!0,Ht.saved[t].copy=e,Ht.saved[t].beat=X(m(e,"id").beat),Ht.saved[t].effects=X(m(e,"id").effects),Ht.saved[t].sections=X(m(e,"id").sections),Ht.saved[t].bpm=X(m(e,"id").bpm),Ht.saved[t].ar=X(m(e,"id").ar),Ht.saved[t].hw=X(m(e,"id").hw),Ht.saved[t].hpD=X(m(e,"id").hpD),Ht.saved[t].song=X(m(e,"id").song),Ht.saved[t].bg=X(m(e,"id").bg),Ht.saved[t].songOffset=X(m(e,"id").songOffset),Ht.saved[t].title=X(m(e,"id").title),Ht.saved[t].desc=X(m(e,"id").desc),Ht.saved[t].author=X(m(e,"id").author),Gn({type:"success",message:"menu_lvl_copied"})}function qo(e){return void 0===v.newGrabbedLevels[e]?0:void 0===v.newGrabbedLevels[e].beat||"Metadata"===v.newGrabbedLevels[e].beat?v.newGLDownloading[e]?1:0:2}function Zo(e,t){var i=0;if(null==e)return 0;for(var o=0;o<e.length;o++)i+=150===e[o]?100:e[o];return t?i/e.length/100:(i/e.length).toFixed(3)}function jo(e){var t=0,i=0;if(null==e)return 0;for(var o=0;o<e.length;o++)0!==e[o]?t=t<++i?i:t:i=0;return t}function Go(){this.clickEvents=[],this.highlights=[]}function Yo(e){if("lvl"===e){for(var t=0;t<Ht.saved.length;t++)!0===Ht.saved[t].local&&void 0!==Ht.saved[t].id&&(Ht.saved[t]=Ht.saved[t].id,Ht.onlineScores[Ht.saved[t]]=Ht.scores[t]);Bt.lvl.searchSent||(0===Bt.lvl.search.length?Io(0,"recent",Bt.lvl.tab,Bt.lvl.sortMode):0!==Bt.lvl.search.length&&Io(Bt.lvl.search,Bt.lvl.searchMode,Bt.lvl.tab,Bt.lvl.sortMode)),!0!==Ne&&(Rt=Uo(Ht.search,Bt.lvl.sortMode)),z=Bt.lvl.sel,Ve=Bt.lvl.tab}else"song"===e&&(0===O.search.length&&(0===Bt.song.search.length?Ao(0,"recent",Bt.song.tab):0!==Bt.song.search.length&&Ao(Bt.song.search,Bt.song.searchMode,Bt.song.tab)),Rt=Uo(O.search,Bt.song.sortMode),z=Bt.song.sel,Ve=Bt.song.tab);var i=width>height?width/64:height/64;if(void 0!==Rt[z]){if("lvl"===e){fill(0,25),rect(width/3+i,height/16+i,width/3*2/3*2-2*i,(height-height/16)/3-2*i,i),imageMode(CENTER),Po(width/3+2*i+(((height-height/16)/3-2*i)/2-i)/2,height/16+2*i+(((height-height/16)/3-2*i)/2-i)/2,((height-height/16)/3-2*i)/2-i,((height-height/16)/3-2*i)/2-i,Bn(Rt[z]),H(Rt[z],"id").ranked,H(Rt[z],"id").special),fill($.text),textAlign(LEFT,CENTER),Dt((!0===Rt[z].local?Rt[z]:H(Rt[z],"id")).title,width/3+3*i+(((height-height/16)/3-2*i)/2-i),height/16+2*i+(((height-height/16)/3-2*i)/2-i)/2,width/3*2/3*2-2*i-3*i-(((height-height/16)/3-2*i)/2-i),((height-height/16)/3-2*i)/2-i,"bold");var o=(!0===Rt[z].local?Ut(Rt[z].author,"uuid"):Ut(H(Rt[z],"id").author,"uuid")).user;Dt(Pt("menu_lvl_by",xt,void 0===o?Pt("defaultUsername",xt):o),width/3+2*i,height/16+2*i+((height-height/16)/3-2*i)/2,width/3*2/3*2-2*i-2*i,((height-height/16)/3-2*i)/4-i),Dt(Pt("menu_lvl_song",xt,(!0===Rt[z].local?Lt(Rt[z].song,"id"):Lt(H(Rt[z],"id").song,"id")).artist,(!0===Rt[z].local?Lt(Rt[z].song,"id"):Lt(H(Rt[z],"id").song,"id")).name),width/3+2*i,height/16+1.5*i+((height-height/16)/3-2*i)/2+((height-height/16)/3-2*i)/4,width/3*2/3*2-2*i-2*i,((height-height/16)/3-2*i)/4-i),!0===Lt((!0===Rt[z].local?Rt[z]:H(Rt[z],"id")).song,"id").explicit&&(imageMode(CORNER),Wt(St.explicit,"stretch",width/3+i+(width/3*2/3*2-2*i)-2.25*i,height/16+i+((height-height/16)/3-2*i)-2.25*i,1.5*i,1.5*i),Ft("rcorner",width/3+i+(width/3*2/3*2-2*i)-2.25*i,height/16+i+((height-height/16)/3-2*i)-2.25*i,1.5*i,1.5*i))&&($t=Pt("explicit",xt)),fill(0,25),rect(width/3+i+(width/3*2/3*2-2*i)+i,height/16+i,width/3*2/3-i,(height-height/16)/3-2*i,i);textAlign(LEFT,CENTER);for(t=0;t<8;t++){var o="",n=!1;0===t?o=void 0===(o=!0===Rt[z].local?Rt[z].id:Rt[z])?Pt("menu_lvl_notUploaded",xt)+(void 0!==Rt[z].copy?" "+Pt("menu_lvl_copyID",xt,Rt[z].copy):""):Pt("menu_lvl_ID",xt,o):1===t?(!0===Rt[z].local?o=$i(Pn(Rt[z].beat,Rt[z].bpm)):void 0!==(o=H(Rt[z],"id").bpmDis)&&(o=!0===o[0]?Pt("menu_lvl_foresight_range",xt,$i(o[1]*Tt.mods.bpm),$i(o[2]*Tt.mods.bpm)):$i(o*Tt.mods.bpm)),o=Pt("menu_lvl_bpm",xt,o),1!==Tt.mods.bpm&&(n=!0)):2===t?(!0===Rt[z].local?o=$i(En(Rt[z].effects,Rt[z].ar)):void 0!==(o=H(Rt[z],"id").arDis)&&(o=!0===o[0]?Pt("menu_lvl_foresight_range",xt,$i(o[1]*Tt.mods.foresight),$i(o[2]*Tt.mods.foresight)):$i(o*Tt.mods.foresight)),o=Pt("menu_lvl_foresight",xt,o),1!==Tt.mods.foresight&&(n=!0)):3===t?(o=(!0===Rt[z].local?Rt[z]:H(Rt[z],"id")).hw,w=(!0===Rt[z].local?Rt[z]:H(Rt[z],"id")).ar,o=null==o?w:o,o*=Tt.mods.hitWindow,o=Pt("menu_lvl_hitWindow",xt,$i(o)),1!==Tt.mods.hitWindow&&(n=!0)):4===t?(o=(!0===Rt[z].local?Rt[z]:H(Rt[z],"id")).hpD,o=Pt("menu_lvl_hpD",xt,$i(o))):5===t?(o=Wo((!0===Rt[z].local?Lo(Rt[z].beat,Rt[z].bpm):H(Rt[z],"id").len)*(1/Tt.mods.bpm),"min:sec"),o=Pt("menu_lvl_length",xt,o),1!==Tt.mods.bpm&&(n=!0)):6===t?o=Hn(floor(100*Bn(Rt[z]))/100):7===t&&(o=H(Rt[z],"id").ranked?H(Rt[z],"id").special?Pt("menu_lvl_special",xt):Pt("menu_lvl_ranked",xt):Pt("menu_lvl_unranked",xt)),n?fill($.modText):fill($.text),Dt(o,width/3+i+(width/3*2/3*2-2*i)+2*i,height/16+1.75*i+((height-height/16)/3-4*i)/8*(t+1)-((height-height/16)/3-3*i)/8/4,width/3*2/3-i-2*i,((height-height/16)/3-4*i)/8)}fill($.lightTheme?0:255),ellipse(width/3+i+(width/3*2/3*2-2*i)+i+width/3*2/3-i-1.5*i,height/16+i+(height-height/16)/3-2*i-1.5*i,1.5*i,1.5*i),Bt.lvl.refreshArrowR+=At(0,Bt.lvl.refreshArrowR,.1),!Ft("ccenter",width/3+i+(width/3*2/3*2-2*i)+i+width/3*2/3-i-1.5*i,height/16+i+(height-height/16)/3-2*i-1.5*i,1.5*i,1.5*i)||Bt.lvl.showLeaderboard||Bt.lvl.showMods||($t=Pt("menu_lvl_refresh",xt),-.1<=Bt.lvl.refreshArrowR&&(Bt.lvl.refreshArrowR+=At(-.1,Bt.lvl.refreshArrowR,.2))),push(),translate(width/3+i+(width/3*2/3*2-2*i)+i+width/3*2/3-i-1.5*i,height/16+i+(height-height/16)/3-2*i-1.5*i),rotate(360*Bt.lvl.refreshArrowR),imageMode(CENTER),Wt($.lightTheme?St.refreshInvert:St.refresh,"stretch",0,0,.8*i,.8*i),pop(),fill(0,25),rect(width/3+i,height/16+i+((height-height/16)/3-2*i)+i,width/3*2-2*i,(height-height/16)/3-2*i,i),fill($.main),rect(width/3+i,height/16+i+((height-height/16)/3-2*i)+i+(((height-height/16)/3-2*i)/2-i/2/2),width/3*2-2*i,i/2),fill($.text),textAlign(CENTER,CENTER);o=null==(o=(!0===Rt[z].local?Rt[z]:H(Rt[z],"id")).desc)?"":o,textSize(i/1.25),text(0<o.length?'"'+o+'"':Pt("menu_lvl_noDescription",xt),width/3*2-(width/3*2-2*i)/2,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i+i/2/2)/2/2-((height-height/16)/3-2*i+i/2/2)/2/2-i/2/2,width/3*2-2*i,((height-height/16)/3-2*i+i/2/2)/2);var t=null;if(0<Bt.lvl.leaderboardData.length)for(var s=0;s<Bt.lvl.leaderboardData.length;s++)s<Bt.lvl.leaderboardData.length&&Bt.lvl.leaderboardData[s].user===T.uuid&&(t=s);if(null!==t&&!0!==Rt[z].local&&H(Rt[z],"id").ranked?(push(),translate(0,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i+i/2/2)/2/2-i/4),noStroke(),fill($.text),rectMode(CENTER),textAlign(CENTER,CENTER),Dt(t+1,width/3+2.5*i,height/16+i+(height-height/16)/16*0+(height-height/16)/12/2,2*i,2*i,"bold"),imageMode(CENTER),x(Ut(Bt.lvl.leaderboardData[t].user,"uuid").pp)&&Wt(_t(Ut(Bt.lvl.leaderboardData[t].user,"uuid").pp),"stretch",width/3+5.5*i,height/16+i+(height-height/16)/16*0+(height-height/16)/12/2,2*i,2*i),textAlign(LEFT,CENTER),h=Ut(Bt.lvl.leaderboardData[t].user,"uuid").user,Dt(h=void 0!==Bt.lvl.leaderboardData[t].mods&&null!==Bt.lvl.leaderboardData[t].mods&&Bt.lvl.leaderboardData[t].mods!==Tt.modsDef?h+"\n"+Vo(Bt.lvl.leaderboardData[t].mods):h,width/3+7.5*i+(width/3*2-12*i-i)/4-(width/3*2-12*i-i)/2/2,height/16+i+(height-height/16)/16*0+(height-height/16)/12/2,(width/3*2-i)/2,2*i/2),textAlign(RIGHT,CENTER),Dt(Ot(Bt.lvl.leaderboardData[t].score*wn(Bt.lvl.leaderboardData[t].mods))+"\n"+Pt("performancePoints",xt,floor(100*Bt.lvl.leaderboardData[t].performance)/100),width/3+8.5*i+.75*(width/3*2-12*i-i)+(width/3*2-12*i-i)/2/2,height/16+i+(height-height/16)/16*0+(height-height/16)/12/2,(width/3*2-12*i-i)/2,2*i/2),textAlign(CENTER,CENTER),h=constrain(tn(Bt.lvl.leaderboardData[t].score*wn(Bt.lvl.leaderboardData[t].mods)/rn(Rt[Bt.lvl.sel],"online")),0,Tt.ranks.length-1),fill(on(h)),Dt(Tt.ranks[h].symbol,width/3+10.5*i+(width/3*2-12*i-i),height/16+i+(height-height/16)/16*0+(height-height/16)/12/2,2*i,2*i,"bold"),pop()):!0!==Rt[z].local&&H(Rt[z],"id").ranked?Dt(Pt("menu_lvl_noScore",xt),width/3*2,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i+i/2/2)/2/2+((height-height/16)/3-2*i+i/2/2)/2,width/3*2-5*i-2*i,((height-height/16)/3-2*i+i/2/2)/2/3):Dt(Pt("menu_lvl_noLeaderboard",xt),width/3*2,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i+i/2/2)/2/2+((height-height/16)/3-2*i+i/2/2)/2,width/3*2-5*i-2*i,((height-height/16)/3-2*i+i/2/2)/2/3),!0===Rt[z].local?(Kt(width/3+i,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i,(width/3*2-2*i)/2-i/2,(height-height/16)/3/3*2-i/2,Pt("menu_lvl_play",xt),Bt.lvl.buttonHover,0),Kt(width/3+i+((width/3*2-2*i)/2-i/2)+i,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i,(width/3*2-2*i)/2-i/2,(height-height/16)/3/3*2-i/2,Pt("menu_lvl_edit",xt),Bt.lvl.buttonHover,2),Kt(width/3+i,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2,(width/3*2-4*i)/3,(height-height/16)/3/3-i/2,Pt("menu_lvl_delete",xt),Bt.lvl.buttonHover,1),Kt(width/3+2*i+(width/3*2-4*i)/3,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2,(width/3*2-4*i)/3,(height-height/16)/3/3-i/2,Pt("menu_lvl_mods",xt),Bt.lvl.buttonHover,12),void 0===Rt[z].copy?Kt(width/3+3*i+(width/3*2-4*i)/3*2,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2,(width/3*2-4*i)/3,(height-height/16)/3/3-i/2,Pt("menu_lvl_upload",xt),Bt.lvl.buttonHover,3):void 0!==Rt[z].copy&&Rt[z].author===T.uuid?Kt(width/3+3*i+(width/3*2-4*i)/3*2,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2,(width/3*2-4*i)/3,(height-height/16)/3/3-i/2,Pt("menu_lvl_uploadCopy",xt),Bt.lvl.buttonHover,3):(fill(255),Dt(Pt("menu_lvl_notUploadCopy",xt),width/3+3*i+(width/3*2-4*i)/3*2+(width/3*2-4*i)/3/2,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2+((height-height/16)/3/3-i/2)/2,(width/3*2-4*i)/3,(height-height/16)/3/3-i/2))):(h=qo(Rt[z]),Kt(width/3+i,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i,width/3*2-2*i,(height-height/16)/3/3*2-i/2,Pt(0===h?"menu_download":2===h?"menu_lvl_play":"menu_downloading",xt),Bt.lvl.buttonHover,4),Kt(width/3+i,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2,(width/3*2-4*i)/3,(height-height/16)/3/3-i/2,-1!==Ht.saved.indexOf(Rt[z])?Pt("menu_lvl_unbookmark",xt):Pt("menu_lvl_bookmark",xt),Bt.lvl.buttonHover,5),Kt(width/3+2*i+(width/3*2-4*i)/3,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2,(width/3*2-4*i)/3,(height-height/16)/3/3-i/2,Pt("menu_lvl_mods",xt),Bt.lvl.buttonHover,10),!0===H(Rt[Bt.lvl.sel],"id").ranked?Kt(width/3+3*i+(width/3*2-4*i)/3*2,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2,(width/3*2-4*i)/3,(height-height/16)/3/3-i/2,Pt("menu_lvl_leaderboard",xt),Bt.lvl.buttonHover,8):"Metadata"!==H(Rt[Bt.lvl.sel],"id").beat&&Kt(width/3+3*i+(width/3*2-4*i)/3*2,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2,(width/3*2-4*i)/3,(height-height/16)/3/3-i/2,Pt("edit_select_item_copy",xt),Bt.lvl.buttonHover,8)),!0!==Rt[z].local&&H(Rt[z],"id").special&&Ft("rcorner",width/3+i,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i,width/3*2-2*i,(height-height/16)/3/3*2-i/2)&&!1===Bt.lvl.showLeaderboard&&!1===Bt.lvl.showMods&&($t=Pt("menu_lvl_specialWarning",xt)),Bt.lvl.showLeaderboard?(Bt.lvl.leaderboardX+=At(1,Bt.lvl.leaderboardX,.2),!Rt[Bt.lvl.sel].local&&!0===H(Rt[Bt.lvl.sel],"id").ranked||(Bt.lvl.showLeaderboard=!1)):Bt.lvl.leaderboardX+=At(0,Bt.lvl.leaderboardX,.2),0<Ot(100*Bt.lvl.leaderboardX)/100&&(push(),translate(-(constrain(Bt.lvl.leaderboardX,0,1)*(width/3*2)),0),fill(lerpColor($.shade,$.main,constrain(Bt.lvl.leaderboardX,0,1))),rectMode(CORNER),rect(width,height/16,width/3*2,height),push(),translate(width/3*2,0),Bt.lvl.leaderboardData=pn(Rt[Bt.lvl.sel],"lvl"),Bt.lvl.newLeaderboard.draw(Bt.lvl.leaderboardData,{x:width/3,y:height/16,w:width/3*2,h:height-height/16-height/12,buffer:height/128,scroll:[Bt.lvl,"leaderboardScroll"],self:T.uuid,levelID:Rt[Bt.lvl.sel]}),pop(),h=floor(height/12),translate(width/3*2,height-h),fill(lerpColor($.shade,$.overlayShade,constrain(Bt.lvl.leaderboardX,0,1))),rectMode(CORNER),rect(width/3,0,width,h),h=h-i,translate(width/3,0),"Loading..."!==Bt.lvl.leaderboardData&&Kt(width/3-width/6-i/2,i/2,width/6,h,Pt("refresh",xt),Bt.lvl.buttonHover,14),Kt(width/3+i/2,i/2,width/6,h,Pt("menu_back",xt),Bt.lvl.buttonHover,9),pop()),Bt.lvl.showMods?Bt.lvl.modsX+=At(1,Bt.lvl.modsX,.2):Bt.lvl.modsX+=At(0,Bt.lvl.modsX,.2),0<Ot(100*Bt.lvl.modsX)/100&&(push(),translate(-(constrain(Bt.lvl.modsX,0,1)*(width/3*2)),0),fill(lerpColor($.shade,$.main,constrain(Bt.lvl.modsX,0,1))),rectMode(CORNER),rect(width,height/16,width/3*2,height),push(),Bt.lvl.modsNSM.draw({x:width,y:height/16,width:width/3*2,height:height-((height-height/16)/3/3-i/2+2*i)-height/16,stacked:!1,maxBarHeight:height/24,buffer:(height-height/16)/64,mouseIsPressedBlock:vt.active}),pop(),translate(width/3*2,0),fill(lerpColor($.shade,$.overlayShade,constrain(Bt.lvl.modsX,0,1))),rectMode(CORNER),rect(width/3,height/16+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2,width,(height-height/16)/3/3-i/2+2*i),Kt(width/3+i+((width/3*2-2*i)/2+i/2),height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2+((height-height/16)/3/3-i/2)/4*3-i/2,(width/3*2-2*i)/2-i/2,((height-height/16)/3/3-i/2)/2,Pt("menu_back",xt),Bt.lvl.buttonHover,11),Kt(width/3+i+((width/3*2-2*i)/2+i/2),height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2+((height-height/16)/3/3-i/2)/4*3-i/2-((height-height/16)/3/3-i/2)/2-i/2,(width/3*2-2*i)/2-i/2,((height-height/16)/3/3-i/2)/2,Pt("mods_practice",xt),Bt.lvl.buttonHover,15),fill($.text),textAlign(LEFT,CENTER),Dt(Pt("mods_scoreMultiplier",xt,wn(Tt.mods)),width/3+i,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2+((height-height/16)/3/3-i/2)/4-i/2,(width/3*2-2*i)/2-i/2,((height-height/16)/3/3-i/2)/2),Kt(width/3+i,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2+((height-height/16)/3/3-i/2)/4*3-i/2,(width/3*2-2*i)/2-i/2,((height-height/16)/3/3-i/2)/2,Pt("mods_reset",xt),Bt.lvl.buttonHover,13),pop()),vt.trans+=At(vt.active?1:0,vt.trans,.2),0<Math.round(100*vt.trans)/100){vt.computeSections(),vt.callback=null,push();var r=width/3*2,h=height-height/16,a=width-constrain(vt.trans,0,1)*(width/3*2),l=height/16,d=(translate(a,l),fill(lerpColor($.shade,$.main,constrain(vt.trans,0,1))),rectMode(CORNER),rect(0,0,r,h),r-2*i),g=h/8*7/vt.sections.length;for(let e=0;e<vt.sections.length;e++){push();var c=g*(e+.5);translate(0,c),fill(lerpColor($.main,e%2!=0?$.main:$.shade,.5)),rect(0,-g/2,r,g),pop()}fill($.text),textAlign(LEFT,CENTER);for(let e=0;e<vt.sections.length;e++){const P=vt.sections[e];push();var f=g*(e+.5),u=(translate(0,f),Dt(P.name,i,0,d/2-2*i,Math.min(g,4*i)),d/2/2),v=g/1.5;e!==vt.sections.length-1&&(Kt(d/2+i/2,-v/2,u,v,Pt("practice_startAt",xt),vt.buttonHover,2*e,{alert:Tt.mods.startPos===P.startMS}),Ft("rcorner",d/2+i/2+a,-v/2+l+f,u,v))&&(vt.callback=()=>{vt.buttonHover[2*e]/=4,Tt.mods.startPos=P.startMS,console.log("Start "+P.name)}),0!==e&&(Kt(d/2+i+u,-v/2,u,v,Pt("practice_endBefore",xt),vt.buttonHover,2*e+1,{alert:Tt.mods.endPos===P.startMS}),Ft("rcorner",d/2+i+u+a,-v/2+l+f,u,v))&&(vt.callback=()=>{vt.buttonHover[2*e+1]/=4,Tt.mods.endPos=P.startMS,console.log("End "+P.name)}),pop()}fill(lerpColor($.shade,$.overlayShade,constrain(vt.trans,0,1))),rect(0,h/8*7,r,h/7);var m=r/2-2*i,p=h/8/1.5;Kt(r-m-i,h-h/8+(h/8-p)/2,m,p,Pt("menu_back",xt),vt.buttonHover,-1),Ft("rcorner",r-m-i+a,h-h/8+(h/8-p)/2+l,m,p)&&(vt.callback=()=>vt.active=!1),pop()}!0===Rt[z].local?Ht.localOffsets[Ht.saved.indexOf(Rt[z])]=Tt.mods.offset:Ht.onlineOffsets[Rt[z]]=Tt.mods.offset}else"song"===e&&(fill(0,25),rect(width/3+i,height/16+i,width/3*2-2*i,(height-height/16)/3-2*i,i),!0===Lt(Rt[Bt.song.sel],"id").explicit&&(Wt(St.explicit,"stretch",width/3+i+(width/3*2-2*i)-2.25*i,height/16+i+((height-height/16)/3-2*i)-2.25*i,1.5*i,1.5*i),Ft("rcorner",width/3+i+(width/3*2-2*i)-2.25*i,height/16+i+((height-height/16)/3-2*i)-2.25*i,1.5*i,1.5*i))&&($t=Pt("explicit",xt)),textAlign(CENTER,CENTER),fill($.text),Dt(Pt("menu_lvl_song_list",xt,Lt(Rt[Bt.song.sel],"id").artist,Lt(Rt[Bt.song.sel],"id").name),width/3+i+(width/3*2-2*i)/2,height/16+i+((height-height/16)/3-2*i)/2,width/3*2-2*i-2*i,((height-height/16)/3-2*i)/3),Dt(Pt("menu_lvl_ID",xt,Rt[Bt.song.sel]),width/3+i+(width/3*2-2*i)/2,height/16+i+((height-height/16)/3-2*i)/2+((height-height/16)/3-2*i)/3/2+i,width/3*2-2*i-2*i,((height-height/16)/3-2*i)/3/2),fill(0,25),rect(width/3+i,height/16+i+((height-height/16)/3-2*i)+i,width/3*2-2*i,(height-height/16)/3-2*i,i),Bt.song.songObject=soundManager.getSoundById(Rt[z]),imageMode(CORNER),Bt.song.listening?3===Bt.song.songObject.readyState?image(1===Bt.settings.themeSel?St.stopInvert:St.stop,width/3+i+i,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)/2-i,2*i,2*i):(Bt.song.loadR+=.25,Bt.song.loadR=Bt.song.loadR%360,push(),fill($.text),translate(width/3+i+i,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)/2-i),translate(2*i/2,2*i/2),rotate(Bt.song.loadR),rectMode(CENTER),rect(0,0,2*i,2*i),pop()):image(1===Bt.settings.themeSel?St.playInvert:St.play,width/3+i+i,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)/2-i,2*i,2*i),rectMode(CORNER),fill($.textDown),rect(width/3+i+i+(i+2*i),height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)/2-i/4/2,width/3*2-4*i-(i+2*i),i/4,i/4),void 0!==Bt.song.songObject&&3===Bt.song.songObject.readyState&&(mouseIsPressed&&Ft("rcorner",width/3+i+i+(i+2*i),height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)/2-i/4/2-i/2,width/3*2-4*i-(i+2*i),i)?(soundManager.setPosition(Rt[z],(mouseX-(width/3+i+i+(i+2*i)))/(width/3*2-4*i-(i+2*i))*Bt.song.songObject.duration),soundManager.setVolume(Rt[z],0)):soundManager.setVolume(Rt[z],Bt.settings.musicVolume),(0===Bt.song.songObject.playState||Bt.song.songObject.paused)&&Bt.song.listening&&soundManager.play(Rt[z]),textAlign(LEFT,CENTER),fill($.text),Dt(Wo(Bt.song.songObject.position,"min:sec")+"/"+Wo(Bt.song.songObject.duration,"min:sec"),width/3+i+i+(i+2*i),height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)/2-i/4/2+1.5*i,width/3*2-4*i-(i+2*i),i),mouseIsPressed?(Bt.song.playbackX+=At(Bt.song.songObject.position/Bt.song.songObject.duration,Bt.song.playbackX,.4),Bt.song.playbackR+=At(Bt.song.songObject.position/Bt.song.songObject.duration*742.5,Bt.song.playbackR,.4)):(Bt.song.playbackX+=At(Bt.song.songObject.position/Bt.song.songObject.duration,Bt.song.playbackX,.1/(21e4/Bt.song.songObject.duration)),Bt.song.playbackR+=At(Bt.song.songObject.position/Bt.song.songObject.duration*742.5,Bt.song.playbackR,.1/(21e4/Bt.song.songObject.duration))),Ft("rcenter",width/3+i+i+(i+2*i)+(width/3*2-4*i-(i+2*i))*Bt.song.playbackX,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)/2-i/4/2+i/8,i,i)?mouseIsPressed?Bt.song.playbackS+=At(1.25,Bt.song.playbackS,.2):Bt.song.playbackS+=At(1,Bt.song.playbackS,.2):Bt.song.playbackS+=At(.75,Bt.song.playbackS,.2),push(),translate(width/3+i+i+(i+2*i),height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)/2-i/4/2),translate((width/3*2-4*i-(i+2*i))*Bt.song.playbackX,i/8),rotate(Bt.song.playbackR),scale(Bt.song.playbackS),rectMode(CENTER),fill($.text),rect(0,0,i,i),pop()),Kt(width/3+i,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i,width/3*2-2*i,(height-height/16)/3/3*2-i/2,Pt("menu_song_copyID",xt),Bt.song.buttonHover,4),Kt(width/3+i,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2,width/3*2-2*i,(height-height/16)/3/3-i/2,-1!==O.saved.indexOf(Rt[z])?Pt("menu_lvl_unbookmark",xt):Pt("menu_lvl_bookmark",xt),Bt.song.buttonHover,5));Bt.lvl.deleteConfirm||Bt.lvl.uploadConfirm?Bt.lvl.deleteBanner+=At(1,Bt.lvl.deleteBanner,.2):Bt.lvl.deleteBanner+=At(0,Bt.lvl.deleteBanner,.2),push(),rectMode(CORNER),fill($.overlayShade),rect(-width/3*2+width/3*3*Bt.lvl.deleteBanner,height-(height-height/16)/3-1.5*i,width/3*2,(height-height/16)/3+i),fill($.text),Kt(-width/3*2+i+width/3*3*Bt.lvl.deleteBanner,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2,(width/3*2-2*i)/2-i/2,(height-height/16)/3/3-i/2,Pt(Bt.lvl.uploadConfirm?"menu_lvl_upload_yes":"menu_lvl_delete_yes",xt),Bt.lvl.buttonHover,6),Kt(-width/3*2+i+((width/3*2-2*i)/2-i/2)+i+width/3*3*Bt.lvl.deleteBanner,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i+(height-height/16)/3/3*2+i/2,(width/3*2-2*i)/2-i/2,(height-height/16)/3/3-i/2,Pt("menu_lvl_delete_no",xt),Bt.lvl.buttonHover,7),push(),translate((width/3*2-2*i)/2+width/3*3*Bt.lvl.deleteBanner,((height-height/16)/3/3*2-i/2)/2),fill($.text),Dt(Pt(Bt.lvl.uploadConfirm?void 0===Rt[Bt.lvl.sel].copy?"menu_lvl_upload_confirm":"menu_lvl_uploadUpdate_confirm":"menu_lvl_delete_confirm",xt,Rt[z].title),-width/3*2+i,height/16+i+((height-height/16)/3-2*i)+i+((height-height/16)/3-2*i)+i,width/3*2-2*i,((height-height/16)/3/3*2-i/2)/1.5),pop(),pop()}rectMode(CORNER),fill($.overlayShade),rect(0,height/16,width/3,height);for(t=0;t<Rt.length;t++){var b=height/16+height/24+height/12*t-(Rt.length>(height-(height/16+height/24))/(height/12)?Bt.lvl.scroll/(height-(height/16+height/24)-(height-(height/16+height/24))/12)*(height/12*(Rt.length-(height-(height/16+height/24))/(height/12))):0);b<height&&0<b&&(push(),translate(0,b),z===t?fill($.select):fill(lerpColor(t%2!=0?$.shade:$.overlayShade,color(0,0,0),.15)),rect(0,0,width/3,height/12),"lvl"===e?(imageMode(CENTER),Po((width<height?width:height)/16/2+i/4,height/12/2,(width<height?width:height)/16,(width<height?width:height)/16,Bn(Rt[t]),H(Rt[t],"id").ranked,H(Rt[t],"id").special),push(),translate((width<height?width:height)/16+i/4*2,0),textAlign(LEFT,CENTER),fill($.text),Dt((!0===Rt[t].local?Rt[t]:H(Rt[t],"id")).title,0,height/12/4,width/3-width/48-((width<height?width:height)/16+i/4*4),height/12/2/1.5,"bold"),o=(!0===Rt[t].local?Ut(Rt[t].author,"uuid"):Ut(H(Rt[t],"id").author,"uuid")).user,Dt(Pt("menu_lvl_by",xt,void 0===o?Pt("defaultUsername",xt):o),0,height/12/2+height/12/16,width/3-width/48-((width<height?width:height)/16+i/4*4),height/12/4/1.5),Dt(Pt("menu_lvl_song_list",xt,(!0===Rt[t].local?Lt(Rt[t].song,"id"):Lt(H(Rt[t],"id").song,"id")).artist,(!0===Rt[t].local?Lt(Rt[t].song,"id"):Lt(H(Rt[t],"id").song,"id")).name),0,height/12/2+height/12/4,width/3-width/48-((width<height?width:height)/16+i/4*4),height/12/4/1.5),pop(),void 0===Lt((!0===Rt[t].local?Rt[t]:H(Rt[t],"id")).song,"id").name&&(Rt[t].song=1203),!0===Lt((!0===Rt[t].local?Rt[t]:H(Rt[t],"id")).song,"id").explicit&&(imageMode(CENTER),Wt(St.explicit,"stretch",i/2+(width/3-width/48-i-1.25*i),height/12/2,Ot(1.5*i),Ot(1.5*i)),Ft("rcenter",i/2+(width/3-width/48-i-1.25*i),height/12/2+b,Ot(1.5*i),Ot(1.5*i)))&&($t=Pt("explicit",xt))):"song"===e&&(fill($.text),textAlign(LEFT,CENTER),Dt(Pt("menu_lvl_song_list",xt,Lt(Rt[t],"id").artist,Lt(Rt[t],"id").name),i/2,height/12/2,width/3-width/48-i-(!0===Lt(Rt[t],"id").explicit?3*i:0),height/12-i),imageMode(CENTER),!0===Lt(Rt[t],"id").explicit)&&(Wt(St.explicit,"stretch",i/2+(width/3-width/48-i-1.25*i),height/12/2,Ot(1.5*i),Ot(1.5*i)),Ft("rcenter",i/2+(width/3-width/48-i-1.25*i),height/12/2+b,Ot(1.5*i),Ot(1.5*i)))&&($t=Pt("explicit",xt)),pop())}fill(30),rect(width/3-width/48,height/16,width/48,height),fill($.scrollbar),rect(width/3-width/48,height/16+height/24+Bt.lvl.scroll,width/48,(height-(height/16+height/24))/12),mouseIsPressed&&(Ft("rcorner",width/3-width/48,height/16+height/24+Bt.lvl.scroll,width/48,(height-(height/16+height/24))/12)?(Bt.lvl.scroll+=mouseY-pmouseY,Bt.lvl.scrollNewLock=!0):Ft("rcorner",width/3-width/48,height/16+height/24,width/48,height)&&(Bt.lvl.scroll+=At(mouseY-(height/16+height/24+(height-(height/16+height/24))/12/2),Bt.lvl.scroll,.5),Bt.lvl.scrollNewLock=!0)),0!==Mt()&&(Bt.lvl.showLeaderboard&&mouseX<width/3||!Bt.lvl.showLeaderboard?Rt.length>(height-(height/16+height/24))/(height/12)?Bt.lvl.scroll+=height/12/2/(height/12*(Rt.length-(height-(height/16+height/24))/(height/12)))*(height-(height/16+height/24)-(height-(height/16+height/24))/12)*(Mt()/100):Bt.lvl.scroll+=height/12/2*(Mt()/100):Bt.lvl.leaderboardScroll+=Mt()/100),Vt*=.25,Bt.lvl.scroll=constrain(Bt.lvl.scroll,0,height-(height/16+height/24+(height-(height/16+height/24))/12)),fill(30),rect(0,height/16,width/3-width/48,height/24),push(),imageMode(CENTER),translate(height/24/2,height/24/2),fill(255),Wt(St.bookmark,"contain",0,height/16,height/24/1.5,height/24/1.5),fill(255),Wt(St.online,"contain",height/24,height/16,height/24/1.5,height/24/1.5),"lvl"===e?(fill(255),Wt(St.ranked,"contain",height/24*2,height/16,height/24/1.5,height/24/1.5),fill(255),Wt(St.sort,"contain",height/24*3,height/16,height/24/1.5,height/24/1.5),fill(255),Wt(St.searchFor,"contain",height/24*4,height/16,height/24/1.5,height/24/1.5)):"song"===e&&(fill(255),image(St.sort,height/24*2,height/16,height/24/1.5,height/24/1.5),fill(255),Wt(St.searchFor,"contain",height/24*3,height/16,height/24/1.5,height/24/1.5)),pop(),fill(255),imageMode(CENTER),Wt("song"===e?St.upload:St.edit,"contain",width/3-width/48/2,height/16+height/24/2,(width/48<height/24?width/48:height/24)/1.5,(width/48<height/24?width/48:height/24)/1.5);var w,C,y="",h=("lvl"===Bt.screen?Bt.lvl:Bt.song).sortMode,E=("lvl"===Bt.screen?Bt.lvl:Bt.song).tab;switch(h){default:y="dateDesc";break;case"dateAsc":y=0===E?"localAsc":"dateAsc";break;case"dateDesc":y=0===E?"localDesc":"dateDesc";break;case"alphanumAsc":y="alphanumAsc";break;case"alphanumDesc":y="alphanumDesc";break;case"starsAsc":y="starsAsc";break;case"starsDesc":y="starsDesc"}"lvl"===e?(!1===Bt.side&&(Xo(0,height/16,height/24,height/24,Pt("menu_lvl_tab_local",xt),Bt.lvl.tabHighlight,0),Xo(height/24,height/16,height/24,height/24,Pt("menu_lvl_tab_online",xt),Bt.lvl.tabHighlight,1),Xo(height/24*2,height/16,height/24,height/24,Bt.lvl.showUnranked?Pt("menu_lvl_showUnranked",xt):Pt("menu_lvl_hideUnranked",xt),Bt.lvl.tabHighlight,7),Xo(height/24*3,height/16,height/24,height/24,Pt("menu_lvl_sort",xt,Pt("menu_lvl_sort_"+y,xt)),Bt.lvl.tabHighlight,4),Xo(height/24*4,height/16,height/24,height/24,Pt("menu_lvl_searchFor",xt,Pt("menu_lvl_search_"+Bt.lvl.searchMode,xt)),Bt.lvl.tabHighlight,2)),Xo(width/3-width/48,height/16,width/48,height/24,Pt("menu_lvl_new",xt),Bt.lvl.tabHighlight,3)):(!1===Bt.side&&(Xo(0,height/16,height/24,height/24,Pt("menu_lvl_tab_bookmarks",xt),Bt.song.tabHighlight,0),Xo(height/24,height/16,height/24,height/24,Pt("menu_song_tab_online",xt),Bt.song.tabHighlight,1),Xo(height/24*2,height/16,height/24,height/24,Pt("menu_lvl_sort",xt,Pt("menu_lvl_sort_"+y,xt)),Bt.song.tabHighlight,4),Xo(height/24*3,height/16,height/24,height/24,Pt("menu_lvl_searchFor",xt,Pt("menu_lvl_search_"+Bt.song.searchMode,xt)),Bt.song.tabHighlight,2)),Xo(width/3-width/48,height/16,width/48,height/24,""!==T.uuid?Pt("menu_lvl_newSong",xt):Pt("menu_newSong_noAccount",xt),Bt.song.tabHighlight,3)),fill(10),rect(height/24*("lvl"===e?5:4),height/16,width/3-width/48-height/24*("lvl"===e?5:4),height/24),textAlign(LEFT,CENTER),"lvl"===e?(o=0===Bt.lvl.search.length?Pt("menu_lvl_search",xt):Bt.lvl.search,w=0===Bt.lvl.search.length&&"italics",C=0===Bt.lvl.search.length?127.5:255):"song"===e&&(o=0===Bt.song.search.length?Pt("menu_lvl_search",xt):Bt.song.search,w=0===Bt.song.search.length&&"italics",C=0===Bt.song.search.length?127.5:255),fill(255,C),Dt(o,height/24*("lvl"===e?5:4)+height/24/2/2,height/16+height/24/2,width/3-width/48-height/24*("lvl"===e?5:4)-height/24/2,height/24/2,w),"song"===e&&Bt.song.overlayOn&&($t=!1)}function Jo(e){for(var t=0;t<e.length;t++)for(var i=0;i<e[t].items.length;i++)e[t].items[i].highlight=0;this.pages=e,this.clickEvents=[],this.data={page:0,pagesX:0,underlineW:0,breakClickEvents:!1,highlighted:!1,dropdownHitbox:!1}}Go.prototype.draw=function(e,t){var i=Ot(t.w/60*1.5),o=i/1.5,n=i-2*(t.buffer/(width/t.w)),s=t.w/60;if(this.clickEvents=[],"Loading..."===e)push(),translate(t.x,t.y),fill($.text),textAlign(CENTER,CENTER),Dt(Pt("loading",xt),t.w/2,t.h/2,t.w-2*s,n);else if("no scores"===e)push(),translate(t.x,t.y),fill($.text),textAlign(CENTER,CENTER),Dt(Pt("menu_lvl_noLeaderboardScores",xt),t.w/2,t.h/2,t.w-2*s,n);else{var r=e.length-(t.h-o)/i;ee(t.scroll,r<=0?0:constrain(te(t.scroll),0,r)),noStroke(),push(),translate(t.x,t.y),push(),translate(0,o),textAlign(LEFT,CENTER),translate(0,-te(t.scroll)*i);for(var h=0;h<e.length;h++){void 0===this.highlights[h]&&(this.highlights[h]=0);var a,l,d=e[h];i*h-te(t.scroll)*i+i<0||i*h-te(t.scroll)*i>t.h-o||(push(),translate(0,i*h),rectMode(CORNER),l=lerpColor(h%2!=0?$.shade:$.overlayShade,color(0,0,0),.15),a=d.user===t.self?color(100,0,0):-1!==po(t.self).indexOf(d.user)?color(100,0,100):l,l=lerpColor(l,a,.25),fill(l),rect(0,0,t.w,i),Ft("rcorner",zt.get().x,zt.get().y,t.w,i)?(this.highlights[h]+=At(1,this.highlights[h],.2),2===qo(t.levelID)&&this.clickEvents.push({hitbox:Ft("rcorner",zt.get().x,zt.get().y,t.w,i),event:function(e){zo(e[0],"leaderboardData")},item:[h]})):this.highlights[h]+=At(0,this.highlights[h],.2),push(),translate(0,i/2),push(),translate(s,0),rectMode(CENTER),fill(255,25),push(),h<=2&&(0===h?fill(201,176,55):1===h?fill(180,180,180):2===h&&fill(173,138,86),rotate(22.5),rect(0,0,i-s/1.1,i-s/1.1)),pop(),fill($.text),textSize(n),textAlign(CENTER,CENTER),stroke(l),strokeWeight(s/4),text(h+1,0,0),noStroke(),translate(s+n/2,0),imageMode(CENTER),image(_t(Ut(d.user,"uuid").pp),0,0,n,n),translate(s,0),textAlign(LEFT,CENTER),Dt(Ut(d.user,"uuid").user,0,0,9*s,n),textSize(n),translate(10*s,0),textAlign(LEFT,CENTER),text(Ot(Gi(d.log)*wn(d.mods)),0,0),translate(8*s,0),textAlign(LEFT,CENTER),text(Pt("accuracyFormat",xt,Zo(d.log)),0,0),translate(6*s,0),textAlign(LEFT,CENTER),text(Pt("comboFormat",xt,jo(d.log)),0,0),translate(6*s,0),void 0!==d.performance&&(textAlign(LEFT,CENTER),text(Pt("performancePoints",xt,d.performance.toFixed(2)),0,0)),translate(6*s,0),textAlign(LEFT,CENTER),Dt(Vo(d.mods),0,0,16*s,n),translate(17*s,0),a=tn(d.score*wn(d.mods)/rn(Rt[Bt.lvl.sel],"online")),fill(on(a)),textAlign(CENTER,CENTER),textStyle(BOLD),textSize(n),text(Tt.ranks[a].symbol,0,0),pop(),pop(),push(),l=21*s+n/2,translate(t.w-l*this.highlights[h],0),rect(0,0,l,i),fill($.text),textAlign(LEFT,CENTER),Dt(2===qo(t.levelID)?Pt("menu_lvl_watchReplay",xt):Pt("menu_lvl_watchReplayError",xt),s,i/2,l-2*s-4*s,n),imageMode(CORNER),image(2===qo(t.levelID)?$.lightTheme?St.replayInvert:St.replay:$.lightTheme?St.warningInvert:St.warning,17*s+n/4,0,i,i),pop(),pop())}pop(),push(),fill(40),rect(0,0,t.w,floor(o)),textSize(n/1.25),textAlign(LEFT,CENTER),push(),translate(0,o/2),fill(255),translate(s,0),textAlign(CENTER,CENTER),text(Pt("menu_lvl_leaderboard_position",xt),0,0),translate(s,0),textAlign(LEFT,CENTER),text(Pt("defaultUsername",xt),0,0),translate(s+n/2,0),translate(10*s,0),text(Pt("score",xt),0,0),translate(8*s,0),text(Pt("accuracy",xt),0,0),translate(6*s,0),text(Pt("maxCombo",xt),0,0),translate(6*s,0),text(Pt("pulse",xt),0,0),translate(6*s,0),text(Pt("menu_lvl_mods",xt),0,0),translate(17*s,0),textAlign(CENTER,CENTER),text(Pt("rank",xt),0,0),pop(),pop(),push(),translate(59*s,o);var g=constrain((t.h-o)/e.length*(e.length-r),0,t.h-o-s);translate(0,s/2+(t.h-o-g-s)*(te(t.scroll)/r)),fill($.scrollbar),rectMode(CORNER),rect(0,0,s/2,g,s),pop()}pop()},Go.prototype.click=function(){for(var e=0;e<this.clickEvents.length;e++)this.clickEvents[e].hitbox&&this.clickEvents[e].event(this.clickEvents[e].item)},Jo.prototype.draw=function(e){var t,i,o,n=this.pages,s=this.data,r=!(this.clickEvents=[]),h=e.height/16,A=e.height/16,F="",a=e.maxBarHeight/(e.stacked?2:1),l=e.buffer,d=cos(30)*a/6,g=sin(30)*a/6,D=mouseIsPressed&&!0!==e.mouseIsPressedBlock;if(s.page=constrain(s.page,0,n.length-1),o=e.stacked?(i=e.width,e.width):(i=e.width/3,e.width-i),noStroke(),rectMode(CORNER),textStyle(NORMAL),push(),translate(e.x,e.y),!0!==e.hideHeaders){push(),translate(e.width/n.length/2,h/2),fill($.text),textAlign(CENTER,CENTER),textSize(h/2),rectMode(CENTER),s.pagesX+=At(s.page,s.pagesX,.2),s.underlineW+=At(textWidth(Pt(n[s.page].title,xt)),s.underlineW,.2);for(var c=0;c<n.length;c++){var X=n[c];push(),translate(e.width/n.length*c,0),text(Pt(X.title,xt),0,0),this.clickEvents.push({hitbox:Ft("rcenter",zt.get().x,zt.get().y,e.width/n.length,h),item:[this,c],event:function(e){e[0].data.page=e[1]}}),pop()}rect(e.width/n.length*s.pagesX,h/3,s.underlineW,h/16),pop()}push(),translate(0,h+A),!0!==e.hideHighlights&&!1!==s.highlighted&&(fill($.lightTheme?0:255,35),rect(0,a*s.highlighted*(e.stacked?2:1),e.width,a*(e.stacked?2:1))),hoverCheck=!1;for(c=0;c<n.length;c++){X=n[c];if(e.width===width||s.page===c){push(),translate(e.width*(c-s.pagesX),0);for(var f=0;f<X.items.length;f++){push(),translate(0,a*f*(e.stacked?2:1));void 0!==(H=X.items[f]).update&&H.update(H);var W,u=a*(e.stacked?H.noName?0:.75:1),u=(Ft("rcorner",zt.get().x,zt.get().y,e.width,a*(e.stacked?2:1))&&(F=H.hint,!1===s.highlighted&&(s.highlighted=f),s.highlighted+=At(f,s.highlighted,.35),hoverCheck=!0),!0!==H.noName&&"button"!==H.type&&(textAlign(e.stacked?CENTER:LEFT,CENTER),textSize(u/2),fill($.text),Dt(Pt(H.name,xt),e.stacked?i/2:2*l,u/2,i-4*l,u/(e.stacked?1:1.5))),push(),translate(e.stacked?0:i,e.stacked?a*(e.stacked?H.noName?0:.75:1):0),a*(e.stacked?H.noName?2:1.25:1));if("string"===H.type)void 0===H.highlights&&(H.highlights=[0]),Ft("rcorner",zt.get().x+2*l,zt.get().y+1.5*l/2,o-4*l,u-1.5*l)?H.highlights[0]+=At(1,H.highlights[0],.2):H.highlights[0]+=At(0,H.highlights[0],.2),push(),translate(o/2,u/2),scale(1+.025*H.highlights[0]),rectMode(CENTER),0<H.highlights[0].toFixed(3)&&(push(),translate(d*lerp(0,1,H.highlights[0]),g*lerp(0,1,H.highlights[0])),fill(0,100),rect(0,0,o-4*l,u-1.5*l,u-1.5*l),pop()),fill(lerpColor($.buttonDown,$.buttonUp,H.highlights[0])),rect(0,0,o-4*l,u-1.5*l,u-1.5*l),textAlign(CENTER,CENTER),fill($.buttonText),Dt(te(H.var),0,0,o-2*l,(u-1.5*l)/1.5),pop(),this.clickEvents.push({hitbox:Ft("rcorner",zt.get().x+2*l,zt.get().y+1.5*l/2,o-4*l,u-1.5*l),item:H,event:function(e){e.highlights[0]/=5,Ri({var:e.var,title:e.name,type:"string",allowEmpty:!0,after:e.after})}});else if("number"===H.type){for(var U=H.multiple?H.vars.length:1,L=0;L<U;L++){var v=H.multiple?H.vars[L]:H.var;!isNaN(te(v))&&null!==te(v)&&void 0!==te(v)||ee(v,0),te(v)<H.min&&!1!==H.min?ee(v,H.min):te(v)>H.max&&!1!==H.max&&ee(v,H.max)}void 0===H.highlights&&(H.highlights=[0,0,0,0,0]);var m=(o-8*l)/3,p=(push(),translate(o/2,u/2),scale(1+.05*H.highlights[4]),rectMode(CENTER),0<H.highlights[4].toFixed(3)&&(push(),translate(d*lerp(0,1,H.highlights[4]),g*lerp(0,1,H.highlights[4])),fill(0,100),rect(0,0,m,u-1.5*l,u-1.5*l),pop()),fill(lerpColor($.buttonDown,$.buttonUp,H.highlights[4])),rect(0,0,m,u-1.5*l,u-1.5*l),textAlign(CENTER,CENTER),fill($.buttonText),Dt(H.multiple?Pt("item_mixedValues",xt):void 0===H.display?te(H.var):H.display(),0,0,m-2*l,(u-1.5*l)/1.5),pop(),!0!==H.multiple&&(Ft("rcorner",zt.get().x+4*l+m,zt.get().y+1.5*l/2,m,u-1.5*l)?H.highlights[4]+=At(1,H.highlights[4],.2):H.highlights[4]+=At(0,H.highlights[4],.2),this.clickEvents.push({hitbox:Ft("rcorner",zt.get().x+4*l+m,zt.get().y+1.5*l/2,m,u-1.5*l),item:H,event:function(e){e.highlights[4]/=5,Ri({var:e.var,title:e.name,type:"number",after:e.after,convert:void 0===e.convert?void 0:e.convert,display:void 0===e.display?void 0:e.display()})}})),u-1.5*l),b=(m+2*l-2*p)/3,w=(push(),translate(2*l,u/2-p/2),rectMode(CORNER),push(),translate(b,p/2),Ft("rcorner",zt.get().x-p/2,zt.get().y-p/2,1.5*p,p)),w=(H.bigChange2=Array.isArray(H.bigChange)?te(H.bigChange):H.bigChange,H.smallChange2=Array.isArray(H.smallChange)?te(H.smallChange):H.smallChange,H.highlights[0]+=At(w?1:0,H.highlights[0],.2),this.clickEvents.push({hitbox:w,item:H,event:function(e){if(e.highlights[0]/=5,e.multiple)for(var t=0;t<e.vars.length;t++)ee(e.vars[t],te(e.vars[t])-e.bigChange2);else ee(e.var,te(e.var)-e.bigChange2)}}),scale(1+.2*H.highlights[0]),0<H.highlights[0].toFixed(3)&&(push(),translate(d*lerp(0,1,H.highlights[0]),g*lerp(0,1,H.highlights[0])),fill(0,100),triangle(0,0,p,p/2,p,-p/2),triangle(-p/2,0,p-p/2,p/2,p-p/2,-p/2),pop()),fill(lerpColor($.buttonDown,$.buttonUp,H.highlights[0])),triangle(0,0,p,p/2,p,-p/2),triangle(-p/2,0,p-p/2,p/2,p-p/2,-p/2),pop(),push(),translate(2*b+p+p/2,p/2),Ft("rcorner",zt.get().x-p/2,zt.get().y-p/2,p,p)),w=(H.highlights[1]+=At(w?1:0,H.highlights[1],.2),this.clickEvents.push({hitbox:w,item:H,event:function(e){if(e.highlights[1]/=5,e.multiple)for(var t=0;t<e.vars.length;t++)ee(e.vars[t],te(e.vars[t])-e.smallChange2);else ee(e.var,te(e.var)-e.smallChange2)}}),scale(1+.2*H.highlights[1]),0<H.highlights[1].toFixed(3)&&(push(),translate(d*lerp(0,1,H.highlights[1]),g*lerp(0,1,H.highlights[1])),fill(0,100),triangle(-p/2,0,p/2,p/2,p/2,-p/2),pop()),fill(lerpColor($.buttonDown,$.buttonUp,H.highlights[1])),triangle(-p/2,0,p/2,p/2,p/2,-p/2),pop(),translate(2*m+2*l,0),push(),translate(b+p/2,p/2),Ft("rcorner",zt.get().x-p/2,zt.get().y-p/2,p,p)),w=(H.highlights[2]+=At(w?1:0,H.highlights[2],.2),this.clickEvents.push({hitbox:w,item:H,event:function(e){if(e.highlights[2]/=5,e.multiple)for(var t=0;t<e.vars.length;t++)ee(e.vars[t],te(e.vars[t])+e.smallChange2);else ee(e.var,te(e.var)+e.smallChange2)}}),scale(1+.2*H.highlights[2]),0<H.highlights[2].toFixed(3)&&(push(),translate(d*lerp(0,1,H.highlights[2]),g*lerp(0,1,H.highlights[2])),fill(0,100),triangle(p/2,0,-p/2,p/2,-p/2,-p/2),pop()),fill(lerpColor($.buttonDown,$.buttonUp,H.highlights[2])),triangle(p/2,0,-p/2,p/2,-p/2,-p/2),pop(),push(),translate(2*b+p+p/2,p/2),Ft("rcorner",zt.get().x-p/2,zt.get().y-p/2,1.5*p,p));H.highlights[3]+=At(w?1:0,H.highlights[3],.2),this.clickEvents.push({hitbox:w,item:H,event:function(e){if(e.highlights[3]/=5,e.multiple)for(var t=0;t<e.vars.length;t++)ee(e.vars[t],te(e.vars[t])+e.bigChange2);else ee(e.var,te(e.var)+e.bigChange2)}}),scale(1+.2*H.highlights[3]),0<H.highlights[3].toFixed(3)&&(push(),translate(d*lerp(0,1,H.highlights[3]),g*lerp(0,1,H.highlights[3])),fill(0,100),triangle(p/2,0,-p/2,p/2,-p/2,-p/2),triangle(p,0,0,p/2,0,-p/2),pop()),fill(lerpColor($.buttonDown,$.buttonUp,H.highlights[3])),triangle(p/2,0,-p/2,p/2,-p/2,-p/2),triangle(p,0,0,p/2,0,-p/2),pop(),pop()}else if("slider"===H.type){var C=void 0===H.display?te(H.var):H.display(),w=(void 0===H.animation&&(H.animation={x:0,knob:0}),o-4*l),y=u/3,E=(void 0===H.barTexture?(fill(200),rect((o-w)/2,u/2-u/16,w,u/8,u/8)):(imageMode(CORNER),image(H.barTexture,(o-w)/2,u/2-u/16,w,u/8)),push(),translate(lerp((o-w)/2,o-(o-w)/2,H.animation.x),u/2),rectMode(CENTER),D&&Ft("rcenter",o/2+zt.get(-1).x,u/2+zt.get(-1).y,o,u/1.5)&&!s.dropdownHitbox?(Q=constrain((mouseX-zt.get(-1).x-(o-w)/2)/w,0,1),H.animation.x+=At(Q,H.animation.x,.7),Q=H.flip?1-Q:Q,E=(H.max-H.min)*Q+H.min,E=constrain(Ot(E/H.step)*H.step,H.min,H.max),ee(H.var,$i(E))):(Q=(te(H.var)-H.min)/(H.max-H.min),Q=H.flip?1-Q:Q,H.animation.x+=At(Q,H.animation.x,.2)),Ft("rcenter",zt.get().x,zt.get().y,1.5*y,1.5*y)?H.animation.knob+=At(D?1:.5,H.animation.knob,.2):H.animation.knob+=At(0,H.animation.knob,.2),push(),translate(d/lerp(2,1,H.animation.knob),g/lerp(2,1,H.animation.knob)),rotate(lerp(0,742.5,H.animation.x)),fill(0,100),rect(0,0,lerp(y,1.5*y,H.animation.knob),lerp(y,1.5*y,H.animation.knob)),pop(),rotate(lerp(0,742.5,H.animation.x)),fill(lerpColor($.buttonDown,$.buttonUp,H.animation.knob)),rect(0,0,lerp(y,1.5*y,H.animation.knob),lerp(y,1.5*y,H.animation.knob)),rotate(lerp(0,-742.5,H.animation.x)),lerp(y/1.5,1.5*y/1.5,H.animation.knob));textSize(E),rect(0,0,1.25*textWidth(C),E,E),fill($.buttonText),textAlign(CENTER,CENTER),text(C,0,0),pop()}else if("color"===H.type){void 0===H.highlights&&(H.highlights=[0]),push(),translate(2*l,2.5*l/2);var y=(o-6*l)/3,P=u-2.5*l,P=(colorMode(H.mode),H.multiple?fill(te(H.hues[0]),te(H.saturations[0]),te(H.brightnesses[0]),void 0===H.alphas?255:te(H.alphas[0])):fill(te(H.hue),te(H.saturation),te(H.brightness),void 0===H.alpha?255:te(H.alpha)),stroke(255),strokeWeight(l),rect(0,0,y,P,P),H.multiple&&(fill($.text),textAlign(CENTER,CENTER),noStroke(),Dt(Pt("item_mixedValues",xt),y/2,P/2,y-2*l,P/1.5)),pop(),push(),(o-6*l)/3*2),O=u-1.5*l;translate(P/2,O/2),translate((o-6*l)/3+4*l,1.5*l/2),Ft("rcenter",zt.get().x,zt.get().y,P,O)?H.highlights[0]+=At(1,H.highlights[0],.2):H.highlights[0]+=At(0,H.highlights[0],.2),scale(1+.025*H.highlights[0]),rectMode(CENTER),noStroke(),0<H.highlights[0].toFixed(3)&&(push(),translate(d*lerp(0,1,H.highlights[0]),g*lerp(0,1,H.highlights[0])),fill(0,100),rect(0,0,P,O),pop()),noStroke(),fill(lerpColor($.buttonDown,$.buttonUp,H.highlights[0])),rect(0,0,P,O),fill($.buttonText),Dt(Pt("settings_editColor",xt),0,0,P-2*l,O/1.5),this.clickEvents.push({hitbox:Ft("rcenter",zt.get().x,zt.get().y,P,O),item:H,event:function(e){e.highlights[0]/=5,Ni({hue:e.hue,saturation:e.saturation,brightness:e.brightness,alpha:e.alpha,loops:e.loops,smooth:e.smooth,mode:HSB,title:e.name,multiple:e.multiple,hues:e.hues,saturations:e.saturations,brightnesses:e.brightnesses,alphas:e.alphas})}}),pop()}else if("boolean"===H.type){const J=H.multiple?H.vars:[H.var];let i=te(J[0]);const _=e=>{for(const t of J)ee(t,e);i=e};if("boolean"!=typeof i&&_(!1),H.animation??=i?1:0,H.highlights??=[0],H.animation+=At(i?1:0,H.animation,.2),push(),translate(o/2,u/2),scale(1+.2*H.highlights[0]),push(),rectMode(CENTER),Ft("rcenter",zt.get().x,zt.get().y,o,u/1.5)?H.highlights[0]+=At(1,H.highlights[0],.2):H.highlights[0]+=At(0,H.highlights[0],.2),0<H.highlights[0].toFixed(3)){push(),translate(d*lerp(0,1,H.highlights[0]),g*lerp(0,1,H.highlights[0])),rotate(22.5*H.animation),stroke(0,100);const p=u/2;var z=lerp(p/8,p/2,H.animation);strokeWeight(z),noFill(),rect(0,0,p-z,p-z),pop()}push(),rotate(22.5*H.animation),stroke(lerpColor($.buttonDown,$.buttonUp,H.highlights[0]));const p=u/2;var z=lerp(p/8,p/2,H.animation),K=(strokeWeight(z),noFill(),rect(0,0,p-z,p-z),pop(),this.clickEvents.push({hitbox:Ft("rcenter",zt.get().x,zt.get().y,o,u/1.5),item:H,event:function(e){e.highlights[0]/=5,_(!i)}}),pop(),push(),u/10);translate(-u/16,u/4*1.25),push(),rotate(-135),scale(1.3);for(var V=0;V<2;V++)0===V?(noFill(),stroke(lerpColor($.buttonDown,$.buttonUp,H.highlights[0])),strokeWeight(lerp(0,K,constrain(H.animation,0,.1)/.1))):(fill($.checkmark),noStroke()),0<Ot(100*H.animation)/100&&rect(0,u/2,K,lerp(0,-u/2,constrain(H.animation,0,.5)/.5),K),.5<Ot(100*H.animation)/100&&rect(0,0,lerp(0,u/3.5,(constrain(H.animation,.5,1)-.5)/.5),K,K);pop(),pop(),pop()}else if("button"===H.type){void 0===H.highlights&&(H.highlights=[0]),rectMode(CENTER),push();var P=((e.stacked?0:i)+o-4*l)/(e.stacked?1:2),O=(e.stacked?2*a-u:0)+u/1.5;translate(e.stacked?0:(o+i-4*l)/4,0),translate(P/2,O/2),translate(-(e.stacked?0:i)+2*l,(u-O)/2),translate(0,e.stacked?.875*-(2*a-O):0),Ft("rcenter",zt.get().x,zt.get().y,P,O)?H.highlights[0]+=At(1,H.highlights[0],.2):H.highlights[0]+=At(0,H.highlights[0],.2),scale(1+.025*H.highlights[0]),0<H.highlights[0].toFixed(3)&&(push(),translate(d*lerp(0,1,H.highlights[0]),g*lerp(0,1,H.highlights[0])),fill(0,100),rect(0,0,P,O),pop()),fill(lerpColor($.buttonDown,$.buttonUp,H.highlights[0])),rect(0,0,P,O),textAlign(CENTER,CENTER),fill($.buttonText),Dt(Pt(H.name,xt,...H.keys??[]),0,0,P/1.5,O/1.5),this.clickEvents.push({hitbox:Ft("rcenter",zt.get().x,zt.get().y,P,O),item:H,event:function(e){e.highlights[0]/=5,e.event(e)}}),pop()}else if("dropdown"===H.type){push(),translate(2*l,1.5*l/2);var x=o-4*l,S=u-1.5*l;void 0===H.animation&&(H.animation={height:0,cursor:0}),void 0===H.highlights&&(H.highlights=[0]),Ft("rcorner",zt.get().x,zt.get().y,x,S)&&!H.open?H.highlights[0]+=At(1,H.highlights[0],.2):H.highlights[0]+=At(0,H.highlights[0],.2),H.open||(push(),translate(x/2,S/2),scale(1+.025*H.highlights[0]),rectMode(CENTER),0<H.highlights[0].toFixed(3)&&(push(),translate(d*lerp(0,1,H.highlights[0]),g*lerp(0,1,H.highlights[0])),fill(0,100),rect(0,0,x,S),pop()),fill(lerpColor($.buttonDown,$.buttonUp,H.highlights[0])),rect(0,0,x,S),N=H.labels[H.options.indexOf(te(H.var))],j=Array.isArray(N)?N[0]:Pt(N,xt),textAlign(CENTER,CENTER),fill($.buttonText),Dt(j,0,0,x-2*l,S/1.5),push(),I=(u-1.5*l)/4,translate(x/2-(S-I)/1.5-I/2,0),rotate(180),stroke($.buttonText),strokeWeight(I/4),line(-I,I/2/1.5,0,-I/4*3/1.5),line(I,I/2/1.5,0,-I/4*3/1.5),pop(),pop()),this.clickEvents.push({hitbox:Ft("rcorner",zt.get().x,zt.get().y,x,S),item:H,event:function(e){e.highlights[0]/=5,e.open=!e.open}}),H.open?r={page:c,item:f,matrix:zt.get(5)}:H.animation.height=0,pop()}else if("tiles"===H.type){var M=[],M=2!==(!1===Bt.settings.overlayText?Bt.settings.keyboard:Bt.settings.overlayText)?Tt.keyDisplay[Bt.settings.language]:Tt.keyDisplayNum,B=o-4*l,p=u-2*l,b=((m=B/1.75)-9*p)/8,q=te(H.var);void 0===H.highlights&&(H.highlights=[0,0,0,0,0,0,0,0,0]),push(),translate((B-m)/2,0),translate(2*l,l),rectMode(CENTER),translate(p/2,p/2);for(var T=0;T<9;T++)push(),translate((b+p)*T,0),Ft("rcenter",zt.get().x,zt.get().y,p,p)?H.highlights[T]+=At(1,H.highlights[T],.2):H.highlights[T]+=At(0,H.highlights[T],.2),push(),scale(1+.2*H.highlights[T]),0<H.highlights[T].toFixed(3)&&(push(),translate(d*lerp(0,1,H.highlights[T]),g*lerp(0,1,H.highlights[T])),fill(0,100),rect(0,0,p,p),pop()),fill(-1!==q.indexOf(T)?255:200),rect(0,0,p,p),fill(-1!==q.indexOf(T)?$.buttonText:lerpColor($.buttonText,color(127.5,127.5,127.5),.25)),textAlign(CENTER,CENTER),Dt(M[T],0,0,p/1.5,p/1.5),pop(),this.clickEvents.push({hitbox:Ft("rcenter",zt.get().x,zt.get().y,p,p),item:[H,T],event:function(e){var t=e[1],i=((e=e[0]).highlights[t]/=5,te(e.var));-1===i.indexOf(t)?i.push(t):i.splice(i.indexOf(t),1),ee(e.var,i)}}),pop();pop()}else"info"===H.type?(fill($.text),textAlign(CENTER,CENTER),Dt(void 0===H.display?te(H.var):H.display(),o/2,u/2,o-2*l,u-1.5*l)):"file"===H.type&&(void 0===H.highlights&&(H.highlights=[0,0]),B=o-5*l-(O=u-1.5*l),rectMode(CENTER),push(),translate(2*l,u/2),push(),translate(B+l+O/2,0),scale(1+.2*H.highlights[1]),Ft("rcenter",zt.get().x,zt.get().y,O,O)?H.highlights[1]+=At(1,H.highlights[1],.2):H.highlights[1]+=At(0,H.highlights[1],.2),0<H.highlights[1].toFixed(3)&&(push(),translate(d*lerp(0,1,H.highlights[1]),g*lerp(0,1,H.highlights[1])),fill(0,100),rect(0,0,O,O),pop()),fill(lerpColor($.buttonDown,$.buttonUp,H.highlights[1])),rect(0,0,O,O),push(),scale(.5),stroke($.buttonText),strokeWeight(O/8),line(-O/2,-O/2,O/2,O/2),line(-O/2,O/2,O/2,-O/2),pop(),this.clickEvents.push({hitbox:Ft("rcenter",zt.get().x,zt.get().y,O,O),item:H,event:function(e){e.highlights[1]/=5,e.reset(),Gn({type:"success",message:"file_reset"})}}),pop(),push(),translate(B/2,0),scale(1+.05*H.highlights[0]),Ft("rcenter",zt.get().x,zt.get().y,B,O)?H.highlights[0]+=At(1,H.highlights[0],.2):H.highlights[0]+=At(0,H.highlights[0],.2),0<H.highlights[0].toFixed(3)&&(push(),translate(d*lerp(0,1,H.highlights[0]),g*lerp(0,1,H.highlights[0])),fill(0,100),rect(0,0,B,O),pop()),fill(lerpColor($.buttonDown,$.buttonUp,H.highlights[0])),rect(0,0,B,O),W=se(H.fileType),C=Pt("inputFile",xt,W,ie(H.sizeLimit)),0<te(H.var).length&&(C=Pt("uploadedFile",xt,W,ne(te(H.var)),ie(oe(te(H.var))??0),ie(H.sizeLimit))),textAlign(CENTER,CENTER),fill($.buttonText),Dt(C,0,0,o-6*l,O/1.5),this.clickEvents.push({hitbox:Ft("rcenter",zt.get().x,zt.get().y,B,O),item:H,event:function(e){e.highlights[0]/=5,re.type=e.fileType,re.sizeLimit=e.sizeLimit,re.success=e.success,settingsFileInput.elt.click()}}),pop(),pop());pop(),pop()}pop()}}if(hoverCheck||(s.highlighted=!1),pop(),push(),!1!==r){var H,R=3*l,k=5/(H=this.pages[r.page].items[r.item]).options.length;void 0===H.scroll&&(H.scroll=0),H.animation.height+=At(1,H.animation.height,.1),t=H.options.length<5?H.options.length:5,Ot(100*H.animation.height)/100==1&&(H.animation.height=1),push(),translate(r.matrix.x,r.matrix.y),textAlign(CENTER,CENTER),push(),translate(0,floor(S)),push(),translate(d*lerp(0,1,H.animation.height),g*lerp(0,1,H.animation.height)),fill(0,100),rect(0,-S,x,S*t*H.animation.height+S,0,0,l,l),pop(),fill(lerpColor($.buttonUp,$.dropdown,H.animation.height)),rect(0,0,x,S*t*H.animation.height,0,0,l,l),s.dropdownHitbox=Ft("rcorner",zt.get().x,zt.get().y,x,S*t),this.clickEvents.unshift({hitbox:s.dropdownHitbox,item:this,event:function(e){e.data.breakClickEvents=!0}}),this.clickEvents.unshift({hitbox:!s.dropdownHitbox,item:H,event:function(e){e.open=!1}}),t<H.options.length&&(push(),k=S*t*H.animation.height*k,translate(x-R,0),D&&Ft("rcorner",zt.get().x,zt.get().y,R,height)&&(H.scroll+=(mouseY-pmouseY)/(S*t-2*l-k)),0!==Mt()&&s.dropdownHitbox&&(H.scroll+=1/H.options.length*(Mt()/100),Vt*=.25,xe=!0),H.scroll=constrain(H.scroll,0,1),push(),translate(0,lerp(l,S*t*H.animation.height-k-l,H.scroll)),fill($.textDown),rect(R/3,0,R/3,k,k),pop(),pop());for(c=0;c<H.options.length;c++){var Z=H.options[c],N=H.labels[c],j=Array.isArray(N)?N[0]:Pt(N,xt),G=(fill(0),(H.options.length-t)*H.scroll),Y=G+t*H.animation.height-1,Q=c<G?1-(G-c):Y-1<c?(1-(c+.5-Y))/.5:1;fill($.buttonText,lerp(0,255,Q)),push(),translate(x/2,S*c+S/2),translate(0,-S*(H.options.length-t)*H.scroll),Dt(j,0,0,x-2*l,S/1.5),Ft("rcorner",zt.get().x,zt.get().y,x,S)&&(H.animation.cursor+=At(c,H.animation.cursor,.2)),this.clickEvents.unshift({hitbox:Ft("rcenter",zt.get().x-R/2,zt.get().y,x-R,S)&&s.dropdownHitbox,item:[H,Z],event:function(e){ee(e[0].var,e[1]),e[0].open=!1}}),pop()}pop(),push(),translate(x/2,ceil(S)/2),scale(1+.025*H.highlights[0]),fill($.buttonUp),rectMode(CENTER),rect(0,0,x,ceil(S));var N=H.labels[H.options.indexOf(te(H.var))],j=Array.isArray(N)?N[0]:Pt(N,xt),I=(fill($.buttonText),Dt(j,0,0,x-2*l,S/1.5),push(),(u-1.5*l)/4);translate(x/2-(S-I)/1.5-I/2,0),rotate(180-180*H.animation.height),stroke($.buttonText),strokeWeight(I/4),line(-I,I/2/1.5,0,-I/4*3/1.5),line(I,I/2/1.5,0,-I/4*3/1.5),pop(),pop(),this.clickEvents.unshift({hitbox:Ft("rcorner",zt.get().x,zt.get().y,x,ceil(S)),item:[this,H],event:function(e){e[1].open=!1,e[0].data.breakClickEvents=!0}}),pop()}else s.dropdownHitbox=!1;pop(),void 0!==F&&0<F.length&&!0!==e.hideHints&&(push(),translate(e.width/2,h+A/2),fill(255),textSize(A/2),textAlign(CENTER,CENTER),textStyle(ITALIC),rectMode(CENTER),Dt(Pt(F,xt),0,0,e.width-4*l,A/2),pop()),pop()};const _o={callback:()=>{},message:"",keys:[],active:!(Jo.prototype.click=function(){var e=this.clickEvents;this.data.breakClickEvents=!1;for(var t=0;t<e.length;t++){var i=e[t],o=i.item;if(i.hitbox&&i.event(o),this.data.breakClickEvents)break}this.clickEvents=[]}),buttons:[0,0],trans:0,rotateTrans:0,desc:!1,spiral:!1,render(){var e,t,i,o;0===this.trans&&!this.active||(e=this.trans,this.trans+=At(this.active?1:0,this.trans,.2),this.desc=this.trans<e,this.spiral?this.rotateTrans-=1/16*rt:this.rotateTrans=this.trans,push(),resetMatrix(),translate(width/2,height/2),rotate(lerp(22.5*(this.desc?-1:1)*(this.spiral?32:1),0,this.rotateTrans)),scale(this.trans),e=width/2,t=height/2,i=kt,noStroke(),rectMode(CENTER),fill($.main,250),rect(0,0,e,t,4*i),textAlign(CENTER,CENTER),fill($.text),Dt(Pt(this.message,xt,...this.keys),0,-t/4,e-8*i,t/2/1.5),Dt(Pt("edit_delete_warning",xt),0,-t/8,e-4*i,t/8/1.5,BOLD),Kt(-e/2+e/3-(i=e/4)/2,(o=t/4)-o/2,i,o,Pt("menu_lvl_delete_yes",xt),this.buttons,0),Kt(-e/2+e/3*2-i/2,t/4-o/2,e/4,o,Pt("menu_lvl_delete_no",xt),this.buttons,1),pop())},activate(e,t,i){this.message=e,this.keys=t,this.callback=i,this.active=!0,this.spiral=!1}};var $o=0;function en(){var e=Tt.timelineBPM/Tt.bpm;!1===Tt.playing?(Tt.playing=!0,Tt.timeStart=millis(),Tt.playingOffset=Tt.time,Tt.time,Tt.bpm,Tt.songOffset,Tt.queueEditorMusic=!0,Tt.editorHSStart=!1,Tt.metronomeLast=!1):(Tt.time=Ot((Tt.time-Tt.bpm/60/1e3*Tt.timelineOffset)*e/Tt.snap)*Tt.snap/e+Tt.bpm/60/1e3*Tt.timelineOffset,Tt.playing=!1,Qt[Tt.song].stop())}function tn(e){e=Ot(1e5*e)/1e5;for(var t=0;t<Tt.ranks.length;t++)if(e>=Tt.ranks[t].score)return t;return Tt.ranks.length-1}function on(e){var t,i,o;return void 0===Tt.ranks[e]?color(0):!0!==Tt.ranks[e].shiny?Tt.ranks[e].color:(i=red(Tt.ranks[e].color),o=green(Tt.ranks[e].color),e=blue(Tt.ranks[e].color),t=(Math.sin(millis()/300)+1)/2,i=lerp(i,i+45,t),o=lerp(o,o+45,t),e=lerp(e,e+45,t),color(i,o,e))}function nn(e){return(e=Math.round(1e5*e)/1e5)<=1?Math.round(1/26.6*(Math.pow(26.6,e)-1)/(1-1/26.6)*1e5)/1e5:Math.round(1e5*(1+Math.pow(e-1,1.5)))/1e5}function sn(e,t){return Rt=[],Rt=Uo(Ht.search,Bt.lvl.sortMode),"online"!==t?!0===Rt[e].local?Rt[e].beat.length*Rt[e].beat.length*100*.5:void 0!==H(Rt[e],"id").beatLen?H(Rt[e],"id").beatLen*H(Rt[e],"id").beatLen*100*.5:void 0:H(e,"id").beatLen*H(e,"id").beatLen*100*.5}function rn(e,t){var i=0;return Rt=[],Rt=Uo(Ht.search,Bt.lvl.sortMode),"online"!==t?!0===Rt[e].local?i=100*Rt[e].beat.length:void 0!==H(Rt[e],"id").beatLen&&(i=100*H(Rt[e],"id").beatLen):i=100*H(e,"id").beatLen,10*i}function hn(){0===Bt.account.user.length&&(Bt.account.blankErrors[0]=!0),0===Bt.account.email.length&&(Bt.account.blankErrors[1]=!0),0===Bt.account.pass.length&&(Bt.account.blankErrors[2]=!0),0===Bt.account.passConf.length&&(Bt.account.blankErrors[3]=!0),0===Bt.account.errors.length&&-1===Bt.account.blankErrors.indexOf(!0)&&(n="reg",r=Bt.account.email,a=Bt.account.user,h=Bt.account.pass,grecaptcha.execute())}function an(){0===Bt.account.email.length&&(Bt.account.blankErrors[1]=!0),0===Bt.account.pass.length&&(Bt.account.blankErrors[2]=!0),0===Bt.account.errors.length&&-1===Bt.account.blankErrors.indexOf(!0)&&1e3<millis()-v.newLoginT&&(n="login",v.newLoginT=millis(),r=Bt.account.email,h=Bt.account.pass,grecaptcha.execute())}function ln(){Bt.account.errors=[],(Bt.account.user.length<3||20<Bt.account.user.length)&&0<Bt.account.user.length?Bt.account.errors.push("usernameLength"):null===Bt.account.user.match(/^[a-zA-Z0-9-_]{3,20}$/g)&&0<Bt.account.user.length&&Bt.account.errors.push("usernameCharacters"),null===Bt.account.email.toLowerCase().match(/[\w'+-]+(\.[\w'+-]+)*@\w+([-.]\w+)*\.\w{2,24}/g)&&0<Bt.account.email.length&&Bt.account.errors.push("invalidEmail"),Bt.account.passConf===Bt.account.pass||"signup"!==Bt.account.mode&&"resetPasswordConf"!==Bt.account.mode||Bt.account.errors.push("passwordConfFail")}function dn(){Bt.song.errors=[],0<Bt.newSong.link.length&&!Bt.newSong.link.startsWith("data:audio/mpeg;base64,")&&Bt.song.errors.push("invalidFile")}function gn(){Bt.song.blankErrors=[],0===Bt.newSong.title.length&&(Bt.song.blankErrors[0]=!0),0===Bt.newSong.artist.length&&(Bt.song.blankErrors[1]=!0),0===Bt.newSong.link.length&&(Bt.song.blankErrors[2]=!0),0===Bt.song.errors.length&&-1===Bt.song.blankErrors.indexOf(!0)&&(lo(Bt.newSong.link),Bt.song.mode="verify")}function cn(){T.uuid="",T.session="",window.localStorage.setItem("session",""),Bt.account.overlayOn=!1}function fn(){0===Bt.account.user.length&&(Bt.account.blankErrors[0]=!0),0===Bt.account.email.length&&(Bt.account.blankErrors[1]=!0),0===Bt.account.errors.length&&-1===Bt.account.blankErrors.indexOf(!0)&&B("requestPasswordCode",{user:Bt.account.user,email:Bt.account.email})}function un(){0===Bt.account.code.length&&(Bt.account.blankErrors[4]=!0),0===Bt.account.errors.length&&-1===Bt.account.blankErrors.indexOf(!0)&&B("checkPasswordCode",{code:Bt.account.code})}function vn(){0===Bt.account.pass.length&&(Bt.account.blankErrors[2]=!0),0===Bt.account.passConf.length&&(Bt.account.blankErrors[3]=!0),0===Bt.account.errors.length&&-1===Bt.account.blankErrors.indexOf(!0)&&B("resetPassword",{code:Bt.account.code,pass:Bt.account.pass})}const mn=new Set;function pn(e,t){var i=[e,t].toString(),o=[];if("user"===t?o=v.grabbedScoresUser[e]:"lvl"===t&&(o=v.grabbedScoresLevel[e]),void 0!==o||mn.has(i)){if(void 0!==o)return o}else B("grabScores",{a:e,mode:t}),v.grabbedScoresTime=millis(),mn.add(i);return"Loading..."}function bn(e){"set"!==Tt.time&&Tt.newScore.release.push([e,Tt.time]),Tt.tilePressRelease[e]=!0,Tt.keysPressed[e]=!1,Rn(e)}function wn(e,t){var i,o;return void 0===e?1:(o=1,o=(o*=.625*e.bpm+.375)*(-2/15*e.foresight+(1- -2/15)),e.hitWindow&&(o*=(i=e.hitWindow)<=1?Math.pow(2-i,log(15/13)/log(1.5)):Math.pow(i,log(.5)/log(2))),o=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o*=e.noFail?.5:1)*(e.hidden?1.05:1))*(e.noEffects,1))*(e.auto&&!t?0:1))*(void 0===e.startPos||0===e.startPos||t?1:0))*(void 0===e.endPos||0===e.endPos||t?1:0))*(e.instantFail,1))*(e.perfect,1))*(e.mirror,1))*(e.noRelease?.75:1))*(e.noPitch,1))*(e.random?0:1))*(e.flashlight,1),Ot(1e4*o)/1e4)}function Cn(){return color(201,176,55)}function yn(){Bt.lvl.prevPlay=Tt.song,Ht.search=[],Bt.lvl.searchSent=!1,Vi("menu","game")}function En(e,t){for(var i=[!1,!1],o=(null!=e&&0!==e.length||(e=[]),[]),n=0;n<e.length;n++)o[n]={type:e[n].type,targetValue:e[n].targetValue+t};o.push({type:6,targetValue:t});for(n=0;n<o.length;n++)6===o[n].type&&((o[n].targetValue<i[0]||!1===i[0])&&(i[0]=o[n].targetValue),o[n].targetValue>i[1]||!1===i[1])&&(i[1]=o[n].targetValue);return i[0]*=Tt.mods.foresight,i[1]*=Tt.mods.foresight,i[0]=Ot(1e4*i[0])/1e4,i[1]=Ot(1e4*i[1])/1e4,i[0]===i[1]?i[0]:Pt("menu_lvl_foresight_range",xt,i[0],i[1])}function Pn(e,t){for(var i=[!1,!1],o=0;o<e.length;o++){var n=0;((n=void 0===e[o][9]?t:e[o][9])<i[0]||!1===i[0])&&(i[0]=n),(i[1]<n||!1===i[1])&&(i[1]=n)}return i[0]*=Tt.mods.bpm,i[1]*=Tt.mods.bpm,i[0]=Ot(1e4*i[0])/1e4,i[1]=Ot(1e4*i[1])/1e4,i[0]===i[1]?i[0]:Pt("menu_lvl_foresight_range",xt,i[0],i[1])}function On(){if(0===Tt.editorMode){Tt.beatClipboard=[];for(var e=0;e<Tt.selectedBeats.length;e++){Tt.beatClipboard[e]=[];for(var t=0;t<Tt.beat[Tt.selectedBeats[e]].length;t++)Tt.beatClipboard[e][t]=Tt.beat[Tt.selectedBeats[e]][t]}}else if(1===Tt.editorMode){Tt.effectClipboard=[];for(e=0;e<Tt.effectMultiSel.length;e++)for(var i in Tt.effectClipboard[e]=[],Tt.effects[Tt.effectMultiSel[e]])Tt.effectClipboard[e]=X(Tt.effects[Tt.effectMultiSel[e]])}}function zn(){if(0===Tt.editorMode){for(var e=!1,t=0;t<Tt.beatClipboard.length;t++)(Tt.beatClipboard[t][1]<e||!1===e)&&(e=Tt.beatClipboard[t][1]);Tt.selectedBeats=[];for(t=0;t<Tt.beatClipboard.length;t++){Tt.beat[Tt.beat.length]=[];for(var i=0;i<Tt.beatClipboard[t].length;i++)Tt.beat[Tt.beat.length-1][i]=Tt.beatClipboard[t][i];Tt.beat[Tt.beat.length-1][1]+=Tt.time-e,Tt.selectedBeats.push(Tt.beat.length-1)}}else if(1===Tt.editorMode){for(e=!1,t=0;t<Tt.effectClipboard.length;t++)(Tt.effectClipboard[t].time<e||!1===e)&&(e=Tt.effectClipboard[t].time);Tt.effectMultiSel=[];for(t=0;t<Tt.effectClipboard.length;t++){for(var o in Tt.effects[Tt.effects.length]=[],Tt.effectClipboard[t])Tt.effects[Tt.effects.length-1]=X(Tt.effectClipboard[t]);Tt.effects[Tt.effects.length-1].time+=Tt.time-e,Tt.effectMultiSel.push(Tt.effects.length-1)}}}function xn(e){var t;1===Tt.disMode&&("set"!==Tt.time&&Tt.newScore.press.push([e,Tt.time]),Tt.tilePress[e]=1,Tt.lastHitTile=e,!(Tt.tilePressRelease[e]=!1)!==Tt.keysPressed[e])&&(Tt.keysPressed[e]=!0,t=Tt.replay.on?Tt.replay.press[Tt.replay.pressI][1]:Tt.time,void 0!==Tt.next[e])&&abs(Tt.beat[Tt.next[e]][1]-Tt.time)/Tt.hw<=Tt.hitValues[Tt.hitValues.length-1].timing&&(0===Tt.beat[Tt.next[e]][5]?(Tt.beat[Tt.next[e]][2]=!0,Tt.beat[Tt.next[e]][3]=1-abs(Tt.beat[Tt.next[e]][1]-t)/Tt.hw,Tt.beat[Tt.next[e]][4]=Tt.beat[Tt.next[e]][1]-t<0,Zi(Tt.next[e]),lowLag.play("hitsound",Bt.settings.hitsoundVolume/100)):1===Tt.beat[Tt.next[e]][5]&&(Tt.keysHeld[e]||(Tt.keysHeld[e]=!0,Tt.beat[Tt.next[e]][7]=t,lowLag.play("hitsound",Bt.settings.hitsoundVolume/100)),void 0!==Tt.beat[Tt.next[e]][12]&&null!==Tt.beat[Tt.next[e]][12]||(Tt.beat[Tt.next[e]][12]=t)))}const Sn=new Set;function Bn(e){if(!0===e.local){if(void 0!==e.stars||!0===Ht.savedDiffReq[e.index])return e.stars;B("calcLevelStarsLocal",{id:e.index,beat:e.beat,bpm:e.bpm,ar:e.ar,hw:e.hw}),Ht.savedDiffReq[e.index]=!0}else if(void 0!==v.newGrabbedLevels[e]){if(void 0!==v.newGrabbedLevels[e].stars)return v.newGrabbedLevels[e].stars;Sn.has(e)||(B("calcLevelStarsOnline",{id:e}),Sn.add(e))}}function Tn(e){if(void 0!==v.newGrabbedUsers[e]){if(void 0!==v.newGrabbedUsers[e].performance||!(1e3<=millis()-v.grabPerfTime[e]||void 0===v.grabPerfTime[e]))return v.newGrabbedUsers[e].performance;v.grabPerfTime[e]=millis(),B("calcUserPerf",{user:e})}}function Hn(e){var t;return e=String(e),"ru"===xt?(t=-1!==e.split(t="").indexOf(".")?"звезды":1===e.substr(e.length-1,1)?"звезда":2===e.substr(e.length-1,1)||3===e.substr(e.length-1,1)||4===e.substr(e.length-1,1)?"звезды":"звёзд","Сложность: "+e+" "+t):Pt("menu_lvl_difficulty",xt,e)}function Rn(e){var t,i;1===Tt.disMode&&!0===Tt.keysHeld[e]&&void 0!==Tt.next[e]&&(t=Tt.replay.on?Tt.replay.release[Tt.replay.releaseI][1]:Tt.time,Tt.keysHeld[e]=!1,1===Tt.beat[Tt.next[e]][5])&&(Tt.replay.on&&(Tt.beat[Tt.next[e]][8]=t-Tt.beat[Tt.next[e]][12]),Tt.beat[Tt.next[e]][2]=!0,t=Tt.beat[Tt.next[e]][12],t=abs(t-Tt.beat[Tt.next[e]][1])/Tt.ar,i=abs(Tt.beat[Tt.next[e]][8]-Tt.beat[Tt.next[e]][6])/(2*Tt.ar),Tt.beat[Tt.next[e]][3]=1-(3*i+t)/4,lowLag.play("holdRelease",Bt.settings.hitsoundVolume/100),Zi(Tt.next[e]))}function kn(e){"objType"===e?0===Tt.objType?Tt.objType=1:Tt.objType=0:"editMode"===e?0===Tt.editorMode?Tt.editorMode=1:Tt.editorMode=0:"holdLength"===e?Ri({var:[Tt,"holdLength"],title:"edit_tool_object_holdLength",type:"number"}):"clickMode"===e?"scroll"===Tt.timelineMode?Tt.timelineMode="select":"select"===Tt.timelineMode&&(Tt.timelineMode="scroll"):"timelineSnap"===e&&(.25===Tt.snap?(Tt.snap=1/8,Tt.timeScroll+=.5):Tt.snap===1/8?(Tt.snap=1/16,Tt.timeScroll+=.25):Tt.snap===1/16?(Tt.snap=1/3,Tt.timeScroll-=.25):Tt.snap===1/3?Tt.snap=1/6:Tt.snap===1/6?Tt.snap=1/12:Tt.snap===1/12&&(Tt.snap=.25))}function Nn(){So(Wo(Tt.time/Tt.bpm*60*1e3,"min:sec:ms")),Gn({type:"success",message:"edit_copiedTimestamp",keys:[]})}function Qn(){localStorage.setItem("pulsusGammaNewLvl",JSON.stringify(Ht.saved)),localStorage.setItem("pulsusGammaLvlScores",JSON.stringify(Ht.scores)),localStorage.setItem("pulsusGammaLvlOnlineScores",JSON.stringify(Ht.onlineScores)),localStorage.setItem("pulsusGammaSongBookmarks",JSON.stringify(O.saved)),localStorage.setItem("pulsusGammaLocalOffsets",JSON.stringify(Ht.localOffsets)),localStorage.setItem("pulsusGammaOnlineOffsets",JSON.stringify(Ht.onlineOffsets)),localStorage.setItem("sessionWarning",Pt("sessionWarning",xt));var e={musicVolume:Bt.settings.musicVolume,keyboard:Bt.settings.keyboard,language:Bt.settings.language,bgDim:Bt.settings.bgDim,hitsoundVolume:Bt.settings.hitsoundVolume,tilePush:Bt.settings.tilePush,boardOverlay:Bt.settings.boardOverlay,themeSel:Bt.settings.themeSel,debugOverlay:Bt.settings.debugOverlay,beatTransparency:Bt.settings.beatTransparency,noteEdgeOpacity:Bt.settings.noteEdgeOpacity,holdProgressOpacity:Bt.settings.holdProgressOpacity,notePaneOpacity:Bt.settings.notePaneOpacity,holdAngle:Bt.settings.holdAngle,holdDirection:Bt.settings.holdDirection,missShake:Bt.settings.missShake,hitParticles:Bt.settings.hitParticles,hitParticlesThickness:Bt.settings.hitParticlesThickness,hitParticlesOpacity:Bt.settings.hitParticlesOpacity,hitParticlesSpread:Bt.settings.hitParticlesSpread,hitParticlesDuration:Bt.settings.hitParticlesDuration,fpsLimit:Bt.settings.fpsLimit,disableEase:Bt.settings.disableEase,menuMusic:Bt.settings.menuMusic,defaultBackground:Bt.settings.defaultBackground,offset:Bt.settings.offset,overlayText:Bt.settings.overlayText,disableMarvelouses:Bt.settings.disableMarvelouses,disableGreats:Bt.settings.disableGreats,disableGoods:Bt.settings.disableGoods,disableOks:Bt.settings.disableOks,disableMisses:Bt.settings.disableMisses,beatThickness:Bt.settings.beatThickness,headerWidth:Bt.settings.headerWidth,additionalGUI:Bt.settings.additionalGUI,holdThickness:Bt.settings.holdThickness,holdProgressThickness:Bt.settings.holdProgressThickness,showAccuracy:Bt.settings.showAccuracy,showUR:Bt.settings.showUR,showHP:Bt.settings.showHP,showJudgements:Bt.settings.showJudgements,showProgress:Bt.settings.showProgress,showScore:Bt.settings.showScore,showCombo:Bt.settings.showCombo,showSections:Bt.settings.showSections,menuMusicVolume:Bt.settings.menuMusicVolume,comboBreakVolume:Bt.settings.comboBreakVolume};localStorage.setItem("pulsusGammaSettings",JSON.stringify(e))}function In(e,t){if(!0!==t.disabled)if("cache"===e)switch(t.type){case 0:Tt.effectsCache.boardX+=t.moveX,Tt.effectsCache.boardY+=t.moveY;break;case 1:Tt.effectsCache.boardW+=t.scaleX-1,Tt.effectsCache.boardH+=t.scaleY-1;break;case 2:Tt.effectsCache.boardR+=t.moveD;break;case 3:if(void 0!==t.tileID)for(var i=0;i<t.tileID.length;i++){var o=t.tileID[i];Tt.effectsCache.tileX[o]+=t.moveX,Tt.effectsCache.tileY[o]+=t.moveY}break;case 4:if(void 0!==t.tileID)for(i=0;i<t.tileID.length;i++){o=t.tileID[i];Tt.effectsCache.tileW[o]+=t.scaleX-1,Tt.effectsCache.tileH[o]+=t.scaleY-1}break;case 5:if(void 0!==t.tileID)for(i=0;i<t.tileID.length;i++){o=t.tileID[i];Tt.effectsCache.tileR[o]+=t.moveD}break;case 6:Tt.effectsCache.ar+=t.targetValue;break;case 7:Tt.effectsCache.boardA+=t.targetValue/255;break;case 8:if(void 0!==t.tileID)for(i=0;i<t.tileID.length;i++){o=t.tileID[i];Tt.effectsCache.tileA[o]+=t.targetValue/255}break;case 9:break;case 10:Tt.effectsCache.vignette+=t.vignette;break;case 11:Tt.effectsCache.letterboxX+=t.moveX,Tt.effectsCache.letterboxY+=t.moveY;break;case 12:if(void 0!==t.tileID)for(i=0;i<t.tileID.length;i++){o=t.tileID[i];0!==t.setColorFor&&2!==t.setColorFor||(Tt.effectsCache.tileColor[o]=t.endColor,Tt.effectsCache.tileSaturation[o]=t.endSaturation,Tt.effectsCache.tileBrightness[o]=t.endBrightness,Tt.effectsCache.tileAlpha[o]=t.endAlpha),1!==t.setColorFor&&2!==t.setColorFor||(Tt.effectsCache.tileOverlayColor[o]=t.endColor,Tt.effectsCache.tileOverlaySaturation[o]=t.endSaturation,Tt.effectsCache.tileOverlayBrightness[o]=t.endBrightness,Tt.effectsCache.tileOverlayAlpha[o]=t.endAlpha)}break;case 13:0===t.setColorFor&&(Tt.effectsCache.backgroundOverlayColor=t.endColor,Tt.effectsCache.backgroundOverlaySaturation=t.endSaturation,Tt.effectsCache.backgroundOverlayBrightness=t.endBrightness,Tt.effectsCache.backgroundOverlayAlpha=t.endAlpha),1===t.setColorFor&&(Tt.effectsCache.foregroundOverlayColor=t.endColor,Tt.effectsCache.foregroundOverlaySaturation=t.endSaturation,Tt.effectsCache.foregroundOverlayBrightness=t.endBrightness,Tt.effectsCache.foregroundOverlayAlpha=t.endAlpha);break;case 14:if(void 0!==t.tileID)for(i=0;i<t.tileID.length;i++){o=t.tileID[i];Tt.effectsCache.tileTrailLength[o]+=t.trailLength,Tt.effectsCache.tileTrailSpacing[o]+=t.trailSpacing,Tt.effectsCache.tileTrailAlpha[o]+=t.trailAlpha/255,Tt.effectsCache.tileTrailColor[o]=t.trailColor,t.trailDelete&&(Tt.effectsCache.tileTrailDelete[o]=t.time)}}else switch(t.type){case 0:Tt.effected.boardX+=0===t.moveX?0:It(Tt.time-t.time,t.moveTime,t.moveX,t.easeType),Tt.effected.boardY+=0===t.moveY?0:It(Tt.time-t.time,t.moveTime,t.moveY,t.easeType);break;case 1:Tt.effected.boardW+=It(Tt.time-t.time,t.moveTime,t.scaleX-1,t.easeType),Tt.effected.boardH+=It(Tt.time-t.time,t.moveTime,t.scaleY-1,t.easeType);break;case 2:Tt.effected.boardR+=It(Tt.time-t.time,t.moveTime,t.moveD,t.easeType);break;case 3:if(void 0!==t.tileID)for(i=0;i<t.tileID.length;i++){o=t.tileID[i];Tt.effected.tileX[o]+=It(Tt.time-t.time,t.moveTime,t.moveX,t.easeType),Tt.effected.tileY[o]+=It(Tt.time-t.time,t.moveTime,t.moveY,t.easeType)}break;case 4:if(void 0!==t.tileID)for(i=0;i<t.tileID.length;i++){o=t.tileID[i];Tt.effected.tileW[o]+=It(Tt.time-t.time,t.moveTime,t.scaleX-1,t.easeType),Tt.effected.tileH[o]+=It(Tt.time-t.time,t.moveTime,t.scaleY-1,t.easeType)}break;case 5:if(void 0!==t.tileID)for(i=0;i<t.tileID.length;i++){o=t.tileID[i];Tt.effected.tileR[o]+=It(Tt.time-t.time,t.moveTime,t.moveD,t.easeType)}break;case 6:Tt.effected.ar+=It(Tt.time-t.time,t.moveTime,t.targetValue,t.easeType);break;case 7:Tt.effected.boardA+=It(Tt.time-t.time,t.moveTime,t.targetValue/255,t.easeType);break;case 8:if(void 0!==t.tileID)for(i=0;i<t.tileID.length;i++){o=t.tileID[i];Tt.effected.tileA[o]+=It(Tt.time-t.time,t.moveTime,t.targetValue/255,t.easeType)}break;case 9:Tt.time<t.time+t.moveTime&&Tt.effected.subtitles.push(t);break;case 10:Tt.effected.vignette+=It(Tt.time-t.time,t.moveTime,t.vignette,t.easeType);break;case 11:Tt.effected.letterboxX+=0===t.moveX?0:It(Tt.time-t.time,t.moveTime,t.moveX,t.easeType),Tt.effected.letterboxY+=0===t.moveY?0:It(Tt.time-t.time,t.moveTime,t.moveY,t.easeType);break;case 12:if(void 0!==t.tileID)for(i=0;i<t.tileID.length;i++){var o=t.tileID[i],n=It(Tt.time-t.time,t.moveTime,1,t.easeType);!0===t.endSmooth?(colorMode(HSB),s=color(t.startColor,t.startSaturation,t.startBrightness,t.startAlpha),r=color(t.endColor,t.endSaturation,t.endBrightness,t.endAlpha),colorMode(RGB),h=lerpColor(s,r,n),0!==t.setColorFor&&2!==t.setColorFor||(Tt.effected.tileColor[o]=hue(h),Tt.effected.tileSaturation[o]=saturation(h),Tt.effected.tileBrightness[o]=brightness(h),Tt.effected.tileAlpha[o]=alpha(h)),1!==t.setColorFor&&2!==t.setColorFor||(Tt.effected.tileOverlayColor[o]=hue(h),Tt.effected.tileOverlaySaturation[o]=saturation(h),Tt.effected.tileOverlayBrightness[o]=brightness(h),Tt.effected.tileOverlayAlpha[o]=alpha(h))):(void(a=0)!==t.endLoops&&(a=255*t.endLoops),0!==t.setColorFor&&2!==t.setColorFor||(Tt.effected.tileColor[o]=lerp(t.startColor,t.endColor+a,n)%255,Tt.effected.tileColor[o]=Tt.effected.tileColor[o]<0?255+Tt.effected.tileColor[o]:Tt.effected.tileColor[o],Tt.effected.tileSaturation[o]=lerp(t.startSaturation,t.endSaturation,n),Tt.effected.tileBrightness[o]=lerp(t.startBrightness,t.endBrightness,n),Tt.effected.tileAlpha[o]=lerp(t.startAlpha,t.endAlpha,n)),1!==t.setColorFor&&2!==t.setColorFor||(Tt.effected.tileOverlayColor[o]=lerp(t.startColor,t.endColor+a,n)%255,Tt.effected.tileOverlayColor[o]=Tt.effected.tileOverlayColor[o]<0?255+Tt.effected.tileOverlayColor[o]:Tt.effected.tileOverlayColor[o],Tt.effected.tileOverlaySaturation[o]=lerp(t.startSaturation,t.endSaturation,n),Tt.effected.tileOverlayBrightness[o]=lerp(t.startBrightness,t.endBrightness,n),Tt.effected.tileOverlayAlpha[o]=lerp(t.startAlpha,t.endAlpha,n)))}break;case 13:var s,r,h,a,n=It(Tt.time-t.time,t.moveTime,1,t.easeType);!0===t.endSmooth?(colorMode(HSB),s=color(t.startColor,t.startSaturation,t.startBrightness,t.startAlpha),r=color(t.endColor,t.endSaturation,t.endBrightness,t.endAlpha),colorMode(RGB),h=lerpColor(s,r,n),0===t.setColorFor&&(Tt.effected.backgroundOverlayColor=hue(h),Tt.effected.backgroundOverlaySaturation=saturation(h),Tt.effected.backgroundOverlayBrightness=brightness(h),Tt.effected.backgroundOverlayAlpha=alpha(h)),1===t.setColorFor&&(Tt.effected.foregroundOverlayColor=hue(h),Tt.effected.foregroundOverlaySaturation=saturation(h),Tt.effected.foregroundOverlayBrightness=brightness(h),Tt.effected.foregroundOverlayAlpha=alpha(h))):(void(a=0)!==t.endLoops&&(a=255*t.endLoops),0===t.setColorFor&&(Tt.effected.backgroundOverlayColor=lerp(t.startColor,t.endColor+a,n)%255,Tt.effected.backgroundOverlayColor=Tt.effected.backgroundOverlayColor<0?255+Tt.effected.backgroundOverlayColor:Tt.effected.backgroundOverlayColor,Tt.effected.backgroundOverlaySaturation=lerp(t.startSaturation,t.endSaturation,n),Tt.effected.backgroundOverlayBrightness=lerp(t.startBrightness,t.endBrightness,n),Tt.effected.backgroundOverlayAlpha=lerp(t.startAlpha,t.endAlpha,n)),1===t.setColorFor&&(Tt.effected.foregroundOverlayColor=lerp(t.startColor,t.endColor+a,n)%255,Tt.effected.foregroundOverlayColor=Tt.effected.foregroundOverlayColor<0?255+Tt.effected.foregroundOverlayColor:Tt.effected.foregroundOverlayColor,Tt.effected.foregroundOverlaySaturation=lerp(t.startSaturation,t.endSaturation,n),Tt.effected.foregroundOverlayBrightness=lerp(t.startBrightness,t.endBrightness,n),Tt.effected.foregroundOverlayAlpha=lerp(t.startAlpha,t.endAlpha,n)));break;case 14:if(void 0!==t.tileID)for(i=0;i<t.tileID.length;i++){o=t.tileID[i];Tt.effected.tileTrailLength[o]+=It(Tt.time-t.time,t.moveTime,t.trailLength,t.easeType),Tt.effected.tileTrailSpacing[o]+=It(Tt.time-t.time,t.moveTime,t.trailSpacing,t.easeType),Tt.effected.tileTrailAlpha[o]+=It(Tt.time-t.time,t.moveTime,t.trailAlpha/255,t.easeType),Tt.effected.tileTrailColor[o]=t.trailColor,t.trailDelete&&(Tt.effected.tileTrailDelete[o]=t.time)}}}function An(){Tt.sections.push({time:Tt.time,bpm:Tt.timelineBPM,offset:Tt.timelineOffset,color:141,saturation:255,brightness:255,name:Pt("edit_tool_section",xt),visible:!1}),Tt.selectedBeats=[],Tt.effectMultiSel=[],Tt.timelineMode="select",Tt.sectionsSelected[0]=Tt.sections.length-1}function Fn(){for(var e=0,t=0;t<Tt.effects.length;t++)Tt.effects[t].track>e&&(e=Tt.effects[t].track);return e}function Dn(e){for(var t,i,o=(e=e.split("")).length-1;0<=o;o--)"\n"===e[o]&&e.splice(o,1);e=e.join(""),Nt.inp=Nt.inp.split(""),!1!==Nt.anchor?(t=Nt.anchor<Nt.cursor?Nt.anchor:Nt.cursor,i=Nt.anchor>Nt.cursor?Nt.anchor:Nt.cursor,Nt.inp.splice(t,i-t,e),Nt.anchor=!1,Nt.cursor=t):Nt.inp.splice(Nt.cursor,0,e),Nt.inp=Nt.inp.join(""),Nt.cursor+=e.length}function Xn(){var e=Nt.anchor<Nt.cursor?Nt.anchor:Nt.cursor,t=Nt.anchor>Nt.cursor?Nt.anchor:Nt.cursor;Nt.inp=Nt.inp.split(""),!1===Nt.anchor?(Nt.inp.splice(Nt.cursor-1,1),Nt.cursor--):(Nt.inp.splice(e,t-e),Nt.anchor=!1,Nt.cursor=e),Nt.inp=Nt.inp.join("")}function Wn(e,t){for(var i=[],o=[],n=(e.sort(function(e,t){return e[0]-t[0]}),t.sort(function(e,t){return e.time-t.time}),0),s=0;s<e.length;s++){void 0===i[n]&&(o[n]=i[n]=0);var r=!1;void 0!==t[n+1]&&(r=t[n+1].time),e[s][0]<t[0].time||(e[s][0]>=t[n].time&&(!1===r||e[s][0]<r)?(i[n]+=Tt.hitValues[e[s][1]].acc,o[n]++):(n++,s--))}for(s=0;s<t.length;s++)0===o[s]?i[s]=100:i[s]/=o[s];return i}function Un(e,t,i,o,n,s){push(),translate(e,t+n*i);for(var r,h=0;h<s.length;h++)abs(h-n)>1-o+1||(r=Math.sin(Math.PI*(h+1-n)/2)+1,void 0!==s[h].color&&fill(s[h].color,alpha(s[h].color)*(r-o)),void 0!==s[h].text&&(textSize(Ot(i*r/2)),text(s[h].text,0,i*-h)));pop()}function Ln(e,t,i,o){e=constrain(millis()-e,0,t);return lerp(i,o,Math.sin(Math.PI*(e/t)/2))}function Kn(e,t,i,o,n){i=i[i.length-1].timing;return[n[0]/o*(.9*e)+.1*e,t/2+t/2*(n[2]/i)]}function Vn(e,t,i,o,n,s,r){for(var h=color(4,200),a=(e.background(h),e.textFont(Je.n),n[n.length-1].timing),l=n.length-2;0<=l;l--){var d=n[l];e.noStroke(),e.fill(lerpColor(h,d.color,.2)),e.rect(0,i/2-i/2*(d.timing/a),t,i*(d.timing/a))}e.strokeWeight(i/75);for(var g=0,l=0;l<s.length;l++){var c=s[l],[f,u]=(e.stroke(n[c[1]].color),Kn(t,i,n,r,c));e.point(f,u),g+=c[2]}g/=s.length,e.stroke(255,100),e.line(0,i/2+i/2*(g/a),t,i/2+i/2*(g/a)),e.fill(h),e.noStroke(),e.rect(0,0,.1*t,i);o=o/Tt.bpm*120*1/2*1e3;e.fill(255),e.textAlign(CENTER,CENTER),e.textSize(Ot(t/40)),e.text("-"+Ot(o*n[n.length-2].timing)+"ms",.05*t,i/2-i/2*(n[n.length-2].timing/a)),e.text("+"+Ot(o*n[n.length-2].timing)+"ms",.05*t,i/2+i/2*(n[n.length-2].timing/a)),e.text((0<g?"+":"")+Ot(o*g)+"ms",.05*t,i/2+i/2*(g/a))}function Mn(e){switch(e){case"menu":Bt.lvl.prevPlay=Tt.song,Bt.lvl.loading=!1,Tt.buttonHover[1]/=2,Tt.replay.on&&Yn(Tt.replay.preMods),Vi("menu","game");break;case"retry":Tt.disMode=Tt.paused?1:3,Tt.retry=!0,Tt.buttonHover[0]/=2,Bt.lvl.prevPlay=Tt.song,Tt.songVol=100;break;case"continue":!1===Tt.resumeTime?Tt.resumeTime=millis():Tt.resumeTime=!1}}function qn(e,t,i){var o=Tt.timelineBPM/Tt.bpm;Tt.time+=Tt.snap/o*("LEFT"===e?-1:1)*(t?4:1)*(i?16:1),Tt.tileTrail=[],Tt.tileTrailLast=[0,0,0,0,0,0,0,0,0]}function Zn(){for(var e=[["BoardX: ",Tt.effected.boardX],["BoardY: ",Tt.effected.boardY],["BoardW: ",Tt.effected.boardW],["BoardH: ",Tt.effected.boardH],["BoardR: ",Tt.effected.boardR],["BoardA: ",Tt.effected.boardA],["TileX: ",Tt.effected.tileX],["TileY: ",Tt.effected.tileY],["TileW: ",Tt.effected.tileW],["TileH: ",Tt.effected.tileH],["TileR: ",Tt.effected.tileR],["TileA: ",Tt.effected.tileA],["Foresight: ",Tt.effected.ar],["Subtitles: ",Tt.effected.subtitles.length],["Vignette: ",Tt.effected.vignette],["LetterboxX: ",Tt.effected.letterboxX],["LetterboxY: ",Tt.effected.letterboxY],["TileHue: ",Tt.effected.tileColor],["TileSaturation: ",Tt.effected.tileSaturation],["TileBrightness: ",Tt.effected.tileBrightness],["TileAlpha: ",Tt.effected.tileAlpha],["TileOverlayHue: ",Tt.effected.tileOverlayColor],["TileOverlaySaturation: ",Tt.effected.tileOverlaySaturation],["TileOverlayBrightness: ",Tt.effected.tileOverlayBrightness],["TileOverlayAlpha: ",Tt.effected.tileOverlayAlpha],["BackgroundOverlayHue: ",Tt.effected.backgroundOverlayColor],["BackgroundOverlaySaturation: ",Tt.effected.backgroundOverlaySaturation],["BackgroundOverlayBrightness: ",Tt.effected.backgroundOverlayBrightness],["BackgroundOverlayAlpha: ",Tt.effected.backgroundOverlayAlpha],["ForegroundOverlayHue: ",Tt.effected.foregroundOverlayColor],["ForegroundOverlaySaturation: ",Tt.effected.foregroundOverlaySaturation],["ForegroundOverlayBrightness: ",Tt.effected.foregroundOverlayBrightness],["ForegroundOverlayAlpha: ",Tt.effected.foregroundOverlayAlpha],["TileTrailLength: ",Tt.effected.tileTrailLength],["TileTrailSpacing: ",Tt.effected.tileTrailSpacing],["TileTrailAlpha: ",Tt.effected.tileTrailAlpha],["TileTrailColor: ",Tt.effected.tileTrailColor],["TileTrailDelete: ",Tt.effected.tileTrailDelete]],t="",i=0;i<e.length;i++){if(0!==i&&(t+="\n"),isNaN(e[i][1])){if(Array.isArray(e[i][1]))for(var o=0;o<e[i][1].length;o++){var n,s=e[i][1][o];isNaN(s)||!0===s||!1===s||(n=String(s.toFixed(3))).length<String(s).length&&(e[i][1][o]=n),0<o&&(e[i][1][o]=" "+e[i][1][o])}}else(n=String(e[i][1].toFixed(3))).length<String(e[i][1]).length&&(e[i][1]=n);t+=e[i][0]+e[i][1]}return t}function jn(e,t){"beat"!==t&&(Tt.selectedBeats=[]),"effects"!==t?Tt.effectMultiSel=[]:Tt.effectMultiSelLast=!1,"sections"!==t&&(Tt.sectionsSelected=[]);var i={};switch(t){case"beat":i="selectedBeats";break;case"effects":i="effectMultiSel";break;case"sections":i="sectionsSelected"}if((N||Gt)&&"sections"!==t){if(N)-1===Tt[i].indexOf(e)?Tt[i].push(e):Tt[i].splice(Tt[i].indexOf(e),1);else if(Gt)if("beat"===t){var o=Tt.beat[e],n=Tt.selectedBeats.map(e=>Tt.beat[e][1]),s=Math.min(o[1],...n),r=Math.max(o[1],...n);for(let e=Tt.selectedBeats.length=0;e<Tt.beat.length;e++){var h=Tt.beat[e];h[1]>=s-ls&&h[1]<=r+ls&&Tt.selectedBeats.push(e)}}else if("effects"===t){var o=Tt.effects[e],n=Tt.effectMultiSel.map(e=>Tt.effects[e].time),a=Math.min(o.time,...n),l=Math.max(o.time,...n);for(let e=Tt.effectMultiSel.length=0;e<Tt.effects.length;e++){var d=Tt.effects[e];d.time>=a-ls&&d.time<=l+ls&&Tt.effectMultiSel.push(e)}}}else 1!==Tt[i].length||-1===Tt[i].indexOf(e)?Tt[i]=[e]:Tt[i]=[]}function Gn(e){at.push({type:e.type,message:e.message,keys:e.keys??[],time:millis(),x:width-width/8,y:1.5*height,headerHover:0})}function Yn(e,t){for(var i in t=void 0===t?Tt.mods:t)void 0===e[i]||null===e[i]?t[i]=Tt.modsDef[i]:t[i]=e[i]}function Jn(e,t,i,o,n,s){o*=2*n/60,o=abs((floor(o)%2==1?0:1)-abs(floor(o)-o)),o=pow(n,o)/n;o%=1,push(),translate(e,t),scale(i/200),s&&scale(-1,1),scale(1+.1*o),rectMode(CENTER),push(),translate(0,-20*o),strokeWeight(7.5),stroke(255),fill(0,175,255),ellipse(150,12.5,50,50),pop(),push(),scale(1-.15*o,1-.05*o),stroke(255),strokeWeight(10),fill(0,125,205),rect(0,0,200,200,10),rotate((22.5+o)*(s?-1:1)),fill(0,175,255),rect(0,0,200,200,10),rotate(-22.5*(s?-1:1)),push(),translate(0,-5*o),noStroke(),fill(255),ellipse(-25,-12.5,25,50),ellipse(50,-12.5,25,50),noStroke(),arc(12.5,25,50,50,0,180),pop(),pop(),push(),translate(0,-20*o),strokeWeight(7.5),stroke(255),fill(0,175,255),ellipse(-150,-50,50,50),pop(),pop()}function _n(){let e="";return"account"===Bt.screen?e=!1===Bt.account.friendsScreen?T.uuid:Bt.account.viewFriend:"online"===Bt.screen&&(e=Bt.online.viewUser),e}function $n(e){var t=_n();!1===Bt.account.friendsScreen&&"account"===Bt.screen&&(Ft("rcorner",3*kt+width/3*1.5+width/3.5,4*(height/16+kt),width/6.5,height/16)&&(Bt.account.buttonHover[5]/=2,cn()),Ft("rcorner",3*kt+width/3*1.5+width/3.5,3*(height/16+kt),width/6.5,height/16)&&(Bt.account.buttonHover[8]/=2,es()),Ft("rcorner",3*kt+width/3*1.5+width/3.5,2*(height/16+kt),width/6.5,height/16)&&(Bt.account.buttonHover[7]/=2,Bt.online.searchedUsers=[],Bt.account.friendsScreen="incFR"),Ft("rcorner",3*kt+width/3*1.5+width/3.5,height/16+kt,width/6.5,height/16))&&(Bt.account.buttonHover[6]/=2,Bt.online.searchedUsers=[],Bt.account.friendsScreen="friends"),0===T.uuid.length?(Ft("rcorner",3*kt+width/3*1.5+width/3.5,2*(height/16+kt),width/6.5,height/16)&&("account"===e?Bt.account.viewFriend=!1:(Bt.online.mode="main",Bt.online.viewUser="")),Ft("rcorner",3*kt+width/3*1.5+width/3.5,height/16+kt,width/6.5,height/16)&&(Bt.account.buttonHover[7]/=2,es())):-1!==po(T.uuid).indexOf(t)?(Ft("rcorner",3*kt+width/3*1.5+width/3.5,3*(height/16+kt),width/6.5,height/16)&&("account"===e?Bt.account.viewFriend=!1:(Bt.online.mode="main",Bt.online.viewUser="")),Ft("rcorner",3*kt+width/3*1.5+width/3.5,2*(height/16+kt),width/6.5,height/16)&&(Bt.account.buttonHover[7]/=2,es()),Ft("rcorner",3*kt+width/3*1.5+width/3.5,height/16+kt,width/6.5,height/16)&&(B("removeFriend",{to:T.uuid,from:t,session:T.session}),v.grabbedFriends[T.uuid]=[],mo.clear())):-1!==vo(T.uuid,"incoming").indexOf(t)?(Ft("rcorner",3*kt+width/3*1.5+width/3.5,4*(height/16+kt),width/6.5,height/16)&&("account"===e?Bt.account.viewFriend=!1:(Bt.online.mode="main",Bt.online.viewUser="")),Ft("rcorner",3*kt+width/3*1.5+width/3.5,3*(height/16+kt),width/6.5,height/16)&&(Bt.account.buttonHover[8]/=2,es()),Ft("rcorner",3*kt+width/3*1.5+width/3.5,height/16+kt,width/6.5,height/16)&&(B("acceptFriendRequest",{to:T.uuid,from:t,session:T.session}),v.grabbedIncFriendReqs[T.uuid]=[],v.grabbedFriends[T.uuid]=[],v.grabbedFriendsT[T.uuid]=0,mo.clear()),Ft("rcorner",3*kt+width/3*1.5+width/3.5,2*(height/16+kt),width/6.5,height/16)&&(B("denyFriendRequest",{to:T.uuid,from:t,session:T.session}),v.grabbedIncFriendReqs[T.uuid]=[],v.grabbedFriends[T.uuid]=[],mo.clear(),v.grabbedFriendsT[T.uuid]=0)):-1!==vo(T.uuid,"outgoing").indexOf(t)?(Ft("rcorner",3*kt+width/3*1.5+width/3.5,3*(height/16+kt),width/6.5,height/16)&&("account"===e?Bt.account.viewFriend=!1:(Bt.online.mode="main",Bt.online.viewUser="")),Ft("rcorner",3*kt+width/3*1.5+width/3.5,2*(height/16+kt),width/6.5,height/16)&&(Bt.account.buttonHover[7]/=2,es()),Ft("rcorner",3*kt+width/3*1.5+width/3.5,height/16+kt,width/6.5,height/16)&&(B("revokeFriendRequest",{from:T.uuid,to:t,session:T.session}),v.grabbedOutFriendReqs[T.uuid]=[],v.grabbedFriends[T.uuid]=[],mo.clear(),v.grabbedFriendsT[T.uuid]=0)):"account"===Bt.screen&&!1===Bt.account.friendsScreen||(Ft("rcorner",3*kt+width/3*1.5+width/3.5,3*(height/16+kt),width/6.5,height/16)&&("account"===e?Bt.account.viewFriend=!1:(Bt.online.mode="main",Bt.online.viewUser="")),Ft("rcorner",3*kt+width/3*1.5+width/3.5,2*(height/16+kt),width/6.5,height/16)&&(Bt.account.buttonHover[7]/=2,es()),t!==T.uuid&&Ft("rcorner",3*kt+width/3*1.5+width/3.5,height/16+kt,width/6.5,height/16)&&(B("sendFriendRequest",{to:t,from:T.uuid,session:T.session}),v.grabbedOutFriendReqs[T.uuid]=[],v.grabbedFriends[T.uuid]=[],mo.clear(),v.grabbedFriendsT[T.uuid]=0))}function es(){var e=_n();v.grabbedIncFriendReqs[T.uuid]=void 0,v.grabbedOutFriendReqs[T.uuid]=void 0,v.grabbedFriends[T.uuid]=void 0,mo.clear(),v.grabbedFriendsT[T.uuid]=0,v.newGURequested[e]=void 0,v.newGURequestedT[e]=void 0,v.newGUURequested[e]=void 0,v.newGUURequestedT[e]=void 0,v.grabbedScoresUser[e]=void 0,mn.clear(),v.grabbedScoresTime=0}var ts=0;function is(e){20<millis()-ts&&(console.log(e),ts=millis())}function os(e,t){if(-1!==ns.indexOf(e))F[e]=JSON.parse(t.join(""));else if(-1!==ns.indexOf(e.substr(0,e.length-1))&&"C"===e.substr(e.length-1,1))if(D[e]=JSON.parse(t.join("")),"nlC"===e||"thC"===e||"roC"===e||"pt_BRC"===e||"plC"===e)for(var i=0;i<D[e].length;i++){var o=D[e][i].alpha2.toUpperCase(),n=D[e][i].name;D[e][o]={},D[e][o].name=n}else if("tlC"===e||"trC"===e){var s=D[e];for(const[e,a]of Object.entries(s))s[e]={name:a}}var r,h=rs[e]=!0;for(r in rs)!1===rs[r]&&(h=!1);h&&hs()}var ns=["en","de","es","fr","ru","nl","th","ro","pt_BR","pl","tl","tr"],ss=14,rs={changelogParsed:!1},et=!1;function hs(){Eo.colors.set("white",yo.of(255,255,255)).set("na",yo.of(85)).set("stars0",yo.of(75,110,255)).set("stars1",yo.of(75,175,255)).set("stars2",yo.of(75,225,75)).set("stars3",yo.of(255,175,75)).set("stars4",yo.of(255,75,75)).set("stars5",yo.of(255,75,255)).set("stars6",yo.of(175,0,255)).set("special",yo.of(225,225,125)),yo.resolveAll(),Bt.settings.menu=new Jo([{title:"settings_header_universal",items:[{name:"settings_keyboard",type:"dropdown",hint:"settings_keyboard_sub",var:[Bt.settings,"keyboard"],options:[3,2,5],labels:["settings_keyboard_typeLETTERS","settings_keyboard_typeNUMPAD","settings_keyboard_typeDUAL"]},{name:"settings_language",type:"dropdown",hint:"settings_language_sub",var:[Bt.settings,"language"],options:[0,1,2,3,4,5,6,7,8,9,10,11],labels:[[Pt("language","en")],[Pt("language","de")],[Pt("language","es")],[Pt("language","fr")],[Pt("language","ru")],[Pt("language","nl")],[Pt("language","th")],[Pt("language","ro")],[Pt("language","pt_BR")],[Pt("language","pl")],[Pt("language","tl")],[Pt("language","tr")]]},{name:"settings_theme",type:"dropdown",hint:"settings_theme_sub",var:[Bt.settings,"themeSel"],options:[0,1,2],labels:["theme_classic","theme_light","theme_dark"]},{type:"slider",name:"settings_backgroundDim",var:[Bt.settings,"bgDim"],min:0,max:100,step:1,hint:"settings_backgroundDim_sub",display:()=>Pt("percentage",xt,Bt.settings.bgDim.toFixed(0))},{type:"slider",name:"settings_musicVolume",var:[Bt.settings,"musicVolume"],min:0,max:100,step:1,hint:"settings_musicVolume_sub",display:()=>Pt("percentage",xt,Bt.settings.musicVolume.toFixed(0))},{type:"slider",name:"settings_menuMusicVolume",var:[Bt.settings,"menuMusicVolume"],min:0,max:100,step:1,hint:"settings_menuMusicVolume_sub",display:()=>Pt("percentage",xt,Bt.settings.menuMusicVolume.toFixed(0))},{type:"slider",name:"settings_hitsoundVolume",var:[Bt.settings,"hitsoundVolume"],min:0,max:100,step:1,hint:"settings_hitsoundVolume_sub",display:()=>Pt("percentage",xt,Bt.settings.hitsoundVolume.toFixed(0))},{type:"slider",name:"settings_comboBreakVolume",var:[Bt.settings,"comboBreakVolume"],min:0,max:100,step:1,hint:"settings_comboBreakVolume_sub",display:()=>Pt("percentage",xt,Bt.settings.comboBreakVolume.toFixed(0))},{type:"number",name:"settings_offset",hint:"settings_offset_sub",var:[Bt.settings,"offset"],min:!1,max:!1,bigChange:10,smallChange:1}]},{title:"settings_header_notes",items:[{type:"slider",name:"settings_beatThickness",var:[Bt.settings,"beatThickness"],min:1,max:10,step:.1,hint:"settings_beatThickness_sub"},{type:"slider",name:"settings_holdThickness",var:[Bt.settings,"holdThickness"],min:1,max:10,step:.1,hint:"settings_holdThickness_sub"},{type:"slider",name:"settings_holdProgressThickness",var:[Bt.settings,"holdProgressThickness"],min:1,max:10,step:.1,hint:"settings_holdProgressThickness_sub"},{type:"slider",name:"settings_holdAngle",var:[Bt.settings,"holdAngle"],min:0,max:359,step:1,hint:"settings_holdAngle_sub",display:()=>Pt("degrees",xt,Bt.settings.holdAngle.toFixed(0))},{name:"settings_holdDirection",type:"dropdown",hint:"settings_holdDirection_sub",var:[Bt.settings,"holdDirection"],options:[0,1],labels:["cw","ccw"]},{type:"slider",name:"settings_beatTransparency",var:[Bt.settings,"noteEdgeOpacity"],min:0,max:100,step:1,hint:"settings_beatTransparency_sub",display:()=>Pt("percentage",xt,Bt.settings.noteEdgeOpacity.toFixed(0))},{type:"slider",name:"settings_holdProgressOpacity",var:[Bt.settings,"holdProgressOpacity"],min:0,max:100,step:1,hint:"settings_holdProgressOpacity_sub",display:()=>Pt("percentage",xt,Bt.settings.holdProgressOpacity.toFixed(0))},{type:"slider",name:"settings_notePaneOpacity",var:[Bt.settings,"notePaneOpacity"],min:0,max:100,step:1,hint:"settings_notePaneOpacity_sub",display:()=>Pt("percentage",xt,Bt.settings.notePaneOpacity.toFixed(0))}]},{title:"settings_header_particles",items:[{type:"slider",name:"settings_hitParticles",var:[Bt.settings,"hitParticlesThickness"],min:0,max:10,step:.1,hint:"settings_hitParticles_sub"},{type:"slider",name:"settings_hitParticlesOpacity",var:[Bt.settings,"hitParticlesOpacity"],min:0,max:100,step:1,hint:"settings_hitParticlesOpacity_sub",display:()=>Pt("percentage",xt,Bt.settings.hitParticlesOpacity.toFixed(0))},{type:"slider",name:"settings_hitParticlesSpread",var:[Bt.settings,"hitParticlesSpread"],min:0,max:10,step:1,hint:"settings_hitParticlesSpread_sub"},{type:"slider",name:"settings_hitParticlesDuration",var:[Bt.settings,"hitParticlesDuration"],min:50,max:500,step:50,hint:"settings_hitParticlesDuration_sub",display:()=>Pt("milliseconds_short",xt,Bt.settings.hitParticlesDuration.toFixed(0))},{type:"boolean",var:[Bt.settings,"disableMarvelouses"],name:"settings_disableMarvelouses",hint:"settings_disableMarvelouses_sub"},{type:"boolean",var:[Bt.settings,"disableGreats"],name:"settings_disableGreats",hint:"settings_disableGreats_sub"},{type:"boolean",var:[Bt.settings,"disableGoods"],name:"settings_disableGoods",hint:"settings_disableGoods_sub"},{type:"boolean",var:[Bt.settings,"disableOks"],name:"settings_disableOks",hint:"settings_disableOks_sub"},{type:"boolean",var:[Bt.settings,"disableMisses"],name:"settings_disableMisses",hint:"settings_disableMisses_sub"}]},{title:"settings_header_gui",items:[{type:"slider",name:"settings_headerWidth",var:[Bt.settings,"headerWidth"],min:1,max:10,step:1,hint:"settings_headerWidth_sub"},{name:"settings_boardOverlayType",type:"dropdown",hint:"settings_boardOverlayType_sub",var:[Bt.settings,"overlayText"],options:[!1,3,2],labels:["default","settings_keyboard_typeLETTERS","settings_keyboard_typeNUMPAD"]},{type:"slider",name:"settings_boardOverlay",var:[Bt.settings,"boardOverlay"],min:0,max:100,step:1,hint:"settings_boardOverlay_sub",display:()=>Pt("percentage",xt,Bt.settings.boardOverlay.toFixed(0))},{type:"slider",name:"settings_tilePush",var:[Bt.settings,"tilePush"],min:0,max:10,step:1,hint:"settings_tilePush_sub"},{type:"boolean",var:[Bt.settings,"showAccuracy"],name:"settings_showAccuracy",hint:"settings_showAccuracy_sub"},{type:"boolean",var:[Bt.settings,"showProgress"],name:"settings_showProgress",hint:"settings_showProgress_sub"},{type:"boolean",var:[Bt.settings,"showHP"],name:"settings_showHP",hint:"settings_showHP_sub"},{type:"boolean",var:[Bt.settings,"showJudgements"],name:"settings_showJudgements",hint:"settings_showJudgements_sub"},{type:"boolean",var:[Bt.settings,"showUR"],name:"settings_showUR",hint:"settings_showUR_sub"},{type:"boolean",var:[Bt.settings,"showScore"],name:"settings_showScore",hint:"settings_showScore_sub"},{type:"boolean",var:[Bt.settings,"showCombo"],name:"settings_showCombo",hint:"settings_showCombo_sub"},{type:"boolean",var:[Bt.settings,"showSections"],name:"settings_showSections",hint:"settings_showSections_sub"}]},{title:"settings_header_performance",items:[{name:"settings_fpsLimit",type:"dropdown",hint:"settings_fpsLimit_sub",var:[Bt.settings,"fpsLimit"],options:["vsync",25,30,50,60,75,90,120,144,240,2400],labels:["settings_fpsLimit_vsync",[25],[30],[50],[60],[75],[90],[120],[144],[240],"settings_fpsLimit_unlimited"]},{type:"boolean",var:[Bt.settings,"disableEase"],name:"settings_disableEase",hint:"settings_disableEase_sub"},{type:"boolean",var:[Bt.settings,"debugOverlay"],name:"settings_debugOverlay",hint:"settings_debugOverlay_sub"}]},{title:"pulsusPlatinum",items:[{name:"settings_menuMusic",type:"string",hint:"settings_menuMusic_sub",var:[Bt.settings,"menuMusic"],allowEmpty:!0},{name:"settings_defaultBackground",type:"file",hint:"settings_defaultBackground_sub",var:[Bt.settings,"defaultBackground"],fileType:"image",sizeLimit:512e3,success:function(e){Bt.settings.defaultBackground=e.data},reset:function(){Bt.settings.defaultBackground=""}}]}]),Tt.effectsNSM=new Jo([]),Tt.beatNSM=new Jo([]),Tt.sectionsNSM=new Jo([]),g.hsbNSM=new Jo([{title:"settings_header_gameplay",items:[]}]),g.rgbNSM=new Jo([{title:"settings_header_gameplay",items:[]}]),Tt.menuNSM=new Jo([{title:"edit_tool_menu",items:[{type:"slider",name:"edit_menu_item_foresight",var:[Tt,"oldAr"],min:.1,max:5,step:.05,hint:"edit_menu_item_foresight_sub"},{type:"slider",name:"edit_menu_item_hitWindow",var:[Tt,"hw"],min:.1,max:5,step:.05,hint:"edit_menu_item_hitWindow_sub"},{type:"slider",name:"edit_menu_item_hpD",var:[Tt,"hpD"],min:0,max:100,step:1,hint:"edit_menu_item_hpD_sub"},{type:"file",name:"edit_menu_item_bg",var:[Tt,"bg"],hint:"edit_menu_item_bg_sub",fileType:"image",sizeLimit:512e3,success:function(e){Tt.bg=e.data},reset:function(){Tt.bg=""}},{type:"info",name:"edit_menu_currentSong",hint:"edit_menu_currentSong_sub",var:[Tt,"songOffset"],display:function(){return!0===Lt(Tt.song,"id").error?Pt("edit_menu_currentSongError",xt):void 0!==Qt[Tt.song]?void 0===Lt(Tt.song,"id").link||null===Lt(Tt.song,"id").link?Pt("edit_menu_currentSongError",xt):"loaded"===Qt[Tt.song].state()?Pt("menu_lvl_song_list",xt,Lt(Tt.song,"id").artist,Lt(Tt.song,"id").name):Pt("menu_downloading",xt):void 0}},{type:"number",name:"edit_menu_item_songID",hint:"edit_menu_item_songID_sub",var:[Tt,"song"],min:1203,max:!1,bigChange:3,smallChange:1},{type:"number",name:"edit_menu_item_songOffset",hint:"edit_menu_item_songOffset_sub",var:[Tt,"songOffset"],min:!1,max:!1,bigChange:10,smallChange:1},{type:"string",name:"edit_menu_item_title",hint:"edit_menu_item_title_sub",var:[Tt,"title"]},{type:"string",name:"edit_menu_item_desc",hint:"edit_menu_item_desc_sub",var:[Tt,"desc"]},{type:"button",name:"edit_menu_item_save",event:function(){Rt=[],Rt=Uo(Ht.saved,"dateDesc"),Yi(Ht.saved.indexOf(Rt[Tt.lvlSel]))},update:function(e){Tt.saved?e.name="edit_menu_item_saved":e.name="edit_menu_item_save"},hint:"edit_menu_item_save_sub"},{type:"button",name:"edit_menu_item_exit",event:function(){Tt.saved?yn():Tt.exiting=!0},hint:"edit_menu_item_exit_sub"}]}]),Bt.lvl.modsNSM=new Jo([{title:"menu_lvl_mods",items:[{type:"slider",name:"mods_bpm",var:[Tt.mods,"bpm"],min:.5,max:2,step:.01,hint:"mods_bpm_sub",display:function(){return Tt.mods.bpm+"x"}},{type:"slider",name:"mods_foresight",var:[Tt.mods,"foresight"],min:.25,max:2,step:.01,flip:!0,hint:"mods_foresight_sub",display:function(){return Tt.mods.foresight+"x"}},{type:"slider",name:"mods_hitWindow",var:[Tt.mods,"hitWindow"],min:.25,max:2,step:.01,flip:!0,hint:"mods_hitWindow_sub",display:function(){return Tt.mods.hitWindow+"x"}},{type:"boolean",name:"mods_hidden",hint:"mods_hidden_sub",var:[Tt.mods,"hidden"]},{type:"boolean",name:"mods_auto",hint:"mods_auto_sub",var:[Tt.mods,"auto"]},{type:"boolean",name:"mods_noEffects",hint:"mods_noEffects_sub",var:[Tt.mods,"noEffects"]},{type:"boolean",name:"mods_noFail",hint:"mods_noFail_sub",var:[Tt.mods,"noFail"]},{type:"boolean",name:"mods_instantFail",hint:"mods_instantFail_sub",var:[Tt.mods,"instantFail"]},{type:"boolean",name:"mods_perfect",hint:"mods_perfect_sub",var:[Tt.mods,"perfect"]},{type:"boolean",name:"mods_mirror",hint:"mods_mirror_sub",var:[Tt.mods,"mirror"]},{type:"boolean",name:"mods_noRelease",hint:"mods_noRelease_sub",var:[Tt.mods,"noRelease"]},{type:"boolean",name:"mods_random",hint:"mods_random_sub",var:[Tt.mods,"random"]},{type:"boolean",name:"mods_flashlight",hint:"mods_flashlight_sub",var:[Tt.mods,"flashlight"]},{type:"number",name:"mods_startPos",hint:"mods_startPos_sub",var:[Tt.mods,"startPos"],min:0,max:!1,bigChange:1e4,smallChange:1e3},{type:"number",name:"mods_endPos",hint:"mods_endPos_sub",var:[Tt.mods,"endPos"],min:0,max:!1,bigChange:1e4,smallChange:1e3,display:()=>0===Tt.mods.endPos?Pt("end",xt):Tt.mods.endPos},{type:"number",name:"mods_offset",hint:"mods_offset_sub",var:[Tt.mods,"offset"],min:!1,max:!1,bigChange:10,smallChange:1}]}]),Bt.lvl.newLeaderboard=new Go,$={main:color(255,255,255),text:color(0,0,0),overlayShade:color(230,230,230),shade:color(210,210,210),buttonDown:color(30,30,30),buttonUp:color(60,60,60),buttonText:color(255,255,255),textDown:color(75,75,75),select:color(128,215,255),modText:color(255,175,0),scrollbar:color(125,125,125),lightTheme:!1},qe=[{main:color(35,50,60),text:color(255,255,255),overlayShade:color(32,45,54),shade:color(20,35,45),buttonDown:color(240,240,240),buttonUp:color(255,255,255),buttonText:color(0,0,0),textDown:color(200,200,200),select:color(60,50,35),modText:color(255,175,0),scrollbar:color(255,255,255),lightTheme:!1,checkmark:color(0,175,255),dropdown:color(225,225,225)},{main:color(255,255,255),text:color(0,0,0),overlayShade:color(230,230,230),shade:color(210,210,210),buttonDown:color(30,30,30),buttonUp:color(60,60,60),buttonText:color(255,255,255),textDown:color(75,75,75),select:color(128,215,255),modText:color(0,175,255),scrollbar:color(125,125,125),lightTheme:!0,checkmark:color(0,175,255),dropdown:color(68,68,68)},{main:color(35,35,35),text:color(255,255,255),overlayShade:color(32,32,32),shade:color(20,20,20),buttonDown:color(240,240,240),buttonUp:color(255,255,255),buttonText:color(0,0,0),textDown:color(200,200,200),select:color(35,50,60),modText:color(0,175,255),scrollbar:color(255,255,255),lightTheme:!1,checkmark:color(0,175,255),dropdown:color(225,225,225)},{main:color(35,60,35),text:color(255,255,255),overlayShade:color(32,54,32),shade:color(20,45,20),buttonDown:color(240,240,240),buttonUp:color(255,255,255),buttonText:color(0,0,0),textDown:color(200,200,200),select:color(60,35,60),modText:color(255,175,255),scrollbar:color(255,255,255),lightTheme:!1,checkmark:color(0,175,255),dropdown:color(225,225,225)},{main:color(77,101,169),text:color(255,255,255),overlayShade:color(65,86,142),shade:color(58,77,127),buttonDown:color(150,175,200),buttonUp:color(255,255,255),buttonText:color(0,0,0),textDown:color(200,200,200),select:color(150,175,200),modText:color(248,104,82),scrollbar:color(255,255,255),lightTheme:!1,checkmark:color(0,175,255),dropdown:color(225,225,225)},{main:color(208,171,0),text:color(255,255,255),overlayShade:color(163,136,0),shade:color(143,119,0),buttonDown:color(255,215,0),buttonUp:color(255,245,200),buttonText:color(0,0,0),textDown:color(200,200,200),select:color(60,22,66),modText:color(60,22,66),scrollbar:color(255,255,255),lightTheme:!1,checkmark:color(60,22,66),dropdown:color(225,225,225)},{main:color(15,15,15),text:color(255,255,255),overlayShade:color(8,8,8),shade:color(5,5,5),buttonDown:color(30,30,30),buttonUp:color(75,75,75),buttonText:color(255,255,255),textDown:color(200,200,200),select:color(163,136,0),modText:color(255,215,0),scrollbar:color(255,215,0),lightTheme:!1,checkmark:color(255,215,0),dropdown:color(225,225,225)},{main:color(30,45,75),text:color(255,255,255),overlayShade:color(27,40,69),shade:color(20,30,55),buttonDown:color(240,240,240),buttonUp:color(255,255,255),buttonText:color(0,0,0),textDown:color(200,200,200),select:color(50,50,50),modText:color(100,100,100),scrollbar:color(255,255,255),lightTheme:!1,checkmark:color(200,200,200),dropdown:color(225,225,225)},{main:color(60,25,35),text:color(255,255,255),overlayShade:color(54,22,30),shade:color(45,10,20),buttonDown:color(240,240,240),buttonUp:color(255,255,255),buttonText:color(0,0,0),textDown:color(200,200,200),select:color(35,50,60),modText:color(0,175,255),scrollbar:color(255,255,255),lightTheme:!1,checkmark:color(0,175,255),dropdown:color(225,225,225)},{main:color(60,25,60),text:color(255,255,255),overlayShade:color(54,22,54),shade:color(45,10,45),buttonDown:color(240,240,240),buttonUp:color(255,255,255),buttonText:color(0,0,0),textDown:color(200,200,200),select:color(35,50,60),modText:color(0,175,255),scrollbar:color(255,255,255),lightTheme:!1,checkmark:color(0,175,255),dropdown:color(225,225,225)}],Tt.hitValues=[{points:150,timing:.05,acc:100,name:"Marvelous",color:color(200,0,255),hp:8,comboBreak:!1},{points:100,timing:.1,acc:100,name:"Great",color:color(0,175,255),hp:5,comboBreak:!1},{points:50,timing:.2,acc:50,name:"Good",color:color(0,255,0),hp:0,comboBreak:!1},{points:20,timing:.3,acc:20,name:"Ok",color:color(255,175,0),hp:-.25,comboBreak:!1},{points:0,timing:.5,acc:0,name:"Miss",color:color(255,0,0),hp:-1,comboBreak:!0}],Tt.ranks=[{symbol:"Π",color:color(127,227,225),score:2.5,shiny:!0},{symbol:"SS",color:color(201,176,55),score:2,shiny:!0},{symbol:"S",color:color(200,200,200),score:1},{symbol:"A",color:color(0,175,255),score:.85},{symbol:"B",color:color(0,255,0),score:.675},{symbol:"C",color:color(255,175,0),score:.5},{symbol:"D",color:color(255,0,175),score:.35},{symbol:"F",color:color(255,0,0),score:0},{symbol:"X",color:color(30),score:0}],Tt.tools=[["edit_tool_play",St.play,0,!1],["edit_tool_object_beat",St.objectBeat,0],["edit_tool_playback",St.objectBeat,0,!1],["edit_tool_bpm",St.timelineBPM,0,[["edit_tool_bpm_offset",St.timelineOffset,0,!1]]],["edit_tool_timelineMode",St.timelineSnap,0,!1],["edit_tool_metronome_off",St.metronome,0,!1],["edit_tool_paste",St.paste,0,!1],["edit_tool_mode_gameplay",St.editorModeGameplay,0,!1],["edit_tool_menu",St.menu,0,!1]],kt=width>height?width/64:height/64,lowLag.init(),lowLag.load("/client/resources/sound/hitsound02.mp3","hitsound"),lowLag.load("/client/resources/sound/metronome01.mp3","metronomeHigh"),lowLag.load("/client/resources/sound/metronome02.mp3","metronome"),lowLag.load("/client/resources/sound/holdRelease.mp3","holdRelease"),lowLag.load("/client/resources/sound/comboBreak.mp3","comboBreak"),no.connect(oo.destination),B("test"),o.on("authComplete",function(e){void 0!==e.session&&null!==e.session&&(window.localStorage.setItem("session",e.session),T.session=e.session),T.name=e.user,T.uuid=e.uuid,T.pp=e.pp,T.recievedAll=!0}),o.on("downloadingLevelData",function(e){Bt.lvl.downloading=!0,Bt.lvl.downloadVar.beat=e.beat,Bt.lvl.downloadVar.id=e.id,Bt.lvl.downloadVar.bpm=e.bpm,Bt.lvl.downloadVar.ar=e.ar,Bt.lvl.downloadVar.hpD=e.hpD,Bt.lvl.downloadVar.effects=e.effects,Bt.lvl.downloadVar.song=e.song,Bt.lvl.downloadVar.bg=e.bg,Bt.lvl.downloadVar.songOffset=e.songOffset,Bt.lvl.downloadVar.title=e.title,Bt.lvl.downloadVar.desc=e.desc,Bt.lvl.downloadVar.author=e.author}),o.on("grabbedUserData",function(e){var t;!1!==e.replace?(t=e.replace,v.grabbedUserData[e.replace]=[]):(t=v.grabbedUserData.length-1,v.grabbedUserData[v.grabbedUserData.length]=[]),v.grabbedUserData[t][0]=e.uuid,v.grabbedUserData[t][1]=e.user,v.grabbedUserData[t][2]=e.pp}),o.on("grabbedSongDataAll",function(e){Bt.song.data=e.songData}),o.on("grabbedSongData",function(e){var t;!1!==e.replace?(t=e.replace,v.grabbedSongData[e.replace]=[]):(t=v.grabbedSongData.length-1,v.grabbedSongData[v.grabbedSongData.length]=[]),v.grabbedSongData[t][0]=e.id,v.grabbedSongData[t][1]=e.name,v.grabbedSongData[t][2]=e.artist,v.grabbedSongData[t][3]=e.link}),o.on("grabbedLevelData",function(e){var t;!1!==e.replace?(t=e.replace,v.grabbedLevelData[e.replace]={}):(t=v.grabbedLevelData.length-1,v.grabbedLevelData[v.grabbedLevelData.length]={}),v.grabbedLevelData[t].id=e.id,v.grabbedLevelData[t].diff=e.diff}),o.on("uploadSongFinished",function(e){Bt.newSong.uploaded=!0,Bt.newSong.uploadID=e.id}),o.on("grabbedLevelDataAll",function(e){Bt.onlineLvl.data=e.levelData}),o.on("newGrabbedLevel",function(e){!1!==e.error&&(void 0===v.newGrabbedLevels[e.id]||"Metadata"===v.newGrabbedLevels[e.id].beat&&"Metadata"!==e.beat)?(void 0===v.newGrabbedLevels[e.id]&&(v.newGrabbedLevels[e.id]={}),v.newGrabbedLevels[e.id].id=e.id,v.newGrabbedLevels[e.id].beat=(("Metadata"!==e.beat||void 0!==v.newGrabbedLevels[e.id].beat&&0<v.newGrabbedLevels[e.id].beat.length)&&"Metadata"===e.beat?v.newGrabbedLevels[e.id]:e).beat,v.newGrabbedLevels[e.id].bpm=e.bpm,v.newGrabbedLevels[e.id].ar=e.ar,v.newGrabbedLevels[e.id].hw=e.hw,v.newGrabbedLevels[e.id].hpD=e.hpD,v.newGrabbedLevels[e.id].effects=(("Metadata"!==e.effects||void 0!==v.newGrabbedLevels[e.id].effects&&0<v.newGrabbedLevels[e.id].effects.length)&&"Metadata"===e.effects?v.newGrabbedLevels[e.id]:e).effects,v.newGrabbedLevels[e.id].sections=e.sections,v.newGrabbedLevels[e.id].bg=e.bg,void 0!==e.len&&(v.newGrabbedLevels[e.id].len=e.len,v.newGrabbedLevels[e.id].bpmDis=e.bpmDis,v.newGrabbedLevels[e.id].arDis=e.arDis,v.newGrabbedLevels[e.id].beatLen=e.beatLen),v.newGrabbedLevels[e.id].song=e.song,v.newGrabbedLevels[e.id].songOffset=e.songOffset,v.newGrabbedLevels[e.id].title=e.title,v.newGrabbedLevels[e.id].desc=e.desc,v.newGrabbedLevels[e.id].author=e.author,v.newGrabbedLevels[e.id].diff=e.diff,v.newGrabbedLevels[e.id].ranked=e.ranked,v.newGrabbedLevels[e.id].special=e.special):Xe.active}),o.on("newGrabbedUser",function(e){!1!==e.error&&(v.newGrabbedUsers[e.uuid]={uuid:e.uuid,user:e.user,pp:e.pp,joined:e.joined,country:e.country,bio:e.bio,online:e.online,statusScreen:e.statusScreen,contributor:e.contributor,performance:e.performance,rank:e.rank,patreon:e.patreon},v.newGUUnix[e.uuid]=w),Xe.active}),o.on("newGrabbedUserUsername",function(e){!1!==e.error&&(v.newGrabbedUsersUsername[e.user]={uuid:e.uuid,user:e.user,pp:e.pp,joined:e.joined,country:e.country,bio:e.bio,online:e.online},v.newGUUUnix[e.uuid]=w),Xe.active}),o.on("newGrabbedSong",function(e){!1!==e.error&&void 0===v.newGrabbedSongs[e.id]&&(v.newGrabbedSongs[e.id]={id:e.id,name:e.name,artist:e.artist,link:e.link,explicit:e.explicit}),Xe.active}),o.on("returnLevelSearch",function(e){Ht.search=[];for(var t=0;t<e.res.length;t++)Ht.search[t]=e.res[t].id}),o.on("returnSongSearch",function(e){O.search=[];for(var t=0;t<e.res.length;t++)O.search[t]=e.res[t].id}),o.on("returnUserSearch",function(e){Bt.online.searchedUsers=[];for(var t=0;t<e.res.length;t++)Bt.online.searchedUsers[t]=e.res[t].uuid}),o.on("newSignupUserFail",function(e){Bt.account.takenErrors[0]=!0}),o.on("newSignupEmailFail",function(e){Bt.account.takenErrors[1]=!0}),o.on("newSignupComplete",function(e){Bt.account.mode=!1,an()}),o.on("newLoginComplete",function(e){void 0!==e.session&&null!==e.session&&(window.localStorage.setItem("session",e.session),T.session=e.session),T.uuid=e.uuid}),o.on("newLoginCaptchaFail",function(e){Bt.account.takenErrors[5]=!0}),o.on("newLoginEmailFail",function(e){Bt.account.takenErrors[1]=!0}),o.on("newLoginPassFail",function(e){Bt.account.takenErrors[2]=!0}),o.on("requestPasswordFailed",function(e){Bt.account.takenErrors[0]=!0}),o.on("passwordCodeCreated",function(e){Bt.account.mode="haveCode"}),o.on("checkPasswordCodeFail",function(e){Bt.account.takenErrors[4]=!0}),o.on("checkPasswordCodeSuccess",function(e){Bt.account.mode="resetPasswordConf",Bt.account.codeUuid=e.uuid,Bt.account.errors=[],Bt.account.blankErrors=[],Bt.account.takenErrors=[]}),o.on("resetPasswordFail",function(e){Bt.account.takenErrors[2]=!0}),o.on("resetPasswordSuccess",function(e){Bt.account.resetPassComplete=!0,Bt.account.overlayOn=!1,Bt.account.user="",Bt.account.email="",Bt.account.pass="",Bt.account.passConf="",Bt.account.code="",Bt.account.codeUuid=""}),o.on("grabbedScores",function(e){var t;v.grabbedScoresTime=millis(),e.error?v.grabbedScoresLevel[e.a]=t="no scores":"user"===e.mode?(t=[],t=0===e.scores.length||void 0===e.scores?"no scores":e.scores,v.grabbedScoresUser[e.a]=t):"lvl"===e.mode&&(t=[],t=0===e.scores.length||void 0===e.scores?"no scores":e.scores,v.grabbedScoresLevel[e.a]=t)}),o.on("changeCountryComplete",function(e){v.newGrabbedUsers[T.uuid]=void 0,v.newGURequested[T.uuid]=void 0,v.newGURequestedT[T.uuid]=void 0,Bt.account.countryScreen=!1}),o.on("changeBioComplete",function(e){v.newGrabbedUsers[T.uuid]=void 0,v.newGURequested[T.uuid]=void 0,v.newGURequestedT[T.uuid]=void 0}),o.on("grabbedIncFriendReqs",function(e){v.grabbedIncFriendReqs[e.user]=e.reqs,v.grabbedIncFriendReqsT[e.user]=millis()}),o.on("grabbedOutFriendReqs",function(e){v.grabbedOutFriendReqs[e.user]=e.reqs,v.grabbedOutFriendReqsT[e.user]=millis()}),o.on("grabbedFriends",function(e){v.grabbedFriends[e.user]=e.reqs,v.grabbedFriendsT[e.user]=millis()}),o.on("sendLevelStarsOnline",function(e){v.newGrabbedLevels[e.id].stars=e.stars}),o.on("sendLevelStarsLocal",function(e){for(var t=-1,i=0;i<Ht.search.length+1;i++)if(i<Ht.search.length&&Ht.search[i].index===e.id){t=i;break}Ht.saved[e.id].stars=e.stars,Ht.search[t]=X(Ht.saved[e.id])}),o.on("returnUserPerf",function(e){v.newGrabbedUsers[e.user].performance=e.performance}),o.on("foundReplayByID",function(e){zo(e.scores,"id")}),o.on("levelUploadComplete",function(e){Rt=[],Rt=Ht.search,Ht.saved[Bt.lvl.uploadVar.a].id=e.id,Bt.lvl.uploading=!1,Bt.lvl.finishUploading=!1,Bt.lvl.searchSent=!1,Gn({type:"success",message:"menu_lvl_uploadComplete",keys:[e.title,Ut(e.author,"uuid").user,e.id]}),Do()}),window.addEventListener("message",e=>{e.data.client&&(We=e.data)},!1),setInterval(function(){Qn()},300),0<T.session.length&&0===T.uuid.length&&B("newSessionResume",{session:T.session}),setInterval(function(){var e=[],e="game"===He?!0===Tt.edit?["edit",0]:!0===Rt[Bt.lvl.sel].local?["game","local"]:["game",Rt[Bt.lvl.sel]]:[He,0];window.parent.postMessage({type:"rpc",screen:e,stars:0<e[1]?Bn(e[1]):null,author:0<e[1]?Ut(H(e[1],"id").author,"uuid").user:null,title:0<e[1]?H(e[1],"id").title:null,ranked:0<e[1]?H(e[1],"id").ranked:null,special:0<e[1]?H(e[1],"id").special:null,score:floor(Tt.scoreFinal),acc:Tt.acc,combo:Tt.combo,through:Tt.time<Tt.timeEnd?Tt.time/Tt.timeEnd:1},"*"),0<T.uuid.length&&B("setOnline",{user:T.uuid,screen:e,session:T.session})},3e3),et=!0}function as(t){loadStrings("/client/resources/lang"+(Se?"-staging":"")+"/"+t+String(ss).padStart(3,0)+".json",function(e){os(t,e)}),loadStrings("/client/resources/lang/countries/"+t+".json",function(e){os(t+"C",e)})}function preload(){"var"===nt?Ee=loadFont("/client/resources/font/Pulsus.otf"):(loadFont("/client/resources/font/Pulsus.otf"),Ee="Pulsus",ze=loadFont("/client/resources/font/Pulsus.otf")),Pe=loadFont("/client/resources/font/Pulsus-Bold.otf"),Oe=loadFont("/client/resources/font/Pulsus-Italic.otf"),St={bg:loadImage("/client/resources/img/bg.png"),menu:loadImage("/client/resources/img/settings.png"),play:loadImage("/client/resources/img/play.png"),stop:loadImage("/client/resources/img/stop.png"),objectBeat:loadImage("/client/resources/img/objectBeat.png"),objectHold:loadImage("/client/resources/img/objectHold.png"),objectHoldTime:loadImage("/client/resources/img/objectHoldTime.png"),defaultPP:loadImage("/client/resources/img/pp.png"),timelineSnap:loadImage("/client/resources/img/timelineSnap.png"),playbackHalf:loadImage("/client/resources/img/playbackHalf.png"),playbackFull:loadImage("/client/resources/img/playbackFull.png"),editorModeGameplay:loadImage("/client/resources/img/editorModeGameplay.png"),editorModeEffects:loadImage("/client/resources/img/editorModeEffects.png"),bookmark:loadImage("/client/resources/img/bookmark.png"),online:loadImage("/client/resources/img/online.png"),new:loadImage("/client/resources/img/new.png"),searchFor:loadImage("/client/resources/img/searchFor.png"),metronome:loadImage("/client/resources/img/metronome.png"),metronomeFlip:loadImage("/client/resources/img/metronomeFlip.png"),check:loadImage("/client/resources/img/check.png"),warning:loadImage("/client/resources/img/warning.png"),warningInvert:loadImage("/client/resources/img/warningInvert.png"),warningOrange:loadImage("/client/resources/img/warningOrange.png"),warningRed:loadImage("/client/resources/img/warningRed.png"),userOnline:loadImage("/client/resources/img/userOnline.png"),userOffline:loadImage("/client/resources/img/userOffline.png"),playInvert:loadImage("/client/resources/img/playInvert.png"),stopInvert:loadImage("/client/resources/img/stopInvert.png"),contributorBadge:loadImage("/client/resources/img/contributorBadge.png"),sort:loadImage("/client/resources/img/sort.png"),discordLogo:loadImage("/client/resources/img/discord.png"),discordLogoInvert:loadImage("/client/resources/img/discordInvert.png"),pulsusWiki:loadImage("/client/resources/img/pulsusWiki.png"),clickModeScroll:loadImage("/client/resources/img/clickModeScroll.png"),clickModeSelect:loadImage("/client/resources/img/clickModeSelect.png"),explicit:loadImage("/client/resources/img/explicit.png"),arrow:loadImage("/client/resources/img/arrow.png"),timelineBPM:loadImage("/client/resources/img/timelineBPM.png"),timelineOffset:loadImage("/client/resources/img/timelineOffset.png"),paste:loadImage("/client/resources/img/paste.png"),ranked:loadImage("/client/resources/img/ranked.png"),refresh:loadImage("/client/resources/img/refresh.png"),refreshInvert:loadImage("/client/resources/img/refreshInvert.png"),platinumBadge:loadImage("/client/resources/img/platinumBadge.png"),patreonLogo:loadImage("/client/resources/img/patreonLogo.png"),patreonLogoInvert:loadImage("/client/resources/img/patreonLogoInvert.png"),platinum:loadImage("/client/resources/img/platinum.png"),beatColor:loadImage("/client/resources/img/beatColor.png"),beatTransitionIn:loadImage("/client/resources/img/beatTransitionIn.png"),beatTransitionOut:loadImage("/client/resources/img/beatTransitionOut.png"),timelineTools:loadImage("/client/resources/img/timelineTools.png"),select:loadImage("/client/resources/img/select.png"),vignette:loadImage("/client/resources/img/vignette.png"),jumpToTimestamp:loadImage("/client/resources/img/jumpToTimestamp.png"),diff:{full:[]},logo:loadImage("/client/resources/img/logo.png"),loading:loadImage("/client/resources/img/loading.png"),replay:loadImage("/client/resources/img/replay.png"),replayInvert:loadImage("/client/resources/img/replayInvert.png"),song:loadImage("/client/resources/img/song.png"),leaderboard:loadImage("/client/resources/img/leaderboard.png"),account:loadImage("/client/resources/img/account.png"),createLevel:loadImage("/client/resources/img/createLevel.png"),upload:loadImage("/client/resources/img/upload.png"),edit:loadImage("/client/resources/img/edit.png")}}function setup(){ae=text,le=fill,de=stroke,ge=color,ce=hue,fe=saturation,ue=brightness,ve=alpha,me=constrain,pe=textStyle,be=textWidth,we=push,Ce=pop,ye=translate,"var"===nt&&(textStyle=function(e){switch(e){case"normal":ot="normal",textFont(Ee);break;case"bold":ot="bold",textFont(Pe);break;case"italic":ot="italic",textFont(Oe)}}),text=function(t,e,i,o,n){if(t=String(t),"center"===textAlign().vertical){let e;void 0!==t?((e=t.split("\n")).splice(0,1),e.join("\n")):e="",i+=textSize()/12*("var"===nt?-1:1)}else"bottom"===textAlign().vertical?i+=textSize()/4.5:"top"===textAlign().vertical&&(i-=textSize()/22);void 0!==o&&void 0!==n?ae(t,e,i,o,n):ae(t,e,i)},fill=function(e,t,i,o){null!=e&&(void 0!==e.mode&&void 0!==e.maxes&&void 0!==e._array&&void 0!==e.levels||"hsb"===colorMode()._colorMode&&(e=e/255*360,void 0!==t&&void 0!==i?(t=t/255*100,i=i/255*100):void 0!==t&&(t/=255),void 0!==o)&&(o/=255),void 0!==e.mode&&void 0!==e.maxes&&void 0!==e._array&&void 0!==e.levels&&void 0!==t?(colorMode(RGB),le(e.levels[0],e.levels[1],e.levels[2],t),colorMode(e.mode)):void 0!==o?le(e,t,i,o):void 0!==i?le(e,t,i):void 0!==t?le(e,t):le(e))},stroke=function(e,t,i,o){void 0!==e.mode&&void 0!==e.maxes&&void 0!==e._array&&void 0!==e.levels||"hsb"===colorMode()._colorMode&&(e=e/255*360,void 0!==t&&void 0!==i?(t=t/255*100,i=i/255*100):void 0!==t&&(t/=255),void 0!==o)&&(o/=255),void 0!==e.mode&&void 0!==e.maxes&&void 0!==e._array&&void 0!==e.levels&&void 0!==t?(colorMode(RGB),de(e.levels[0],e.levels[1],e.levels[2],t),colorMode(e.mode)):void 0!==o?de(e,t,i,o):void 0!==i?de(e,t,i):void 0!==t?de(e,t):de(e)},color=function(e,t,i,o){return"hsb"===colorMode()._colorMode&&(e=e/255*360,void 0!==t&&void 0!==i?(t=t/255*100,i=i/255*100):void 0!==t&&(t/=255),void 0!==o)&&(o/=255),void 0!==o?ge(e,t,i,o):void 0!==i?ge(e,t,i):void 0!==t?ge(e,t):ge(e)},hue=function(e){return ce(e)/360*255},saturation=function(e){var t;return"hsb"===e.mode?255*e.hsba[1]:"rgb"===e.mode?(t=e.levels[0]<e.levels[1]?e.levels[0]<e.levels[2]?e.levels[0]:e.levels[2]:e.levels[1]<e.levels[2]?e.levels[1]:e.levels[2],0===(e=e.levels[0]>e.levels[1]?e.levels[0]>e.levels[2]?e.levels[0]:e.levels[2]:e.levels[1]>e.levels[2]?e.levels[1]:e.levels[2])?0:(e-t)/e*255):void 0},brightness=function(e){return ue(e)/100*255},alpha=function(e){return"hsb"===colorMode()._colorMode?255*+ve(e):ve(e)/255*255},constrain=function(e,t,i){return i<t?i:me(e,t,i)},textWidth=function(e){e=String(e).split("\n");for(var t=be(e[0]),i=1;i<e.length;i++){var o=be(e[i]);t<o&&(t=o)}return t},zt=new pt,pop=function(){zt.data.pop(),Ce()},push=function(){zt.data.push(mt()),we()},translate=function(e,t){zt.data[zt.data.length-1].x+=e,zt.data[zt.data.length-1].y+=t,ye(e,t)},Y=createCanvas(1920,1080),angleMode(DEGREES),Y.mouseOut(function(){Te=!(Be=!0)}),Y.mouseOver(function(){Te=!(Be=!1)}),w=Math.round((new Date).getTime()/1e3),textFont(Ee);for(var e=0;e<ns.length;e++)rs[ns[e]]=!1,rs[ns[e]+"C"]=!1;loadStrings("/client/resources/txt/changelog003.txt",function(e){l=JSON.parse(e.join("")).text,os("changelogParsed")});for(var t,e=0;e<ns.length;e++)as(ns[e]);if(0<(Bo=null!==JSON.parse(localStorage.getItem("pulsusGammaLvl"))?JSON.parse(localStorage.getItem("pulsusGammaLvl")):Bo).length){for(e=0;e<Bo.length;e++)Ht.saved.push({local:!0,id:Bo[e].id,beat:Bo[e].beat,bpm:Bo[e].bpm,ar:Bo[e].ar,hpD:Bo[e].hpD,effects:Bo[e].effects,song:Bo[e].song,bg:Bo[e].bg,songOffset:Bo[e].songOffset,title:Bo[e].title,desc:Bo[e].desc,author:Bo[e].author}),Ht.scores.push(Bo[e].score);T.session=localStorage.removeItem("pulsusGammaLvl")}if(null!==JSON.parse(localStorage.getItem("pulsusGammaNewLvl"))&&(Ht.saved=JSON.parse(localStorage.getItem("pulsusGammaNewLvl"))),null!==JSON.parse(localStorage.getItem("pulsusGammaLvlScores"))&&(Ht.scores=JSON.parse(localStorage.getItem("pulsusGammaLvlScores"))),null!==JSON.parse(localStorage.getItem("pulsusGammaLvlOnlineScores"))&&(Ht.onlineScores=JSON.parse(localStorage.getItem("pulsusGammaLvlOnlineScores"))),null!==JSON.parse(localStorage.getItem("pulsusGammaSongBookmarks"))&&(O.saved=JSON.parse(localStorage.getItem("pulsusGammaSongBookmarks"))),null!==JSON.parse(localStorage.getItem("pulsusGammaLocalOffsets"))&&(Ht.localOffsets=JSON.parse(localStorage.getItem("pulsusGammaLocalOffsets"))),null!==JSON.parse(localStorage.getItem("pulsusGammaOnlineOffsets"))&&(Ht.onlineOffsets=JSON.parse(localStorage.getItem("pulsusGammaOnlineOffsets"))),null!==localStorage.getItem("session")&&(T.session=localStorage.getItem("session")),null!==To){var i="number"!=typeof To.noteEdgeOpacity;for(const o in Bt.settings)t=o,null!==To[t]&&void 0!==To[t]&&(Bt.settings[t]=To[t]);i&&(Bt.settings.fpsLimit="vsync")}(settingsFileInput=createFileInput(re.submit)).hide(),bt(ht)}function draw(){et&&!tt&&(noLoop(),gs(),tt=!0)}const ls=1e-6;function ds(e){for(const o of Tt.selectedBeats){const n=Tt.beat[o],s=e[n[0]];var t;if(Tt.beat.some((e,t)=>s===e[0]&&Math.abs(n[1]-e[1])<=ls&&!Tt.selectedBeats.includes(t)&&o!=t))return t=Tt.keyDisplay[Bt.settings.language],void Gn({type:"error",message:"transform_collision_error",keys:[Tt.timelineTickFor(n[1]),t[n[0]],t[s]]})}for(const r of Tt.selectedBeats){var i=Tt.beat[r];i[0]=e[i[0]]}}function gs(){bs(),"click"===He&&ws(),"welcome"===He&&Cs(),"menu"===He&&(ps(),c()),"game"===He&&cs(),"hidden"!==Ne&&(rectMode(CORNER),fill(255),rect(0,-height+height*u.screenY,width,height),push(),translate(width/2,-height+height*u.boxY+height/2),rectMode(CENTER),fill(0),rotate(u.boxR+u.theta),rect(0,0,height<width?height/4:width/4,height<width?height/4:width/4),pop()),!0===Ne&&(Bt.loopVol+=At(0,Bt.loopVol,.2),soundManager.setVolume("menuMusic",Bt.loopVol),u.screenY+=At(1,u.screenY,.2),millis()<u.dropTime+500?(u.boxY=Bi(millis()-u.dropTime,millis()-u.dropTime,0,1,499),u.theta=fi(millis()-u.dropTime,millis()-u.dropTime,0,112.5,499)):(u.boxY=1,"game"===Re?(rectMode(CENTER),fill(0,100),strokeWeight(height/32),stroke(0,100),line(width/2-width/8,height/4*3,width/2+width/8,height/4*3),textAlign(CENTER,CENTER),noStroke(),Dt(Pt("menu_lvl_cancelLoading",xt),width/2,height/4*3+2*kt,width,height/32,ITALIC),Dt((h=Jt("tips_array",xt))[Math.floor(performance.now()/5e3)%h.length],width/2,height/4*3+2*kt+height/32,width,height/32,ITALIC),void 0===Rt[Bt.lvl.sel]||void 0===m(Rt[Bt.lvl.sel],"id").beat&&!0!==Rt[Bt.lvl.sel].local||"Metadata"===m(Rt[Bt.lvl.sel],"id").beat&&!0!==Rt[Bt.lvl.sel].local||(0===Tt.song&&qi(Bt.lvl.sel,"",!0),void 0!==Qt[Tt.song]&&(rectMode(CORNER),strokeWeight(height/32),stroke(0),line(width/2-width/8,height/4*3,width/2-width/8+width/4*(Qt[Tt.song].progress()/100),height/4*3)),noStroke(),ei?(Tt.loaded=!0,u.boxR=u.boxR+u.theta,u.boxR=u.boxR%360):ho(Tt.song),Le&&(Re="menu",Tt.replay.on)&&(Tt.replay.on=!1,Yn(Tt.replay.preMods)))):u.finished=!0),u.boxR+=.25,"game"===Re)&&!0===Tt.loaded&&(Ne="hidden",He="game",Tt.loaded=!1),!0===u.finished&&("menu"===Re?(to(),He=Re,Re=null,Bt.lvl.loading=!1):null!==Re&&(He=Re),Ne="hidden",u.finishFade+=At(1,u.finishFade,.05),push(),translate(width/2,-height+height*u.boxY+height/2),rectMode(CENTER),rotate(u.boxR+u.theta+67.5*u.finishFade),push(),noFill(),stroke(0,255),strokeWeight((height<width?height/4:width/4)*(1-1.5*u.finishFade)),scale(12*u.finishFade),rect(0,0,height<width?height/4:width/4,height<width?height/4:width/4),pop(),push(),noFill(),stroke(255,255),strokeWeight(2*width),scale(12*u.finishFade),rect(0,0,(height<width?height/4:width/4)+2*width,(height<width?height/4:width/4)+2*width),pop(),pop()),lt=[];for(var e=0;e<at.length;e++){var t=at[e];if(t.time<=millis()-5e3){if(t.x+=At(width+kt,t.x,.1),t.x>=width){at.splice(e,1),e--;continue}}else t.x+=At(width-(width/5+kt),t.x,.2);t.y+=At(height-(height/8+kt)*(at.length-e),t.y,.2);var i=width/5,o=height/8,n=kt/2*(t.headerHover+1),s=n/2/2/1.5,r=(push(),translate(t.x,t.y),translate(i/2,o/2),rectMode(CENTER),push(),translate(cos(30)*kt,sin(30)*kt),fill(0,100),rect(0,0,i,o,kt/2),pop(),fill(255),rect(0,0,i,o,kt/2),lt.push({hitbox:Ft("rcenter",zt.get().x,zt.get().y,i,o),item:at[e],event:function(e){dt=!0}}),color(255,0,0));switch(t.type){case"error":r=color(255,0,0);break;case"success":r=color(0,175,0)}Ft("rcenter",zt.get().x,zt.get().y-o/2+kt/4,i,n)?t.headerHover+=At(1,t.headerHover,.2):t.headerHover+=At(0,t.headerHover,.2),fill(r),rect(0,-o/2+n/2,i,n,kt/2,kt/2,0,0),push(),translate(i/2-(n-s)/2,-o/2+n/2),stroke(255),strokeWeight(n/16),line(-s,-s,s,s),line(-s,s,s,-s),lt.push({hitbox:Ft("rcorner",zt.get().x-n/2,zt.get().y-n/2,n,n),item:at[e],event:function(e){e.time=-1e4}}),pop(),fill(0),noStroke(),textSize(kt/1.75),textAlign(LEFT,TOP),text(Pt(t.message,xt,t.keys[0],t.keys[1],t.keys[2],t.keys[3]),.25*kt,kt+n/2+(height-o)/2,i-kt,height),pop()}!1!==$t&&!0!==Ne&&(push(),rectMode(CORNER),h=height/28,fill(255,0),textAlign(LEFT,TOP),Dt($t,mouseX,mouseY-h,width,h/1.5),d=textWidth($t)+h/2,kt=Math.min(width,height)/64,translate(0,Math.max(mouseY-h,kt)),noStroke(),fill(0,200),rect(constrain(mouseX-(mouseX+d>width?d:0),0,width),0,d,h,h),fill(255),textAlign(CENTER,CENTER),text($t,constrain(mouseX-(mouseX+d>width?d:0),0,width)+d/2,h/2),$t=!1,pop()),f&&(Qe=!Qe,f=!1),g.active?g.fade+=At(1,g.fade,.15):g.fade+=At(0,g.fade,.15),push(),noStroke(),translate(0,height-height*constrain(g.fade,0,.5)*2),rectMode(CORNER),fill($.main,2*constrain(g.fade,0,.5)*200),rect(0,0,width,height),pop(),push(),translate(0,height-height*constrain(g.fade,0,1)),translate(0,Ot(height/16)),textAlign(CENTER,CENTER),textStyle(BOLD),fill(255),Dt(Pt(g.title,xt),width/2,height/16/2,width/4*1.5,height/16*2),Ot(red(g.currentColor))!==Ot(g.red)||Ot(green(g.currentColor))!==Ot(g.green)||Ot(blue(g.currentColor))!==Ot(g.blue)?(colorMode(RGB),g.currentColor=color(Ot(g.red),Ot(g.green),Ot(g.blue),Ot(g.alpha)),g.hue=Ot(hue(g.currentColor)),g.saturation=Ot(saturation(g.currentColor)),g.brightness=Ot(brightness(g.currentColor)),g.hex=wt(Ot(g.red),Ot(g.green),Ot(g.blue),Ot(g.alpha))):Ot(hue(g.currentColor))!==Ot(g.hue)||Ot(saturation(g.currentColor))!==Ot(g.saturation)||Ot(brightness(g.currentColor))!==Ot(g.brightness)?(colorMode(HSB),g.currentColor=color(Ot(g.hue),Ot(g.saturation),Ot(g.brightness),Ot(g.alpha)),g.red=Ot(red(g.currentColor)),g.green=Ot(green(g.currentColor)),g.blue=Ot(blue(g.currentColor)),g.hex=wt(Ot(g.red),Ot(g.green),Ot(g.blue),Ot(g.alpha))):Ot(alpha(g.currentColor))!==Ot(g.alpha)&&(colorMode(RGB),g.currentColor=color(Ot(g.red),Ot(g.green),Ot(g.blue),Ot(g.alpha)),g.hex=wt(Ot(g.red),Ot(g.green),Ot(g.blue),Ot(g.alpha))),g.hsbNSM.draw({x:width/16,y:height/12*3,width:width/4,height:height,stacked:!0,maxBarHeight:height/12,buffer:(height-height/16)/64,hideHeaders:!0,hideHints:!0,hideHighlights:!0}),g.rgbNSM.draw({x:width/16*2+width/4,y:0,width:width/4,height:height,stacked:!0,maxBarHeight:height/12,buffer:(height-height/16)/64,hideHeaders:!0,hideHints:!0,hideHighlights:!0}),push();var h,a,l,d=height/12*3;translate(width/16+width/4/2,height/8+height/12),rectMode(CENTER),fill(255),rect(0,0,d+kt,d+kt),imageMode(CENTER),image(ht.hsbGrid,0,0,d,d),mouseIsPressed&&Ft("rcenter",zt.get().x,zt.get().y,d+kt,d+kt)&&g.active&&(g.hue=constrain(Ot((mouseX-zt.get().x+d/2)/d*255),0,255),g.saturation=constrain(Ot((mouseY-zt.get().y+d/2)/d*255),0,255)),push(),translate(-d/2,-d/2),translate(d*(g.hue/255),d*(g.saturation/255)),colorMode(HSB),fill(g.hue,g.saturation,255),stroke(0),strokeWeight(d/128),ellipseMode(CENTER),ellipse(0,0,d/16,d/16),pop(),pop(),push(),translate(width/16*3+width/4*2,0),push(),rectMode(CORNER),noStroke(),translate(0,Ot(height/16*2)),fill(g.currentColor),rect(0,Ot(height/12*2),width/4,Ot(height/12*2)),g.old.multiple?g.old.mode===HSB?(colorMode(HSB),fill(te(g.old.hues[0]),te(g.old.saturations[0]),te(g.old.brightnesses[0]),!1===g.old.alphas?255:te(g.old.alphas[0]))):(g.old.mode,RGB):g.old.mode===HSB?(colorMode(HSB),fill(te(g.old.hue),te(g.old.saturation),te(g.old.brightness),!1===g.old.alpha?255:te(g.old.alpha))):g.old.mode===RGB&&(colorMode(RGB),fill(te(g.old.red),te(g.old.green),te(g.old.blue),!1===g.old.alpha?255:te(g.old.alpha))),rect(0,0,width/4,Ot(height/12*2)),pop(),push(),translate(width/4/2,3*Ot(height/12*2)),textStyle(NORMAL),Kt(-width/4/2,0,width/4,4*kt,Pt("submit",xt),g.buttonHover,1),Kt(-width/4/2,Ot(height/12*2),width/4,4*kt,Pt("cancel",xt),g.buttonHover,0),pop(),pop(),pop(),push(),translate(0,height-height*constrain(g.fade,0,1)*1),resetMatrix(),translate(0,height-height*constrain(g.fade,0,1)*1),textStyle(NORMAL),pop(),Nt.active?(I&&(Nt.anchor=0,Nt.cursor=Nt.inp.length,I=!1),l=Nt.anchor<Nt.cursor?Nt.anchor:Nt.cursor,a=Nt.anchor>Nt.cursor?Nt.anchor:Nt.cursor,(R||k)&&(0<Nt.cursor||!1!==Nt.anchor)&&Xn(),!(k=R=!1)===Le&&(ki("cancel"),Le=!1),jt&&(xo(),jt=!1),Zt&&(0<a-l&&!1!==Nt.anchor&&So(Nt.inp.substr(l,a-l)),Zt=!1),A&&(0<a-l&&!1!==Nt.anchor&&So(Nt.inp.substr(l,a-l)),Xn(),A=!1),Nt.fade+=At(1,Nt.fade,.15)):Nt.fade+=At(0,Nt.fade,.15),push(),noStroke(),translate(0,height-height*constrain(Nt.fade,0,.5)*2),rectMode(CORNER),fill($.main,2*constrain(Nt.fade,0,.5)*200),rect(0,0,width,height),resetMatrix(),translate(0,height-height*constrain(Nt.fade,0,1)*1),Wi(Nt.inp,"",Pt(Nt.title,xt),4*kt,height/2-2*kt,width-8*kt,2*kt,Nt.password?"password":""),push(),Nt.cursor=constrain(Nt.cursor,0,Nt.inp.length),Nt.inp.length<200&&translate(kt/2+(Nt.cursor===Nt.inp.length?kt/8:0)+textWidth(Nt.inp.substr(0,Nt.cursor)),0),fill(255,abs(500-millis()%1e3)/500*255),rect(4*kt,height/2-2*kt+.75*kt/2,kt/16,1.25*kt),pop(),!1!==Nt.anchor&&(fill(255,50),translate(kt/2+textWidth(Nt.inp.substr(0,l)),0),rect(4*kt,height/2-2*kt+.75*kt/2,textWidth(Nt.inp.substr(l,a-l)),1.25*kt)),resetMatrix(),translate(0,height-height*constrain(Nt.fade,0,1)*1),textStyle(NORMAL),Kt(8*kt,height/2+2*kt,20*kt,4*kt,Pt("cancel",xt),Nt.buttonHover,0),Kt(width-8*kt-20*kt,height/2+2*kt,20*kt,4*kt,Pt("submit",xt),Nt.buttonHover,1),pop(),_o.render(),Bt.settings.debugOverlay&&(push(),h=Math.min(width,height)/64,d=mouseX>width-12*h&&mouseY>height-12*h?1:0,Bt.fpsHoverTrans+=At(d,Bt.fpsHoverTrans,.2),drawingContext.globalAlpha=lerp(200,20,Bt.fpsHoverTrans)/255,noStroke(),rectMode(CORNER),fill($.buttonUp,255),rect(width-5*h,height-3*h,4*h,2*h),textAlign(CENTER,CENTER),fill($.buttonText),$e="",Dt(Fe.dis.toFixed(0),width-3*h,height-2*h,4*h/1.5,2*h/1.5),pop()),(Bt.settings.debugOverlay||"click"===He||"welcome"===He||"menu"===He&&"logo"===Bt.screen)&&(push(),a=Math.min(width,height)/64,l=mouseX<12*a&&mouseY>height-12*a?1:0,Bt.versionInfoHoverTrans+=At(l,Bt.versionInfoHoverTrans,.2),drawingContext.globalAlpha=lerp(200,20,Bt.versionInfoHoverTrans)/255,fill($.text,255),textSize(a),textAlign(LEFT,BOTTOM),$e="",d="γ0.28.15.2"+(Se?"-staging":""),We.client&&(d=d+"-"+We.version),"game"!==He&&text(d+"\nTetroGem 2024",a,height-a),pop()),Se&&(fill(255,0,0),text(v.queueType,height/64,height-height/64*3)),Le=!1,pmouseY=mouseY,pmouseX=mouseX,"vsync"===Bt.settings.fpsLimit&&requestAnimationFrame(()=>gs())}function cs(){var e,t;0===Tt.disMode?cs.transitionFromMenu():1!==Tt.disMode&&2!==Tt.disMode&&3!==Tt.disMode||(cs.touchscreen(),Tt.ar=Tt.arInit+Tt.bpm/60/2*constrain(Tt.effected.ar,-Tt.oldAr,9999),cs.musicTime(),Tt.edit&&cs.updateEditor(),cs.parseEffects(),Tt.next=[],colorMode(HSB),t=[],e=cs.sortBeats(Tt.beat,Tt.edit),t=cs.scanBeats(e).drawableBeats,Tt.edit||cs.updateGameplay(),cs.updateAll(),(0<=millis()-Tt.lastDraw||Tt.edit)&&cs.field.draw(t),cs.paused(),1!==Tt.disMode&&cs.resultsScreen()),!0===Tt.retry&&cs.retry()}function fs(){}mouseClicked=function(){var e,t,i,o,n,s;width>height?width:height;_o.active?(e=width/2,t=height/2,Ft("rcorner",e+-(i=width/2)/2+i/3-(n=i/4)/2,t+(s=(o=height/2)/4)-s/2,n,s)?(_o.buttons[0]/=4,_o.active=!1,_o.spiral=!0,_o.callback()):Ft("rcorner",e+-i/2+i/3*2-n/2,t+o/4-s/2,n,s)&&(_o.buttons[1]/=4,_o.active=!1)):Nt.active?fs.prmpting():g.active?fs.prmptingColor():(dt=!1,fs.notifications(lt),dt||fs.screens())},mouseReleased=function(){mouseIsPressed=!1,Bt.lvl.scrollNewLock=!1},cs.field={},cs.field.draw=function(A){var e=Tt.bpmNew();Tt.lastDraw=millis(),background(0,0,0,255),imageMode(CORNER),Wt(0<Bt.settings.defaultBackground.length?_t(Bt.settings.defaultBackground):St.bg,"zoom",0,0,width,height),!1!==Tt.bg&&"https://i.imgur.com/pUovCs5.png"!==Tt.bg&&""!==Tt.bg&&Wt(_t(Tt.bg),"zoom",(width-(width/1920>height/1080?1920/1080*height:width))/2,(height-(width/1920>height/1080?height:.5625*width))/2,width/1920>height/1080?1920/1080*height:width,width/1920>height/1080?height:.5625*width),colorMode(HSB),fill(Tt.effected.backgroundOverlayColor,Tt.effected.backgroundOverlaySaturation,Tt.effected.backgroundOverlayBrightness,Tt.effected.backgroundOverlayAlpha),noStroke(),rect(0,0,width,height),colorMode(RGB),fill(0,Bt.settings.bgDim/100*255),rectMode(CORNER),rect(0,0,width,height),rectMode(CORNER),fill(255,Tt.transBackA),rect(0,0,width,height),colorMode(HSB);for(var t=A.length-1;0<=t;t--){var i=A[t],o=(push(),0),n=0,F=0,D=width,X=0,W=height,s=(width/1920>height/1080?(o=1920/1080*height/240,n=height/135,F=(width-1920/1080*height)/2,D=width-(width-1920/1080*height)/2):(o=width/240,n=.5625*width/135,X=(height-.5625*width)/2,W=height-(height-.5625*width)/2),Tt.board.str*(Tt.board.c/64)*(Tt.board.h<Tt.board.w?Tt.board.h/.75:Tt.board.w/.75)/2),r=0,h=0,U=0,a=0,L=Tt.effected.tileH[Tt.beat[i][0]],l=Tt.effected.tileW[Tt.beat[i][0]],d=ceil(Tt.board.h*Tt.board.c/4*L+(s<s*L?s/2*L:-s/2*L))+2.5,g=ceil(Tt.board.w*Tt.board.c/4*l+(s<s*l?s/2*l:-s/2*l))+2.5,c=(Tt.board.w,Tt.board.c,Tt.board.w,Tt.board.c,1),f=1,u=1,v=1,K=1,V=1,M=0,q=0,m=1,p=1,b=0,Z=0,j=!1,r=Tt.board.w*Tt.board.c*3/8*(Tt.beat[i][0]%3-1)+width/2+Tt.effected.tileX[Tt.beat[i][0]]*o,h=Tt.board.h*Tt.board.c*3/8*(floor(Tt.beat[i][0]/3)-1)+height/2+Tt.effected.tileY[Tt.beat[i][0]]*n,U=Tt.board.w*Tt.board.c*3/8*(Tt.beat[i][0]%3-1)+width/2+Tt.effected.tileX[Tt.beat[i][0]]*o,a=Tt.board.h*Tt.board.c*3/8*(floor(Tt.beat[i][0]/3)-1)+height/2+Tt.effected.tileY[Tt.beat[i][0]]*n,c=1,f=1,u=1,v=1;switch(Z=Tt.time<Tt.beat[i][1]?0:1===Tt.beat[i][5]&&Tt.time<Tt.beat[i][1]+Tt.beat[i][6]?1:2){default:b=1-(Tt.beat[i][1]-Tt.time)/Tt.ar;break;case 1:b=1-(Tt.beat[i][1]+Tt.beat[i][6]-Tt.time)/Tt.beat[i][6];break;case 2:b=(Tt.time-(Tt.beat[i][1]+(1===Tt.beat[i][5]?Tt.beat[i][6]:0)))/Tt.ar}switch(Z){default:switch(Tt.beat[i][13]){default:u=c=0,v=f=1;break;case 1:h=X-d/2,m=0,p=8;break;case 7:r=Tt.board.w*Tt.board.c*3/8*(u=c=0)+width/2+Tt.effected.tileX[4]*o,h=Tt.board.h*Tt.board.c*3/8*(floor(4/3)-1)+height/2+Tt.effected.tileY[4]*n;break;case 3:K=0;break;case 4:h=W+d/2,m=0,p=8;break;case 5:r=F-g/2,m=0,p=8;break;case 6:r=D+g/2,m=0,p=8;break;case 2:u=c=0,r=width/2,h=height/2;break;case 8:u=c=0,r-=g/2,h-=d/2;break;case 9:u=c=0,r+=g/2,h-=d/2;break;case 10:u=c=0,r-=g/2,h+=d/2;break;case 11:u=c=0,r+=g/2,h+=d/2;break;case 12:c=0;break;case 13:u=0;break;case 14:u=c=0,M=-82.5;break;case 15:j=!0,v=f=0}case 1:break;case 2:switch(Tt.beat[i][14]){default:v=f=0;break;case 1:a=lerp(X-d/2,h,2),m=8,p=0;break;case 7:U=lerp(Tt.board.w*Tt.board.c*3/8*0+width/2+Tt.effected.tileX[4]*o,r,2),a=lerp(Tt.board.h*Tt.board.c*3/8*(floor(4/3)-1)+height/2+Tt.effected.tileY[4]*n,h,2),v=f=2,m=8,p=0;break;case 3:K=1,V=0;break;case 4:a=lerp(W+d/2,h,2),m=8,p=0;break;case 5:U=lerp(F-g/2,r,2),m=8,p=0;break;case 6:U=lerp(D+g/2,r,2),m=8,p=0;break;case 2:v=f=2,U=lerp(width/2,r,2),a=lerp(height/2,h,2);break;case 8:v=f=0,U-=g/2,a-=d/2;break;case 9:v=f=0,U+=g/2,a-=d/2;break;case 10:v=f=0,U-=g/2,a+=d/2;break;case 11:v=f=0,U+=g/2,a+=d/2;break;case 12:f=0;break;case 13:v=0;break;case 14:v=f=0,q=82.5}}noStroke();var w=color(Tt.beat[i][11],void 0===Tt.beat[i][16]?255:Tt.beat[i][16],void 0===Tt.beat[i][17]?255:Tt.beat[i][17]),G=lerp(75,255,Bt.settings.noteEdgeOpacity/100)*Tt.effected.boardA*Tt.effected.tileA[Tt.beat[i][0]],Y=lerp(0,255,Bt.settings.holdProgressOpacity/100)*Tt.effected.boardA*Tt.effected.tileA[Tt.beat[i][0]],J=lerp(0,255,Bt.settings.notePaneOpacity/100)*Tt.effected.boardA*Tt.effected.tileA[Tt.beat[i][0]],_=(rectMode(CENTER),ellipseMode(CENTER),1),L=(Tt.mods.hidden&&(1===Tt.beat[i][5]?1!==Z&&2!==Z||(_=1-constrain((Tt.time-Tt.beat[i][1])/(Tt.beat[i][6]/3*2),0,1)):_=constrain((Tt.beat[i][1]-Tt.time-Tt.ar/3)/(Tt.ar/3*2),0,1)),-1!==Tt.selectedBeats.indexOf(i)&&(colorMode(RGB),stroke(255,175,0,(175-Bt.settings.noteEdgeOpacity)*(Tt.mods.hidden?abs((Tt.beat[i][1]-Tt.time)/Tt.ar):1)),strokeWeight(kt/2),colorMode(HSB)),translate(width/2,height/2),translate(Tt.effected.boardX*o,Tt.effected.boardY*n),scale(Tt.effected.boardW,Tt.effected.boardH),rotate(Tt.effected.boardR),translate(-width/2,-height/2),translate(0===lerp(h,a,b)?0:lerp(r,U,b),lerp(h,a,b)),j||scale(0===lerp(u,v,b)?0:lerp(c,f,b),lerp(u,v,b)),rotate(lerp(M,q,b)),rotate(Tt.effected.tileR[Tt.beat[i][0]]),scale(1-Tt.tilePressDis[Tt.beat[i][0]]*(Bt.settings.tilePush/10*.15)),1-constrain((Tt.time-Tt.beat[i][8]-Tt.beat[i][1])/Tt.beat[i][6],0,1)),$=1===Tt.beat[i][5]?constrain((Tt.edit?Tt.time-Tt.beat[i][1]:Tt.beat[i][8])/Tt.beat[i][6],0,Tt.edit?1:L):0,s=1!==Z?lerp(c,f,b)/(f<c?c:f):1,l=floor(width<height?width:height)/64/s,L=lerp(Bt.settings.holdThickness,Bt.settings.holdProgressThickness,_);beatBorderWidth=lerp(.375*l,6*l,(Bt.settings.beatThickness-1)/9),holdBorderWidth=lerp(.375*l,6*l,(Bt.settings.holdThickness-1)/9),progBorderWidth=lerp(.375*l,6*l,(L-1)/9);var C,ee,te,s=(s=(g<d?g-beatBorderWidth:d-beatBorderWidth)/beatBorderWidth)<0?1+s:1,l=(l=(g<d?g-holdBorderWidth:d-holdBorderWidth)/holdBorderWidth)<0?1+l:1,L=(L=(g<d?g-progBorderWidth:d-progBorderWidth)/progBorderWidth)<0?1+L:1,ie=s*beatBorderWidth,oe=holdBorderWidth*l,ne=progBorderWidth*L;switch(Tt.beat[i][5]){default:!0!==j?(strokeWeight(ie),rectMode(CENTER),C=g-beatBorderWidth<=1?1:g-beatBorderWidth,ee=d-beatBorderWidth<=1?1:d-beatBorderWidth,fill(w,J*_*lerp(K,V,b)*constrain(lerp(m,p,b),0,1)),noStroke(),rect(0,0,Math.max(C-ie,0),Math.max(ee-ie,0)),noFill(),stroke(w,G*_*lerp(K,V,b)*constrain(lerp(m,p,b),0,1)),rect(0,0,C,ee),-1!==Tt.selectedBeats.indexOf(i)&&(stroke(29,255,255),rect(0,0,(g-beatBorderWidth<=1?1:g-beatBorderWidth)+ie,(d-beatBorderWidth<=1?1:d-beatBorderWidth)+ie))):(C=createGraphics(Ot(g),Ot(d),P2D),ee=lerp(c,f,b)*g,se=lerp(u,v,b)*d,0,y=ceil((Ot(g)-ee)/2),re=ceil((Ot(d)-se)/2),te=G*lerp(K,V,b)*constrain(lerp(m,p,b),0,1),C.rectMode(CORNER),C.fill((Tt.beat[i][11]-lerp(3,0,b))%255,255,255,te),C.rect(0,0,y,Ot(d)-re),C.fill((Tt.beat[i][11]-lerp(1,0,b))%255,255,255,te),C.rect(0+y,0,Ot(g)-y,re),C.fill((Tt.beat[i][11]+lerp(1,0,b))%255,255,255,te),C.rect(0+y+ee,0+re,y,Ot(d)-re),C.fill((Tt.beat[i][11]+lerp(3,0,b))%255,255,255,te),C.rect(0,0+re+se,Ot(g)-y,re),image(C,-g/2,-d/2));break;case 1:{strokeWeight(oe),noFill(),rotate(Bt.settings.holdAngle),scale(1===Bt.settings.holdDirection?-1:1,1);const te=G*lerp(K,V,b)*constrain(lerp(m,p,b),0,1);var se=Y*lerp(K,V,b)*constrain(lerp(m,p,b),0,1),y=lerp(te,se,_),re=J*lerp(K,V,b)*constrain(lerp(m,p,b),0,1);let e=(Tt.time-Tt.beat[i][1])/Tt.beat[i][6];var he=g-holdBorderWidth<=1?1:g-holdBorderWidth,ae=d-holdBorderWidth<=1?1:d-holdBorderWidth,le=g-progBorderWidth<=1?1:g-progBorderWidth,de=d-progBorderWidth<=1?1:d-progBorderWidth,ge=((e=constrain(e,0,1))<$&&(e=$),1!==Z?strokeCap(ROUND):strokeCap(SQUARE),color(hue(w),saturation(w),lerp(brightness(w)/255*200,brightness(w)/255*100,constrain(3*$,0,1)))),ce=color(hue(w),saturation(w),lerp(100,255,brightness(w)/255)),ge=lerpColor(ce,ge,_),fe=(fill(ge,re),noStroke(),arc(0,0,he-oe,ae-oe,-90,270),noFill(),stroke(ge,te),arc(0,0,he,ae,360*e-90,270),strokeCap(SQUARE),push(),strokeWeight(ne),Tt.mods.hidden?stroke(ce,y):stroke(225,y),arc(0,0,le,de,-90,360*(e-$)-90),pop(),push(),strokeWeight(ne),stroke(ce,y),arc(0,0,le,de,360*(e-$)-90,360*e-90),pop(),Tt.beat[i][6]/60*Tt.beat[i][9]);strokeWeight(oe),stroke((hue(w)+239.0625)%255,saturation(w),255,te/1.25);for(var ue=0;ue<fe;ue++){push();var ve=360/fe*ue-90;arc(0,0,he,ae,ve-5,5+ve),pop()}-1!==Tt.selectedBeats.indexOf(i)&&(stroke(29,255,255),arc(0,0,he+oe,ae+oe,-90,270));break}}pop()}colorMode(RGB),push(),rectMode(CENTER),width/1920>height/1080?translate(width/2+Tt.effected.boardX*(1920/1080*height/240),height/2+Tt.effected.boardY*(height/135)):translate(width/2+Tt.effected.boardX*(width/240),height/2+Tt.effected.boardY*(.5625*width/135)),scale(Tt.effected.boardW,Tt.effected.boardH),rotate(Tt.effected.boardR);for(var me=Tt.board.w*Tt.board.c*3/8,pe=Tt.board.h*Tt.board.c*3/8,be=width/1920>height/1080,we=kt/4/5*Bt.settings.missShake,i=0;i<9;i++)Tt.time-Tt.tileTrailLast[i]>=Tt.effected.tileTrailSpacing[i]/1e3/60*120&&(Tt.tileTrailLast[i]=Tt.time,void 0===Tt.tileTrail[i]&&(Tt.tileTrail[i]=[]),push(),translate(me*(i%3-1),pe*(floor(i/3)-1)),be?translate(Tt.effected.tileX[i]*(1920/1080*height/240),Tt.effected.tileY[i]*(height/135)):translate(Tt.effected.tileX[i]*(width/240),Tt.effected.tileY[i]*(.5625*width/135)),Tt.tileTrail[i].push({time:Tt.time,x:zt.get(1).x,y:zt.get(1).y,r:Tt.effected.tileR[i],w:Tt.effected.tileW[i],h:Tt.effected.tileH[i],a:Tt.effected.tileA[i],hue:Tt.effected.tileColor[i],saturation:Tt.effected.tileSaturation[i],brightness:Tt.effected.tileBrightness[i],alpha:Tt.effected.tileAlpha[i],overlayHue:Tt.effected.tileOverlayColor[i],overlaySaturation:Tt.effected.tileOverlaySaturation[i],overlayBrightness:Tt.effected.tileOverlayBrightness[i],overlayAlpha:Tt.effected.tileOverlayAlpha[i],rememberColor:Tt.effected.tileTrailColor[i]}),10<Tt.tileTrail[i].length&&(Tt.tileTrail[i]=Tt.tileTrail[i].splice(Tt.tileTrail[i].length-10,10)),pop());for(i=0;i<9;i++){var Ce=constrain(ceil(Tt.effected.tileTrailLength[i]),0,10),ye=constrain(Tt.effected.tileTrailLength[i],0,10)-Ce,Ee={};Ee=be?{x:Tt.effected.tileX[i]*(1920/1080*height/240)+me*(i%3-1),y:Tt.effected.tileY[i]*(height/135)+pe*(floor(i/3)-1),r:Tt.effected.tileR[i],w:Tt.effected.tileW[i],h:Tt.effected.tileH[i],a:Tt.effected.tileA[i],hue:Tt.effected.tileColor[i],saturation:Tt.effected.tileSaturation[i],brightness:Tt.effected.tileBrightness[i],alpha:Tt.effected.tileAlpha[i],overlayHue:Tt.effected.tileOverlayColor[i],overlaySaturation:Tt.effected.tileOverlaySaturation[i],overlayBrightness:Tt.effected.tileOverlayBrightness[i],overlayAlpha:Tt.effected.tileOverlayAlpha[i],rememberColor:!1}:{x:Tt.effected.tileX[i]*(width/240)+me*(i%3-1),y:Tt.effected.tileY[i]*(.5625*width/135)+pe*(floor(i/3)-1),r:Tt.effected.tileR[i],w:Tt.effected.tileW[i],h:Tt.effected.tileH[i],a:Tt.effected.tileA[i],hue:Tt.effected.tileColor[i],saturation:Tt.effected.tileSaturation[i],brightness:Tt.effected.tileBrightness[i],alpha:Tt.effected.tileAlpha[i],overlayHue:Tt.effected.tileOverlayColor[i],overlaySaturation:Tt.effected.tileOverlaySaturation[i],overlayBrightness:Tt.effected.tileOverlayBrightness[i],overlayAlpha:Tt.effected.tileOverlayAlpha[i],rememberColor:!1};for(var Pe=Ce-1;-1<=Pe;Pe--){if(0<=Pe){if(void 0===Tt.tileTrail[i])continue;var Oe=Tt.tileTrail[i].length-Pe-1;if(void 0===Tt.tileTrail[i][Oe])continue;var E=Tt.tileTrail[i][Oe],ze=(1-lerp(Pe,Pe+1,(Tt.time-Tt.tileTrailLast[i])/(Tt.effected.tileTrailSpacing[i]/1e3/60*120))/(Ce+ye))*Tt.effected.tileTrailAlpha[i];if(E.x===Ee.x&&E.y===Ee.y&&E.r===Ee.r&&E.w===Ee.w&&E.h===Ee.h)continue;if(E.time<Tt.effected.tileTrailDelete[i])continue}else E=Ee,ze=1;E.rememberColor||(E.hue=Tt.effected.tileColor[i],E.saturation=Tt.effected.tileSaturation[i],E.brightness=Tt.effected.tileBrightness[i],E.alpha=Tt.effected.tileAlpha[i],E.overlayHue=Tt.effected.tileOverlayColor[i],E.overlaySaturation=Tt.effected.tileOverlaySaturation[i],E.overlayBrightness=Tt.effected.tileOverlayBrightness[i],E.overlayAlpha=Tt.effected.tileOverlayAlpha[i]),Tt.tilePressDis[i]+=At(Tt.tilePressRelease[i]?0:1,Tt.tilePressDis[i],.4),Tt.tilePressDis[i]=Ot(1e4*Tt.tilePressDis[i])/1e4,push(),strokeWeight(Tt.board.str*(Tt.board.c/64)*Tt.missTiles[i][0]*(Tt.board.h<Tt.board.w?Tt.board.h/.75:Tt.board.w/.75)),colorMode(HSB),stroke(E.hue,E.saturation,E.brightness,E.alpha*Tt.effected.boardA*Tt.effected.tileA[i]*ze),colorMode(RGB),translate(sin((1-Tt.missTiles[i][0])*(8*Math.PI))*we,0),translate(E.x,E.y),rotate(E.r),scale(1-Tt.tilePressDis[i]*(Bt.settings.tilePush/10*.15)),fill(0,255*(1-+Tt.board.str)*Tt.effected.boardA*Tt.effected.tileA[i]);var xe,Se=(Tt.board.w*Tt.board.c/4+Tt.board.str*(Tt.board.c/64))*E.w,Be=(Tt.board.h*Tt.board.c/4+Tt.board.str*(Tt.board.c/64))*E.h,Te=(rect(0,0,Se,Be),Bt.settings.boardOverlay/100*Tt.effected.boardA*E.a);0<Te&&(xe=2!==(!(xe=[])===Bt.settings.overlayText?Bt.settings.keyboard:Bt.settings.overlayText)?Tt.keyDisplay[Bt.settings.language]:Tt.keyDisplayNum,textAlign(CENTER,CENTER),colorMode(HSB),fill(E.overlayHue,E.overlaySaturation,E.overlayBrightness,E.overlayAlpha*Te*ze),noStroke(),textSize((Se<Be?Se:Be)/1.5),text(xe[i],0,0)),pop()}}pop();o=0,n=0;n=width/1920>height/1080?(o=1920/1080*height/240,height/135):(o=width/240,.5625*width/135);for(var i=Tt.newHits.length-1;0<=i;i--){var He,Re,ke,Ne,P=Tt.newHits[i],Qe=Tt.hitValues[P.type],b=(Tt.time-P.time)/(Bt.settings.hitParticlesDuration/240*Tt.mods.bpm);0===P.type&&Bt.settings.disableMarvelouses||1===P.type&&Bt.settings.disableGreats||2===P.type&&Bt.settings.disableGoods||3===P.type&&Bt.settings.disableOks||4===P.type&&Bt.settings.disableMisses||b<1&&(He=Tt.board.w*Tt.board.c*3/8*(P.tile%3-1)+width/2+Tt.effected.tileX[P.tile]*o,ke=Tt.board.h*Tt.board.c*3/8*(floor(P.tile/3)-1)+height/2+Tt.effected.tileY[P.tile]*n,Re=Tt.board.w*Tt.board.c/4*(1-abs(P.error))*Tt.effected.tileW[P.tile],Ne=Tt.board.h*Tt.board.c/4*(1-abs(P.error))*Tt.effected.tileH[P.tile],push(),rectMode(CENTER),translate(width/2,height/2),translate(Tt.effected.boardX*o,Tt.effected.boardY*n),scale(Tt.effected.boardW,Tt.effected.boardH),rotate(Tt.effected.boardR),translate(-width/2,-height/2),translate(He,ke),rotate(Tt.effected.tileR[P.tile]),push(),He=(Re<Ne?Re:Ne)/3*(Bt.settings.hitParticlesThickness/5),ke=.5*sin(90*b)+1,ke=(Re+He/4)*(Re=lerp(ke,lerp(ke/1.5,ke,Bt.settings.hitParticlesSpread/5),b)),Ne=(Ne+He/4)*Re,stroke(Qe.color),drawingContext.globalAlpha=(.25+.75*(1-b))*(Bt.settings.hitParticlesOpacity/100),strokeWeight(He*(1-b)),noFill(),rectMode(CENTER),ellipseMode(CENTER),(1===P.noteType?ellipse:rect)(0,0,ke,Ne),pop(),pop())}colorMode(HSB),fill(Tt.effected.foregroundOverlayColor,Tt.effected.foregroundOverlaySaturation,Tt.effected.foregroundOverlayBrightness,Tt.effected.foregroundOverlayAlpha),noStroke(),rect(0,0,width,height),colorMode(RGB),push(),imageMode(CENTER),translate(width/2,height/2),image(St.vignette,0,0,(width/1920>height/1080?1920/1080*height:width)*(-pow(Tt.effected.vignette-10,3)/(pow(10,3)/14)+1)+8,(width/1920>height/1080?height:.5625*width)*(-pow(Tt.effected.vignette-10,3)/(pow(10,3)/14)+1)+8),resetMatrix(),rectMode(CORNER),fill(0),noStroke(),rect(0,0,width,(height-(width/1920>height/1080?height:.5625*width)*(-pow(Tt.effected.vignette-10,3)/(pow(10,3)/14)+1))/2),rect(0,height,width,-(height-(width/1920>height/1080?height:.5625*width)*(-pow(Tt.effected.vignette-10,3)/(pow(10,3)/14)+1))/2),rect(0,0,(width-(width/1920>height/1080?1920/1080*height:width)*(-pow(Tt.effected.vignette-10,3)/(pow(10,3)/14)+1))/2,height),rect(width,0,-(width-(width/1920>height/1080?1920/1080*height:width)*(-pow(Tt.effected.vignette-10,3)/(pow(10,3)/14)+1))/2,height),pop(),push(),resetMatrix(),fill(0),rectMode(CORNER),noStroke(),H=width/1920>height/1080?(R=1920/1080*height/240,N=height/135,T=width-1920/1080*height,0):(R=width/240,N=.5625*width/135,T=0,height-.5625*width),rect(0,0,T/2+Tt.effected.letterboxX*R,height),rect(width,0,-T/2-Tt.effected.letterboxX*R,height),rect(0,0,width,H/2+Tt.effected.letterboxY*N),rect(0,height,width,-H/2-Tt.effected.letterboxY*N),pop();for(i=0;i<Tt.effected.subtitles.length;i++){var Ie,Ae,Fe,De,Xe,O=Tt.effected.subtitles[i],We=(push(),O.moveX=void 0===O.moveX?0:O.moveX,O.moveY=void 0===O.moveY?0:O.moveY,O.moveSize=void 0===O.moveSize?0:O.moveSize,O.posD=void 0===O.posD?0:O.posD,O.moveD=void 0===O.moveD?0:O.moveD,O.moveHighlightColor=void 0===O.moveHighlightColor?0:O.moveHighlightColor,O.transparency=void 0===O.transparency?255:O.transparency,O.moveTransparency=void 0===O.moveTransparency?0:O.moveTransparency,O.easeType=void 0===O.easeType?0:O.easeType,O.textDi=void 0===O.textDi?0:O.textDi,O.posX+It(Tt.time-O.time,O.moveTime,O.moveX,O.easeType)),Ue=O.posY+It(Tt.time-O.time,O.moveTime,O.moveY,O.easeType),Le=O.size+It(Tt.time-O.time,O.moveTime,O.moveSize,O.easeType),Ke=O.posD+It(Tt.time-O.time,O.moveTime,O.moveD,O.easeType),z=O.highlightColor,Ve=O.highlightSaturation,Me=O.highlightBrightness,qe=O.highlightAlpha,x=O.backgroundColor,Ze=O.backgroundSaturation,je=O.backgroundBrightness,Ge=O.backgroundAlpha,S=(z=(z%=255)<0?255+z:z,x=(x%=255)<0?255+x:x,Le=Le<0?0:Le,It(Tt.time-O.time,O.moveTime,1,O.easeType)),S=(colorMode(HSB),qe=!0===O.targetHighlightSmooth?(colorMode(HSB),Ie=color(z,Ve,Me,qe),Ae=color(O.targetHighlightColor,O.targetHighlightSaturation,O.targetHighlightBrightness,O.targetHighlightAlpha),colorMode(RGB),Fe=lerpColor(Ie,Ae,S),z=hue(Fe),Ve=saturation(Fe),Me=brightness(Fe),alpha(Fe)):(void(De=0)!==O.targetHighlightLoops&&(De=255*O.targetHighlightLoops),z=(z=lerp(z,O.targetHighlightColor+De,S)%255)<0?255+z:z,Ve=lerp(Ve,O.targetHighlightSaturation,S),Me=lerp(Me,O.targetHighlightBrightness,S),lerp(qe,O.targetHighlightAlpha,S)),Ge=!0===O.targetBackgroundSmooth?(colorMode(HSB),Ie=color(x,Ze,je,Ge),Ae=color(O.targetBackgroundColor,O.targetBackgroundSaturation,O.targetBackgroundBrightness,O.targetBackgroundAlpha),colorMode(RGB),Fe=lerpColor(Ie,Ae,S),x=hue(Fe),Ze=saturation(Fe),je=brightness(Fe),alpha(Fe)):(void(De=0)!==O.targetBackgroundLoops&&(De=255*O.targetBackgroundLoops),x=(x=lerp(x,O.targetBackgroundColor+De,S)%255)<0?255+x:x,Ze=lerp(Ze,O.targetBackgroundSaturation,S),je=lerp(je,O.targetBackgroundBrightness,S),lerp(Ge,O.targetBackgroundAlpha,S)),colorMode(HSB),0),Ye=0;if(isNaN(z)&&(z=141),isNaN(x)&&(z=141),Ye=(width/1920>height/1080?(translate(We*(1920/1080*height/240)+(width-1920/1080*height)/2,Ue*(height/135)),S=Ot(Le*(height/135)),1920/1080*height/240):(translate(We*(width/240),Ue*(.5625*width/135)+(height-.5625*width)/2),S=Ot(Le*(.5625*width/135)),width/240),S),textSize(S),textLeading(Ye),rotate(Ke),void 0!==O.text){var B=O.text,Je=O.highlight,_e=!1,$e=!1;switch(O.textDi){case 1:B=(B=(B=B.split("")).reverse()).join(""),$e=!0;break;case 2:B=(B=B.split("")).join("\n"),Je*=2,_e=!0;break;case 3:B=(B=(B=B.split("")).reverse()).join("\n"),Je*=2,$e=_e=!0}if(Xe=Di(B,S,Ye),_e)switch(Tt.effected.subtitles[i].textAl){default:textAlign(LEFT,TOP);break;case 1:textAlign(CENTER,TOP);break;case 2:textAlign(RIGHT,TOP);break;case 3:textAlign(LEFT,TOP),translate(0,Ot(-Xe/2));break;case 4:textAlign(CENTER,TOP),translate(0,Ot(-Xe/2));break;case 5:textAlign(RIGHT,TOP),translate(0,Ot(-Xe/2));break;case 6:textAlign(LEFT,TOP),translate(0,Ot(-Xe));break;case 7:textAlign(CENTER,TOP),translate(0,Ot(-Xe));break;case 8:textAlign(RIGHT,TOP),translate(0,Ot(-Xe))}else switch(Tt.effected.subtitles[i].textAl){default:textAlign(LEFT,TOP),translate(0,0);break;case 1:textAlign(LEFT,TOP),translate(Ot(-textWidth(Tt.effected.subtitles[i].text)/2),0);break;case 2:textAlign(LEFT,TOP),translate(Ot(-textWidth(Tt.effected.subtitles[i].text)),0);break;case 3:textAlign(LEFT,CENTER);break;case 4:textAlign(LEFT,CENTER),translate(Ot(-textWidth(Tt.effected.subtitles[i].text)/2),0);break;case 5:textAlign(LEFT,CENTER),translate(Ot(-textWidth(Tt.effected.subtitles[i].text)),0);break;case 6:textAlign(LEFT,BOTTOM);break;case 7:textAlign(LEFT,BOTTOM),translate(Ot(-textWidth(Tt.effected.subtitles[i].text)/2),0);break;case 8:textAlign(LEFT,BOTTOM),translate(Ot(-textWidth(Tt.effected.subtitles[i].text)),0)}$e&&(Je=abs(B.length-(constrain(Je,0,B.length+(_e?1:0))-(_e?1:0)))),Je=constrain(Je,0,B.length),colorMode(HSB);We=color(x,Ze,je,Ge),Ue=color(z,Ve,Me,qe),Le=(fill($e?Ue:We),_e?Ot(Di(B.substr(0,Je),S,Ye)):0);text(B.substr(Je,B.length),_e?0:Ot(textWidth(B.substr(0,Je))),0<Le?Le+Ye/2-textDescent():0),fill($e?We:Ue),text(B.substr(0,Je),0,0)}pop(),colorMode(RGB)}if(Tt.mods.flashlight&&(push(),width/1920>height/1080?translate(width/2+Tt.effected.boardX*(1920/1080*height/240),height/2+Tt.effected.boardY*(height/135)):translate(width/2+Tt.effected.boardX*(width/240),height/2+Tt.effected.boardY*(.5625*width/135)),rotate(Tt.effected.boardR),scale(Tt.effected.boardW,Tt.effected.boardH),Tt.flashlightX+=At(Tt.board.w*Tt.board.c*3/8*(Tt.lastHitTile%3-1),Tt.flashlightX,.2),Tt.flashlightY+=At(Tt.board.h*Tt.board.c*3/8*(floor(Tt.lastHitTile/3)-1),Tt.flashlightY,.2),translate(Tt.flashlightX,Tt.flashlightY),width/1920>height/1080?translate(Tt.effected.tileX[Tt.lastHitTile]*(1920/1080*height/240),Tt.effected.tileY[Tt.lastHitTile]*(height/135)):translate(Tt.effected.tileX[Tt.lastHitTile]*(width/240),Tt.effected.tileY[Tt.lastHitTile]*(.5625*width/135)),noFill(),stroke(0),strokeWeight(width),ellipse(0,0,Tt.board.w*Tt.board.c/4*Tt.effected.tileW[Tt.lastHitTile]*4+width,Tt.board.h*Tt.board.c/4*Tt.effected.tileH[Tt.lastHitTile]*4+width,Tt.flashlightY),pop()),push(),resetMatrix(),fill(0),rectMode(CORNER),noStroke(),width/1920>height/1080?(rect(0,0,(width-1920/1080*height)/2,height),rect(width,height,-(width-1920/1080*height)/2,-height)):height/1080>width/1920&&(rect(0,0,width,(height-.5625*width)/2),rect(width,height,-width,-(height-.5625*width)/2)),pop(),!1===Tt.edit){Tt.headerY+=At(0,Tt.headerY,.2),Tt.showGUI?Tt.guiAlpha+=At(1,Tt.guiAlpha,.3):Tt.guiAlpha+=At(0,Tt.guiAlpha,.3),rectMode(CORNER),noStroke();for(var T=Ot(lerp(width/16,width/2,(Bt.settings.headerWidth-1)/9)),et=(push(),translate(width/2-T/2,0),Bt.settings.showProgress?(R=Ot(constrain(Tt.time/Tt.timeEnd,0,1)*T),fill(40,150*Tt.guiAlpha),rect(R,0,T-R,height/32),fill(150,150*Tt.guiAlpha),rect(0,0,R,height/32)):(Bt.settings.showAccuracy||Bt.settings.showHP)&&(fill(40,150*Tt.guiAlpha),rect(0,0,T,height/32)),pop(),0),i=Tt.acc=0;i<Tt.hitValues.length;i++)isNaN(Tt.hitStats[i])&&(Tt.hitStats[i]=0),Tt.acc+=Tt.hitValues[i].acc*Tt.hitStats[i],et+=Tt.hitStats[i];0<et?Tt.acc/=et:Tt.acc=100,Tt.accDis+=At(Tt.acc,Tt.accDis,.35),Tt.scoreFinal=Gi(Tt.newScore.log),Tt.scoreDis+=At(Tt.scoreFinal*wn(Tt.mods,!0),Tt.scoreDis,.35);var H=Tt.accDis.toFixed(3)+"%";if(Bt.settings.showAccuracy&&(textAlign(CENTER,CENTER),fill(255,200*Tt.guiAlpha),textSize(height/32/1.5),text(H,width/2,height/32/2)),Tt.hp=constrain(Tt.hp,0,100),Tt.hpDis+=At(Tt.hp,Tt.hpDis,.2),Bt.settings.showHP&&(N=pow(Tt.hpDis/100,1),fill(lerpColor(color(255,0,0,200*Tt.guiAlpha),color(255,200*Tt.guiAlpha),N)),rect(width/2-T/2,height/32,T*(Tt.hpDis/100),lerp(height/64,height/512,N))),Bt.settings.showUR){push(),translate(width/2,height/32*2),rectMode(CENTER);for(i=Tt.newHits.length-1;0<=i;i--){var P=Tt.newHits[i],Qe=Tt.hitValues[P.type];1<=(Tt.time-P.time)/5&&Tt.newHits.splice(i,1),fill(Qe.color,lerp(200*Tt.guiAlpha,0,(Tt.time-P.time)/5)),rect(P.error/Tt.hitValues[Tt.hitValues.length-1].timing*(width/16/2),0,width/1024,height/64)}pop()}textAlign(CENTER,CENTER),Bt.settings.showJudgements&&0<Tt.newHits.length&&(P=Tt.newHits[Tt.newHits.length-1],Qe=Tt.hitValues[P.type],fill(Qe.color,lerp(200*Tt.guiAlpha,0,(Tt.time-P.time)/5)),textSize(lerp(height/64*1.25,height/64,constrain((Tt.time-P.time)/3,0,1))),text(Qe.name,width/2,height/32*1.5));var R="";if(Tt.mods.auto?R=Pt("game_replayHeader",xt,"Pulsus",Tt.title,void 0===Ut(Tt.author,"uuid").user?Pt("defaultUsername",xt):Ut(Tt.author,"uuid").user,Ot(100*Tt.stars)/100,Vo(Tt.mods)):0!==Tt.mods.startPos||0!==Tt.mods.endPos?R=Pt("game_practicing",xt,Ko(Tt.mods.startPos,Tt.mods.endPos)):Tt.replay.on&&(R=Pt("game_replayHeader",xt,Ut(Tt.replay.user,"uuid").user,Tt.title,void 0===Ut(Tt.author,"uuid").user?Pt("defaultUsername",xt):Ut(Tt.author,"uuid").user,Ot(100*Tt.stars)/100,Vo(Tt.mods))),0<R.length&&(textSize(height/32/1.5),rectMode(CENTER),fill(40,150*Tt.guiAlpha),rect(width/2,height-height/32/2,textWidth(R)+(height/32-height/32/1.5),height/32),textAlign(CENTER,CENTER),fill(255,200*Tt.guiAlpha),text(R,width/2,height-height/32/2)),Bt.settings.showScore&&(textAlign(RIGHT,TOP),fill(255,200*Tt.guiAlpha),textSize(height/16/1.5),text(Ot(Tt.scoreDis),width-height/32,height/32)),Bt.settings.showCombo&&(textAlign(LEFT,BOTTOM),fill(255,200*Tt.guiAlpha),0<Tt.newHits.length?(P=Tt.newHits[Tt.newHits.length-1],textSize(lerp(height/16,height/16/1.5,Math.sin(constrain(Tt.time-P.time,0,1)*Math.PI/2)))):textSize(height/16/1.5),text(Tt.combo+"x",height/32,height-height/32)),Bt.settings.showSections&&0<=Tt.sections.length){rectMode(CORNER);for(var tt=!1,i=Tt.sections.length-1;0<=i;i--){var it=Tt.sections[i];if(Tt.time>it.time){tt=i;break}}textAlign(LEFT,CENTER);for(var H=height/24,T=(textSize(H/1.5),0),ot=(!1!==tt?(N=Tt.sections[tt],Tt.sectionBarWidth+=At(textWidth(N.name)+(H-H/1.5),Tt.sectionBarWidth,.2),Tt.sectionCarouselIndex+=At(tt+1,Tt.sectionCarouselIndex,.2),T=Ot(constrain((Tt.time-N.time)/((tt===Tt.sections.length-1?Tt.timeEnd:Tt.sections[tt+1].time)-N.time),0,1)*Tt.sectionBarWidth)):(Tt.sectionBarWidth+=At(0,Tt.sectionBarWidth,.2),Tt.sectionCarouselIndex+=At(0,Tt.sectionCarouselIndex,.2)),[""]),i=0;i<Tt.sections.length;i++)ot.push({text:Tt.sections[i].name,color:color(255,200*Tt.guiAlpha)});fill(40,150*Tt.guiAlpha),rect(T+kt,kt,Ot(Tt.sectionBarWidth)-T,H),fill(150,150*Tt.guiAlpha),rect(kt,kt,T,H),Un((H-H/1.5)/2+kt,H/2+kt,H/1.5,1,Tt.sectionCarouselIndex,ot)}}if(!0===Tt.edit){var k=Fn();if(0===Tt.editorMode&&(Tt.showGUI=!0),Tt.showGUI){Tt.headerY+=At(0,Tt.headerY,.2);var nt=Ft("rcorner",0,0,kt,kt),R=(mouseY<height/16*Tt.headerY+height/16*(Tt.headerH+1)&&"scroll"===Tt.timelineMode&&!Tt.menu&&!nt?(Tt.headerH+=At(1,Tt.headerH,.2),mouseIsPressed&&(Tt.time=Ot(Tt.timeEnd/width*mouseX*4*e)/4/e+Tt.bpm/60/1e3*Tt.timelineOffset,Tt.timeScroll=Tt.time,!0===Tt.playing)&&(Tt.timeStart=millis(),Tt.playingOffset=Tt.time,Qt[Tt.song].seek((Tt.playingOffset/Tt.bpm*60*1e3+Tt.songOffset)/1e3,$o),Tt.editorHS=[],Tt.editorHSH=[],Tt.editorHSStart=!1,Tt.metronomeLast=!1)):(Tt.headerH+=At(0,Tt.headerH,.1),Tt.toolsH+=At(0,Tt.toolsH,.1)),noStroke(),fill(0,200),rectMode(CORNER),rect(0,height/16*Tt.headerY,width,lerp(height/16+(1===Tt.editorMode?k*height/24:0),height/16*2,Tt.headerH)),4);.25!==Tt.snap&&Tt.snap!==1/8&&Tt.snap!==1/16&&(R=3),push(),strokeWeight((width<height?width:height)/512),translate(-(width/32*((Tt.time-Tt.bpm/60/1e3*Tt.timelineOffset)*e/Tt.snap%(8*R))),0);for(i=0;i<64;i++).25===Tt.snap||Tt.snap===1/8||Tt.snap===1/16?i%(.25/Tt.snap*4)==0?(stroke(0,175,255,255*(1-Tt.headerH)),line(width/32*i,height/16*Tt.headerY+height/16+height/24*(1===Tt.editorMode?k:0),width/32*i,height/16*Tt.headerY+height/16-height/16/2)):i%(.25/Tt.snap*2)==0?(stroke(0,255,0,255*(1-Tt.headerH)),line(width/32*i,height/16*Tt.headerY+height/16+height/24*(1===Tt.editorMode?k:0),width/32*i,height/16*Tt.headerY+height/16-height/16/3)):i%(.25/Tt.snap*1)==0?(stroke(255,175,0,255*(1-Tt.headerH)),line(width/32*i,height/16*Tt.headerY+height/16+height/24*(1===Tt.editorMode?k:0),width/32*i,height/16*Tt.headerY+height/16-height/16/4)):i%(.25/Tt.snap*.5)==0&&Tt.snap<=1/8?(stroke(255,0,175,255*(1-Tt.headerH)),line(width/32*i,height/16*Tt.headerY+height/16+height/24*(1===Tt.editorMode?k:0),width/32*i,height/16*Tt.headerY+height/16-height/16/5)):i%(.25/Tt.snap*.25)==0&&Tt.snap<=1/16&&(stroke(255,255,0,255*(1-Tt.headerH)),line(width/32*i,height/16*Tt.headerY+height/16+height/24*(1===Tt.editorMode?k:0),width/32*i,height/16*Tt.headerY+height/16-height/16/6)):(i-4)%(1/Tt.snap/3*3)==0?(stroke(0,175,255,255*(1-Tt.headerH)),line(width/32*i,height/16*Tt.headerY+height/16+height/24*(1===Tt.editorMode?k:0),width/32*i,height/16*Tt.headerY+height/16-height/16/2)):(i-4)%(1/Tt.snap/3*3)==1/Tt.snap/3*1||(i-4)%(1/Tt.snap/3*3)==1/Tt.snap/3*2?(stroke(255,0,0,255*(1-Tt.headerH)),line(width/32*i,height/16*Tt.headerY+height/16+height/24*(1===Tt.editorMode?k:0),width/32*i,height/16*Tt.headerY+height/16-height/16/3)):(i-4)%(1/Tt.snap/3*3/6)==0||(i-4)%(1/Tt.snap/3*3/6)==0?(stroke(255,255,255,255*(1-Tt.headerH)),line(width/32*i,height/16*Tt.headerY+height/16+height/24*(1===Tt.editorMode?k:0),width/32*i,height/16*Tt.headerY+height/16-height/16/4)):(stroke(0,0,255,255*(1-Tt.headerH)),line(width/32*i,height/16*Tt.headerY+height/16+height/24*(1===Tt.editorMode?k:0),width/32*i,height/16*Tt.headerY+height/16-height/16/6));if(pop(),push(),translate(width/2-width/32*(Tt.time*e/Tt.snap),0),0===Tt.editorMode){for(var st=[],rt=[],i=0;i<Tt.beat.length;i++)-1===st.indexOf(Tt.beat[i][1])&&(st.push(Tt.beat[i][1]),rt.push(i));for(i=0;i<Tt.beat.length;i++)width/32*((Tt.beat[i][1]+(1===Tt.beat[i][5]?Tt.beat[i][6]:0))*e)*(1/Tt.snap)+(width/2-width/32*(Tt.time*e/Tt.snap))>0-kt&&width/32*(Tt.beat[i][1]*e)*(1/Tt.snap)+(width/2-width/32*(Tt.time*e/Tt.snap))<width+kt&&(rectMode(CENTER),noStroke(),pt=!0,(pt=-1===rt.indexOf(i)?!1:pt)&&(fill(255,30*(1-Tt.headerH)),rect(width/32*(Tt.beat[i][1]*e)*(1/Tt.snap),height/16*Tt.headerY+height/16-height/16/2,3*Ot(floor(width/36)/3),3*Ot(floor(width/36)/3))),colorMode(HSB),fill(Tt.beat[i][11],Tt.beat[i][16],Tt.beat[i][17],125*(1-Tt.headerH)),colorMode(RGB),-1!==Tt.selectedBeats.indexOf(i)&&(stroke(255,175,0),strokeWeight(kt/8)),0===Tt.beat[i][5]?rect(width/32*(Tt.beat[i][1]*e)*(1/Tt.snap)-floor(width/36)/3+Ot(floor(width/36)/3)*floor(Tt.beat[i][0]%3),height/16*Tt.headerY+height/16-height/16/2-floor(width/36)/3+Ot(floor(width/36)/3)*floor(Tt.beat[i][0]/3),floor(width/48)/3,floor(width/48)/3):(ellipseMode(CENTER),ellipse(width/32*(Tt.beat[i][1]*e)*(1/Tt.snap)-floor(width/36)/3+Ot(floor(width/36)/3)*floor(Tt.beat[i][0]%3),height/16*Tt.headerY+height/16-height/16/2-floor(width/36)/3+Ot(floor(width/36)/3)*floor(Tt.beat[i][0]/3),floor(width/48)/3,floor(width/48)/3),rectMode(CORNER),rect(width/32*(Tt.beat[i][1]*e)*(1/Tt.snap),height/16*Tt.headerY+height/16-height/16/2-height/256/2,width/32*(Tt.beat[i][6]/Tt.snap*e),height/256)))}if(1===Tt.editorMode&&Tt.showGUI)for(t=0;t<Tt.drawEffects.length;t++){var i=Tt.drawEffects[t],ht=(rectMode(CENTER),noStroke(),colorMode(HSB),fill(0<Tt.effects[i].displayColor?Tt.effects[i].displayColor:0,Tt.effects[i].displaySaturation*(!0!==Tt.effects[i].disabled?1:.5),Tt.effects[i].displayBrightness,200*(1-Tt.headerH)*(!0!==Tt.effects[i].disabled?1:.5)),-1!==Tt.effectMultiSel.indexOf(i)&&(colorMode(RGB),stroke(255,175,0,255*(1-Tt.headerH)),strokeWeight(kt/4)),rect(width/32*(Tt.effects[i].time*e)*(1/Tt.snap)+width/32*(1/Tt.snap)*(Tt.effects[i].moveTime*e)/2,height/16*Tt.headerY+height/16-height/16/2+height/24*Tt.effects[i].track,constrain(width/32*(1/Tt.snap)*(Tt.effects[i].moveTime*e),width/64,9999999999999),width/64,width/32*(1/Tt.snap)*(Tt.effects[i].moveTime*e)<width/64?width:0),textAlign(LEFT,CENTER),colorMode(RGB),fill(!0!==Tt.effects[i].disabled?255:200,255*(1-Tt.headerH)),noStroke(),Pt(Tt.effectTypeNames[Tt.effects[i].type],xt));Dt(""===Tt.effects[i].displayName?ht:Tt.effects[i].displayName+" ("+ht+")",width/32*(Tt.effects[i].time*e)*(1/Tt.snap)+width/64/2,height/16*Tt.headerY+height/16-height/16/2+height/24*Tt.effects[i].track,constrain(width/32*(1/Tt.snap)*(Tt.effects[i].moveTime*e),width/16,9999999999999)-width/64/2,width/64/1.5)}strokeWeight(floor(width/48)/3/6),ellipseMode(CENTER);for(i=0;i<Tt.sections.length;i++)colorMode(RGB),-1===Tt.sectionsSelected.indexOf(i)?stroke(255,255*(1-Tt.headerH)):stroke(255,175,0,255*(1-Tt.headerH)),colorMode(HSB),fill(Tt.sections[i].color,Tt.sections[i].saturation,Tt.sections[i].brightness,255*(1-Tt.headerH)),ellipse(width/32*(Tt.sections[i].time*e)*(1/Tt.snap),height/16*Tt.headerY+height/16+floor(width/48)/3+height/24*(1===Tt.editorMode?k:0),floor(width/48)/3,floor(width/48)/3);colorMode(RGB),pop(),noStroke(),colorMode(HSB),rectMode(CENTER);var at,lt=!1;void 0===at&&(at=!1);for(i=0;i<Tt.sections.length;i++){it=Tt.sections[i];void 0===Tt.sectionsHighlight[i]&&(Tt.sectionsHighlight[i]=0),at!==i&&(Tt.sectionsHighlight[i]+=At(0,Tt.sectionsHighlight[i],.2)),!nt&&Ft("rcenter",(width-width/128)/Tt.timeEnd*it.time+width/128/2,height/16*(Tt.headerH+1)/2,width/128,height/16*(Tt.headerH+1))&&(lt=i),fill(it.color,it.saturation,it.brightness,200*Tt.headerH),rect((width-width/128)/Tt.timeEnd*it.time+width/128/2,height/16*(Tt.headerH+1)/2,width/128/4*(it.visible?2:1)*(Tt.sectionsHighlight[i]+1),height/16*(Tt.headerH+1))}!1!==(at=lt)&&(Tt.sectionsHighlight[lt]+=At(1,Tt.sectionsHighlight[lt],.3)),colorMode(RGB),!1!==lt&&"scroll"===Tt.timelineMode&&(fill(0,200),rectMode(CENTER),rect(width/2,height/16*(Tt.headerH+1)+1.5*kt,width/3-2*kt,height/32+kt,kt),fill(255),textAlign(CENTER,CENTER),Dt(Tt.sections[lt].name,width/2,height/16*(Tt.headerH+1)+1.5*kt,width/3-3*kt,height/32)),rectMode(CORNER),fill(255,255*(.5-Tt.headerH)),noStroke(),rect(width/2-width/512/2,0,width/512,height/16+height/24*(1===Tt.editorMode?k:0)),rectMode(CENTER),fill(255,200*Tt.headerH),noStroke(),rect((width-width/128)/Tt.timeEnd*Tt.time+width/128/2,height/16*(Tt.headerH+1)/2,width/128,height/16*(Tt.headerH+1)),nt&&(push(),rectMode(CORNER),fill(255,100),rect(0,0,kt,kt),pop(),$t=Pt("edit_copyTimestamp",xt)),textAlign(LEFT,TOP),fill(255,200),Dt(Tt.timelineTickFor(Tt.time)+" ("+Tt.timelineBPM+") ("+Pt("milliseconds_short",xt,Tt.timelineOffset)+")\n"+Wo(Tt.time/Tt.bpm*60*1e3,"min:sec:ms"),kt/4,kt/4,width-kt/2,kt/2)}if(!0===Tt.menu?Tt.menuSize+=At(1,Tt.menuSize,.2):Tt.menuSize+=At(0,Tt.menuSize,.2),0===Tt.sectionsSelected.length){if(1===Tt.editorMode&&Tt.showGUI){if(fill(0,0,0,200),rectMode(CORNER),noStroke(),rect(width-width/4,height/16*2,width/2,height/16*12,(width<height?width:height)/32),1===Tt.effectMultiSel.length?Tt.effectSel=Tt.effectMultiSel[0]:Tt.effectSel=!1,Tt.effectMultiSel.length<=1?Tt.effectMultiSelLast=!1:Tt.effectSelLast=!1,!1===Tt.effectSel&&!1!==Tt.effectSelLast&&0===Tt.effectMultiSel.length){function dt(t){var i=Tt.timelineTickFor(Tt.time);for(let e=Tt.effectMultiSel.length=0;e<Tt.effects.length;e++){var o=Tt.effects[e];t(i,Tt.timelineTickFor(o.time))&&Tt.effectMultiSel.push(e)}}Tt.effectsNSM.pages=[{title:"edit_effects_automation",items:[{type:"button",name:"edit_effects_item_newAutomation",event:function(){Tt.effects.push({type:0,time:Tt.time,bpm:Tt.timelineBPM,offset:Tt.timelineOffset,moveTime:1/Tt.timelineBPM*120,easeType:0,moveX:0,moveY:0,track:0}),Tt.effectMultiSel.push(Tt.effects.length-1)},hint:"edit_effects_item_newAutomation_sub"}]},{title:"edit_select_quickSelect",items:[{type:"button",name:"edit_select_item_selectBefore",hint:"edit_select_item_selectBefore_sub",event:()=>dt((e,t)=>t<=e)},{type:"button",name:"edit_select_item_selectCurrent",hint:"edit_select_item_selectCurrent_sub",event:()=>dt((e,t)=>t===e)},{type:"button",name:"edit_select_item_selectAfter",hint:"edit_select_item_selectAfter_sub",event:()=>dt((e,t)=>e<=t)}]}],Tt.effectsNSM.data.page=0,Tt.effectSelLast=!1}else if((Tt.effectSelLast!==Tt.effectSel||!1!==Tt.effectSel&&Tt.effectTypeLast!==Tt.effects[Tt.effectSel].type)&&1===Tt.effectMultiSel.length){Tt.effectsNSM.pages=[];for(var gt=[],i=0;i<Tt.effectTypeNames.length;i++)gt.push(i);for(var N=[{type:"dropdown",name:"edit_effects_item_automationType",hint:"edit_effects_item_automationType_sub",var:[Tt.effects[Tt.effectSel],"type"],options:gt,labels:Tt.effectTypeNames},{type:"number",name:"edit_effects_item_startTime",hint:"edit_effects_item_startTime_sub",var:[Tt.effects[Tt.effectSel],"time"],min:!1,max:!1,bigChange:1,smallChange:[Tt,"snap"],display:function(){return Xt({recieve:"bpm",time:Tt.effects[Tt.effectSel].time,bpm:Tt.effects[Tt.effectSel].bpm,offset:Tt.effects[Tt.effectSel].offset,lvlBPM:Tt.bpm})},update:function(e){e.bigChange=Xt({recieve:"raw",time:1,bpm:Tt.effects[Tt.effectSel].bpm,offset:0,lvlBPM:Tt.bpm}),e.smallChange=Xt({recieve:"raw",time:Tt.snap,bpm:Tt.effects[Tt.effectSel].bpm,offset:0,lvlBPM:Tt.bpm})},convert:function(e){return Xt({recieve:"raw",time:e,bpm:Tt.effects[Tt.effectSel].bpm,offset:Tt.effects[Tt.effectSel].offset,lvlBPM:Tt.bpm})}},{type:"number",name:"edit_select_item_bpm",hint:"edit_select_item_bpm_sub",var:[Tt.effects[Tt.effectSel],"bpm"],min:!1,max:!1,bigChange:10,smallChange:1},{type:"number",name:"edit_select_item_offset",hint:"edit_select_item_offset_sub",var:[Tt.effects[Tt.effectSel],"offset"],min:!1,max:!1,bigChange:10,smallChange:1},{type:"number",name:"edit_effects_item_duration",hint:"edit_effects_item_duration_sub",var:[Tt.effects[Tt.effectSel],"moveTime"],min:0,max:!1,bigChange:1,smallChange:[Tt,"snap"],display:function(){return Xt({recieve:"bpm",time:Tt.effects[Tt.effectSel].moveTime,bpm:Tt.effects[Tt.effectSel].bpm,offset:0,lvlBPM:Tt.bpm})},update:function(e){e.bigChange=Xt({recieve:"raw",time:1,bpm:Tt.effects[Tt.effectSel].bpm,offset:0,lvlBPM:Tt.bpm}),e.smallChange=Xt({recieve:"raw",time:Tt.snap,bpm:Tt.effects[Tt.effectSel].bpm,offset:0,lvlBPM:Tt.bpm})},convert:function(e){return Xt({recieve:"raw",time:e,bpm:Tt.effects[Tt.effectSel].bpm,offset:0,lvlBPM:Tt.bpm})}}],ct=(9===Tt.effects[Tt.effectSel].type?(Tt.effectsNSM.pages[0]={title:"edit_effects_formatting",items:[]},Tt.effectsNSM.pages[0].items=Tt.effectsNSM.pages[0].items.concat(N.splice(0,1)),Tt.effectsNSM.pages[1]={title:"edit_effects_automation",items:[]},Tt.effectsNSM.pages[1].items=Tt.effectsNSM.pages[1].items.concat(N),Tt.effectsNSM.pages[2]={title:"edit_effects_customize",items:[]}):(Tt.effectsNSM.pages[0]={title:"edit_effects_automation",items:[]},Tt.effectsNSM.pages[0].items=Tt.effectsNSM.pages[0].items.concat(N),Tt.effectsNSM.pages[1]={title:"edit_effects_customize",items:[]}),void 0===Tt.effects[Tt.effectSel].displayColor&&(Tt.effects[Tt.effectSel].displayColor=0),void 0===Tt.effects[Tt.effectSel].displaySaturation&&(Tt.effects[Tt.effectSel].displaySaturation=255),void 0===Tt.effects[Tt.effectSel].displayBrightness&&(Tt.effects[Tt.effectSel].displayBrightness=255),void 0===Tt.effects[Tt.effectSel].displayName&&(Tt.effects[Tt.effectSel].displayName=""),void 0===Tt.effects[Tt.effectSel].disabled&&(Tt.effects[Tt.effectSel].disabled=!1),Tt.effectsNSM.pages[Tt.effectsNSM.pages.length-1].items=[{type:"string",name:"edit_effects_item_displayName",hint:"edit_effects_item_displayName_sub",var:[Tt.effects[Tt.effectSel],"displayName"]},{type:"color",name:"edit_effects_item_displayColor",hint:"edit_effects_item_displayColor_sub",mode:HSB,hue:[Tt.effects[Tt.effectSel],"displayColor"],saturation:[Tt.effects[Tt.effectSel],"displaySaturation"],brightness:[Tt.effects[Tt.effectSel],"displayBrightness"]},{type:"number",name:"edit_effects_item_track",hint:"edit_effects_item_track_sub",var:[Tt.effects[Tt.effectSel],"track"],min:0,max:21,bigChange:3,smallChange:1},{type:"boolean",name:"edit_effects_item_disable",var:[Tt.effects[Tt.effectSel],"disabled"],hint:"edit_effects_item_disable_sub"},{type:"button",name:"edit_select_item_copy",event:On,hint:"edit_select_item_copy_sub"},{type:"button",name:"edit_effects_item_deleteAutomation",event:function(){Tt.effects.splice(Tt.effectSel,1),Tt.effectMultiSel.splice(Tt.effectMultiSel.indexOf(i),1),Tt.effectsTabSel=0},hint:"edit_effects_item_deleteAutomation_sub"}],[]),i=0;i<Tt.textAlignNames.length;i++)ct.push(i);for(var ft=[],i=0;i<Tt.textDirectionNames.length;i++)ft.push(i);var Q={moveX:{type:"number",name:"edit_effects_item_moveX",hint:"edit_effects_item_moveX_sub",var:[Tt.effects[Tt.effectSel],"moveX"],min:!1,max:!1,bigChange:8,smallChange:1},moveY:{type:"number",name:"edit_effects_item_moveY",hint:"edit_effects_item_moveY_sub",var:[Tt.effects[Tt.effectSel],"moveY"],min:!1,max:!1,bigChange:8,smallChange:1},scaleX:{type:"number",name:"edit_effects_item_scaleX",hint:"edit_effects_item_scaleX_sub",var:[Tt.effects[Tt.effectSel],"scaleX"],min:!1,max:!1,bigChange:1,smallChange:.1},scaleY:{type:"number",name:"edit_effects_item_scaleY",hint:"edit_effects_item_scaleY_sub",var:[Tt.effects[Tt.effectSel],"scaleY"],min:!1,max:!1,bigChange:1,smallChange:.1},moveD:{type:"number",name:"edit_effects_item_moveD",hint:"edit_effects_item_moveD_sub",var:[Tt.effects[Tt.effectSel],"moveD"],min:!1,max:!1,bigChange:9,smallChange:1},tileID:{type:"tiles",name:"edit_effects_item_tileID",hint:"edit_effects_item_tileID_sub",var:[Tt.effects[Tt.effectSel],"tileID"]},foresight:{type:"number",name:"edit_effects_item_targetValue",hint:"edit_effects_item_targetValue_sub",var:[Tt.effects[Tt.effectSel],"targetValue"],min:!1,max:!1,bigChange:.3,smallChange:.1},targetValue:{type:"number",name:"edit_effects_item_targetValue",hint:"edit_effects_item_targetValue_sub",var:[Tt.effects[Tt.effectSel],"targetValue"],min:!1,max:!1,bigChange:8,smallChange:1},vignette:{type:"number",name:"edit_effects_item_targetValue",hint:"edit_effects_item_targetValue_sub",var:[Tt.effects[Tt.effectSel],"vignette"],min:!1,max:!1,bigChange:8,smallChange:1},text:{type:"string",name:"edit_effects_item_text",hint:"edit_effects_item_text_sub",var:[Tt.effects[Tt.effectSel],"text"]},posX:{type:"number",name:"edit_effects_item_posX",hint:"edit_effects_item_posX_sub",var:[Tt.effects[Tt.effectSel],"posX"],min:!1,max:!1,bigChange:8,smallChange:1},posY:{type:"number",name:"edit_effects_item_posY",hint:"edit_effects_item_posY_sub",var:[Tt.effects[Tt.effectSel],"posY"],min:!1,max:!1,bigChange:8,smallChange:1},posD:{type:"number",name:"edit_effects_item_moveD",hint:"edit_effects_item_moveD_sub",var:[Tt.effects[Tt.effectSel],"posD"],min:!1,max:!1,bigChange:9,smallChange:1},size:{type:"number",name:"edit_effects_item_size",hint:"edit_effects_item_size_sub",var:[Tt.effects[Tt.effectSel],"size"],min:0,max:!1,bigChange:8,smallChange:1},textAl:{type:"dropdown",name:"edit_effects_item_textAlign",hint:"edit_effects_item_textAlign_sub",var:[Tt.effects[Tt.effectSel],"textAl"],options:ct,labels:Tt.textAlignNames},textDi:{type:"dropdown",name:"edit_effects_item_textDirection",hint:"edit_effects_item_textDirection_sub",var:[Tt.effects[Tt.effectSel],"textDi"],options:ft,labels:Tt.textDirectionNames},highlight:{type:"number",name:"edit_effects_item_highlight",hint:"edit_effects_item_highlight_sub",var:[Tt.effects[Tt.effectSel],"highlight"],min:0,max:!1,bigChange:8,smallChange:1},highlightColor:{type:"color",name:"edit_effects_item_highlightColor",hint:"edit_effects_item_highlightColor_sub",mode:HSB,hue:[Tt.effects[Tt.effectSel],"highlightColor"],saturation:[Tt.effects[Tt.effectSel],"highlightSaturation"],brightness:[Tt.effects[Tt.effectSel],"highlightBrightness"],alpha:[Tt.effects[Tt.effectSel],"highlightAlpha"]},backgroundColor:{type:"color",name:"edit_effects_item_backgroundColor",hint:"edit_effects_item_backgroundColor_sub",mode:HSB,hue:[Tt.effects[Tt.effectSel],"backgroundColor"],saturation:[Tt.effects[Tt.effectSel],"backgroundSaturation"],brightness:[Tt.effects[Tt.effectSel],"backgroundBrightness"],alpha:[Tt.effects[Tt.effectSel],"backgroundAlpha"]},transparency:{type:"number",name:"edit_effects_item_transparency",hint:"edit_effects_item_transparency_sub",var:[Tt.effects[Tt.effectSel],"transparency"],min:0,max:255,bigChange:16,smallChange:1},movePosX:{type:"number",name:"edit_effects_item_posX",hint:"edit_effects_item_posX_sub",var:[Tt.effects[Tt.effectSel],"moveX"],min:!1,max:!1,bigChange:8,smallChange:1},movePosY:{type:"number",name:"edit_effects_item_posY",hint:"edit_effects_item_posY_sub",var:[Tt.effects[Tt.effectSel],"moveY"],min:!1,max:!1,bigChange:8,smallChange:1},moveSize:{type:"number",name:"edit_effects_item_size",hint:"edit_effects_item_size_sub",var:[Tt.effects[Tt.effectSel],"moveSize"],min:!1,max:!1,bigChange:8,smallChange:1},targetHighlightColor:{type:"color",name:"edit_effects_item_highlightColor",hint:"edit_effects_item_highlightColor_sub",mode:HSB,hue:[Tt.effects[Tt.effectSel],"targetHighlightColor"],saturation:[Tt.effects[Tt.effectSel],"targetHighlightSaturation"],brightness:[Tt.effects[Tt.effectSel],"targetHighlightBrightness"],alpha:[Tt.effects[Tt.effectSel],"targetHighlightAlpha"],loops:[Tt.effects[Tt.effectSel],"targetHighlightLoops"],smooth:[Tt.effects[Tt.effectSel],"targetHighlightSmooth"]},targetBackgroundColor:{type:"color",name:"edit_effects_item_backgroundColor",hint:"edit_effects_item_backgroundColor_sub",mode:HSB,hue:[Tt.effects[Tt.effectSel],"targetBackgroundColor"],saturation:[Tt.effects[Tt.effectSel],"targetBackgroundSaturation"],brightness:[Tt.effects[Tt.effectSel],"targetBackgroundBrightness"],alpha:[Tt.effects[Tt.effectSel],"targetBackgroundAlpha"],loops:[Tt.effects[Tt.effectSel],"targetBackgroundLoops"],smooth:[Tt.effects[Tt.effectSel],"targetBackgroundSmooth"]},startColor:{type:"color",name:"edit_effects_item_startColor",hint:"edit_effects_item_startColor_sub",mode:HSB,hue:[Tt.effects[Tt.effectSel],"startColor"],saturation:[Tt.effects[Tt.effectSel],"startSaturation"],brightness:[Tt.effects[Tt.effectSel],"startBrightness"],alpha:[Tt.effects[Tt.effectSel],"startAlpha"]},endColor:{type:"color",name:"edit_effects_item_endColor",hint:"edit_effects_item_endColor_sub",mode:HSB,hue:[Tt.effects[Tt.effectSel],"endColor"],saturation:[Tt.effects[Tt.effectSel],"endSaturation"],brightness:[Tt.effects[Tt.effectSel],"endBrightness"],alpha:[Tt.effects[Tt.effectSel],"endAlpha"],loops:[Tt.effects[Tt.effectSel],"endLoops"],smooth:[Tt.effects[Tt.effectSel],"endSmooth"]},setColorForTile:{type:"dropdown",name:"edit_effects_item_setColorFor",hint:"edit_effects_item_setColorFor_sub",var:[Tt.effects[Tt.effectSel],"setColorFor"],options:[0,1,2],labels:["edit_effects_tileBorder","edit_effects_tileOverlay","edit_effects_tileBoth"]},setColorForOverlay:{type:"dropdown",name:"edit_effects_item_setColorFor",hint:"edit_effects_item_setColorFor_sub",var:[Tt.effects[Tt.effectSel],"setColorFor"],options:[0,1],labels:["edit_effects_overlayBackground","edit_effects_overlayForeground"]},trailLength:{type:"number",name:"edit_effects_item_trailLength",hint:"edit_effects_item_trailLength_sub",var:[Tt.effects[Tt.effectSel],"trailLength"],min:!1,max:!1,bigChange:2,smallChange:1},trailSpacing:{type:"number",name:"edit_effects_item_trailSpacing",hint:"edit_effects_item_trailSpacing_sub",var:[Tt.effects[Tt.effectSel],"trailSpacing"],min:!1,max:!1,bigChange:10,smallChange:1},trailAlpha:{type:"number",name:"edit_effects_item_trailAlpha",hint:"edit_effects_item_trailAlpha_sub",var:[Tt.effects[Tt.effectSel],"trailAlpha"],min:!1,max:!1,bigChange:16,smallChange:1},trailColor:{type:"boolean",name:"edit_effects_item_trailColor",hint:"edit_effects_item_trailColor_sub",var:[Tt.effects[Tt.effectSel],"trailColor"]},trailDelete:{type:"boolean",name:"edit_effects_item_trailDelete",hint:"edit_effects_item_trailDelete_sub",var:[Tt.effects[Tt.effectSel],"trailDelete"]}};switch(Tt.effects[Tt.effectSel].type){default:Tt.effectsNSM.pages[0].items.push(Q.moveX,Q.moveY);break;case 1:void 0===Tt.effects[Tt.effectSel].scaleX&&(Tt.effects[Tt.effectSel].scaleX=1),void 0===Tt.effects[Tt.effectSel].scaleY&&(Tt.effects[Tt.effectSel].scaleY=1),Tt.effectsNSM.pages[0].items.push(Q.scaleX,Q.scaleY);break;case 2:void 0===Tt.effects[Tt.effectSel].moveD&&(Tt.effects[Tt.effectSel].moveD=0),Tt.effectsNSM.pages[0].items.push(Q.moveD);break;case 3:void 0===Tt.effects[Tt.effectSel].tileID&&(Tt.effects[Tt.effectSel].tileID=[0]),Tt.effectsNSM.pages[0].items.push(Q.tileID,Q.moveX,Q.moveY);break;case 4:void 0===Tt.effects[Tt.effectSel].tileID&&(Tt.effects[Tt.effectSel].tileID=[0]),void 0===Tt.effects[Tt.effectSel].scaleX&&(Tt.effects[Tt.effectSel].scaleX=1),void 0===Tt.effects[Tt.effectSel].scaleY&&(Tt.effects[Tt.effectSel].scaleY=1),Tt.effectsNSM.pages[0].items.push(Q.tileID,Q.scaleX,Q.scaleY);break;case 5:void 0===Tt.effects[Tt.effectSel].tileID&&(Tt.effects[Tt.effectSel].tileID=[0]),void 0===Tt.effects[Tt.effectSel].moveD&&(Tt.effects[Tt.effectSel].moveD=0),Tt.effectsNSM.pages[0].items.push(Q.tileID,Q.moveD);break;case 6:void 0===Tt.effects[Tt.effectSel].targetValue&&(Tt.effects[Tt.effectSel].targetValue=0),Tt.effectsNSM.pages[0].items.push(Q.foresight);break;case 7:void 0===Tt.effects[Tt.effectSel].targetValue&&(Tt.effects[Tt.effectSel].targetValue=0),Tt.effectsNSM.pages[0].items.push(Q.targetValue);break;case 8:void 0===Tt.effects[Tt.effectSel].tileID&&(Tt.effects[Tt.effectSel].tileID=[0]),void 0===Tt.effects[Tt.effectSel].targetValue&&(Tt.effects[Tt.effectSel].targetValue=0),Tt.effectsNSM.pages[0].items.push(Q.tileID,Q.targetValue);break;case 9:void 0===Tt.effects[Tt.effectSel].posX&&(Tt.effects[Tt.effectSel].posX=50),void 0===Tt.effects[Tt.effectSel].posY&&(Tt.effects[Tt.effectSel].posY=50),void 0===Tt.effects[Tt.effectSel].posD&&(Tt.effects[Tt.effectSel].posD=0),void 0===Tt.effects[Tt.effectSel].size&&(Tt.effects[Tt.effectSel].size=10),void 0===Tt.effects[Tt.effectSel].text&&(Tt.effects[Tt.effectSel].text="Text"),void 0===Tt.effects[Tt.effectSel].textAl&&(Tt.effects[Tt.effectSel].textAl=4),void 0===Tt.effects[Tt.effectSel].textDi&&(Tt.effects[Tt.effectSel].textDi=0),void 0===Tt.effects[Tt.effectSel].highlight&&(Tt.effects[Tt.effectSel].highlight=0),void 0===Tt.effects[Tt.effectSel].highlightColor&&(Tt.effects[Tt.effectSel].highlightColor=141),void 0===Tt.effects[Tt.effectSel].highlightSaturation&&(Tt.effects[Tt.effectSel].highlightSaturation=255),void 0===Tt.effects[Tt.effectSel].highlightBrightness&&(Tt.effects[Tt.effectSel].highlightBrightness=255),void 0===Tt.effects[Tt.effectSel].highlightAlpha&&(Tt.effects[Tt.effectSel].highlightAlpha=255),void 0===Tt.effects[Tt.effectSel].backgroundColor&&(Tt.effects[Tt.effectSel].backgroundColor=141),void 0===Tt.effects[Tt.effectSel].backgroundSaturation&&(Tt.effects[Tt.effectSel].backgroundSaturation=0),void 0===Tt.effects[Tt.effectSel].backgroundBrightness&&(Tt.effects[Tt.effectSel].backgroundBrightness=255),void 0===Tt.effects[Tt.effectSel].backgroundAlpha&&(Tt.effects[Tt.effectSel].backgroundAlpha=255),void 0===Tt.effects[Tt.effectSel].moveX&&(Tt.effects[Tt.effectSel].moveX=0),void 0===Tt.effects[Tt.effectSel].moveY&&(Tt.effects[Tt.effectSel].moveY=0),void 0===Tt.effects[Tt.effectSel].moveD&&(Tt.effects[Tt.effectSel].moveD=0),void 0===Tt.effects[Tt.effectSel].moveSize&&(Tt.effects[Tt.effectSel].moveSize=0),void 0===Tt.effects[Tt.effectSel].targetHighlightColor&&(Tt.effects[Tt.effectSel].targetHighlightColor=141),void 0===Tt.effects[Tt.effectSel].targetHighlightSaturation&&(Tt.effects[Tt.effectSel].targetHighlightSaturation=255),void 0===Tt.effects[Tt.effectSel].targetHighlightBrightness&&(Tt.effects[Tt.effectSel].targetHighlightBrightness=255),void 0===Tt.effects[Tt.effectSel].targetHighlightAlpha&&(Tt.effects[Tt.effectSel].targetHighlightAlpha=255),void 0===Tt.effects[Tt.effectSel].targetHighlightLoops&&(Tt.effects[Tt.effectSel].targetHighlightLoops=0),void 0===Tt.effects[Tt.effectSel].targetHighlightSmooth&&(Tt.effects[Tt.effectSel].targetHighlightSmooth=!0),void 0===Tt.effects[Tt.effectSel].targetBackgroundColor&&(Tt.effects[Tt.effectSel].targetBackgroundColor=141),void 0===Tt.effects[Tt.effectSel].targetBackgroundSaturation&&(Tt.effects[Tt.effectSel].targetBackgroundSaturation=0),void 0===Tt.effects[Tt.effectSel].targetBackgroundBrightness&&(Tt.effects[Tt.effectSel].targetBackgroundBrightness=255),void 0===Tt.effects[Tt.effectSel].targetBackgroundAlpha&&(Tt.effects[Tt.effectSel].targetBackgroundAlpha=255),void 0===Tt.effects[Tt.effectSel].targetBackgroundLoops&&(Tt.effects[Tt.effectSel].targetBackgroundLoops=0),void 0===Tt.effects[Tt.effectSel].targetBackgroundSmooth&&(Tt.effects[Tt.effectSel].targetBackgroundSmooth=!0),Tt.effectsNSM.pages[0].items.push(Q.text,Q.posX,Q.posY,Q.posD,Q.size,Q.textAl,Q.textDi,Q.highlight,Q.highlightColor,Q.backgroundColor),Tt.effectsNSM.pages[1].items.push(Q.movePosX,Q.movePosY,Q.moveD,Q.moveSize,Q.targetHighlightColor,Q.targetBackgroundColor);break;case 10:void 0===Tt.effects[Tt.effectSel].vignette&&(Tt.effects[Tt.effectSel].vignette=1),Tt.effectsNSM.pages[0].items.push(Q.vignette);break;case 11:void 0===Tt.effects[Tt.effectSel].moveX&&(Tt.effects[Tt.effectSel].moveX=0),void 0===Tt.effects[Tt.effectSel].moveY&&(Tt.effects[Tt.effectSel].moveY=0),Tt.effectsNSM.pages[0].items.push(Q.moveX,Q.moveY);break;case 12:void 0===Tt.effects[Tt.effectSel].tileID&&(Tt.effects[Tt.effectSel].tileID=[0]),void 0===Tt.effects[Tt.effectSel].startColor&&(Tt.effects[Tt.effectSel].startColor=141),void 0===Tt.effects[Tt.effectSel].startSaturation&&(Tt.effects[Tt.effectSel].startSaturation=0),void 0===Tt.effects[Tt.effectSel].startBrightness&&(Tt.effects[Tt.effectSel].startBrightness=255),void 0===Tt.effects[Tt.effectSel].startAlpha&&(Tt.effects[Tt.effectSel].startAlpha=255),void 0===Tt.effects[Tt.effectSel].endColor&&(Tt.effects[Tt.effectSel].endColor=141),void 0===Tt.effects[Tt.effectSel].endSaturation&&(Tt.effects[Tt.effectSel].endSaturation=0),void 0===Tt.effects[Tt.effectSel].endBrightness&&(Tt.effects[Tt.effectSel].endBrightness=255),void 0===Tt.effects[Tt.effectSel].endAlpha&&(Tt.effects[Tt.effectSel].endAlpha=255),void 0===Tt.effects[Tt.effectSel].endLoops&&(Tt.effects[Tt.effectSel].endLoops=0),void 0===Tt.effects[Tt.effectSel].endSmooth&&(Tt.effects[Tt.effectSel].endSmooth=!0),void 0===Tt.effects[Tt.effectSel].setColorFor&&(Tt.effects[Tt.effectSel].setColorFor=0),Tt.effectsNSM.pages[0].items.push(Q.tileID,Q.startColor,Q.endColor,Q.setColorForTile);break;case 13:void 0===Tt.effects[Tt.effectSel].startColor&&(Tt.effects[Tt.effectSel].startColor=141),void 0===Tt.effects[Tt.effectSel].startSaturation&&(Tt.effects[Tt.effectSel].startSaturation=0),void 0===Tt.effects[Tt.effectSel].startBrightness&&(Tt.effects[Tt.effectSel].startBrightness=255),void 0===Tt.effects[Tt.effectSel].startAlpha&&(Tt.effects[Tt.effectSel].startAlpha=0),void 0===Tt.effects[Tt.effectSel].endColor&&(Tt.effects[Tt.effectSel].endColor=141),void 0===Tt.effects[Tt.effectSel].endSaturation&&(Tt.effects[Tt.effectSel].endSaturation=255),void 0===Tt.effects[Tt.effectSel].endBrightness&&(Tt.effects[Tt.effectSel].endBrightness=255),void 0===Tt.effects[Tt.effectSel].endAlpha&&(Tt.effects[Tt.effectSel].endAlpha=100),void 0===Tt.effects[Tt.effectSel].endLoops&&(Tt.effects[Tt.effectSel].endLoops=0),void 0===Tt.effects[Tt.effectSel].endSmooth&&(Tt.effects[Tt.effectSel].endSmooth=!0),void 0===Tt.effects[Tt.effectSel].setColorFor&&(Tt.effects[Tt.effectSel].setColorFor=0),Tt.effectsNSM.pages[0].items.push(Q.startColor,Q.endColor,Q.setColorForOverlay);break;case 14:void 0===Tt.effects[Tt.effectSel].tileID&&(Tt.effects[Tt.effectSel].tileID=[0]),void 0===Tt.effects[Tt.effectSel].trailLength&&(Tt.effects[Tt.effectSel].trailLength=5),void 0===Tt.effects[Tt.effectSel].trailSpacing&&(Tt.effects[Tt.effectSel].trailSpacing=0),void 0===Tt.effects[Tt.effectSel].trailAlpha&&(Tt.effects[Tt.effectSel].trailAlpha=0),void 0===Tt.effects[Tt.effectSel].trailColor&&(Tt.effects[Tt.effectSel].trailColor=!0),void 0===Tt.effects[Tt.effectSel].trailDelete&&(Tt.effects[Tt.effectSel].trailDelete=!1),Tt.effectsNSM.pages[0].items.push(Q.tileID,Q.trailLength,Q.trailSpacing,Q.trailAlpha,Q.trailColor,Q.trailDelete)}for(var ut=[],i=0;i<Hi.length;i++)ut.push(i);T=0;9===Tt.effects[Tt.effectSel].type&&(T=1),Tt.effectsNSM.pages[T].items.push({type:"dropdown",name:"edit_effects_item_easeType",hint:"edit_effects_item_easeType_sub",var:[Tt.effects[Tt.effectSel],"easeType"],options:ut,labels:Hi}),Tt.effectsNSM.pages[0].items.push({type:"button",name:"edit_effects_item_deselectAutomation",event:function(){Tt.effectMultiSel=[],Tt.effectMultiSelLast=!1,Tt.effectSelLast=!0},hint:"edit_effects_item_deselectAutomation_sub"}),Tt.effectSelLast=Tt.effectSel,Tt.effectTypeLast=Tt.effects[Tt.effectSel].type}else if(1<Tt.effectMultiSel.length&&Tt.effectMultiSelLast!==Tt.effectMultiSel){Tt.effectMultiSelLast=Tt.effectMultiSel,Tt.effectsNSM.pages=[{title:"edit_effects_automation",items:[]},{title:"edit_effects_customize",items:[]}];for(var I={time:[],moveTime:[],track:[],disabled:[]},i=0;i<Tt.effectMultiSel.length;i++){Oe=Tt.effectMultiSel[i];I.time.push([Tt.effects[Oe],"time"]),I.moveTime.push([Tt.effects[Oe],"moveTime"]),I.track.push([Tt.effects[Oe],"track"]),I.disabled.push([Tt.effects[Oe],"disabled"])}Tt.effectsNSM.pages[0].items.push({type:"number",name:"edit_effects_item_startTime",hint:"edit_effects_item_startTime_sub",min:!1,max:!1,bigChange:1,smallChange:[Tt,"snap"],multiple:!0,vars:I.time,update:function(e){e.bigChange=Xt({recieve:"raw",time:1,bpm:Tt.timelineBPM,offset:0,lvlBPM:Tt.bpm}),e.smallChange=Xt({recieve:"raw",time:Tt.snap,bpm:Tt.timelineBPM,offset:0,lvlBPM:Tt.bpm})}},{type:"number",name:"edit_effects_item_duration",hint:"edit_effects_item_duration_sub",min:0,max:!1,bigChange:1,smallChange:[Tt,"snap"],multiple:!0,vars:I.moveTime,update:function(e){e.bigChange=Xt({recieve:"raw",time:1,bpm:Tt.timelineBPM,offset:0,lvlBPM:Tt.bpm}),e.smallChange=Xt({recieve:"raw",time:Tt.snap,bpm:Tt.timelineBPM,offset:0,lvlBPM:Tt.bpm})}},{type:"button",name:"edit_effects_item_deselectAutomation",event:function(){Tt.effectMultiSel=[],Tt.effectMultiSelLast=!1,Tt.effectSelLast=!0},hint:"edit_effects_item_deselectAutomation_sub"},{type:"button",name:"edit_delete_multiple",keys:[String(Tt.effectMultiSel.length)],hint:"edit_effects_item_deleteAutomation_sub",event:()=>{_o.activate("edit_delete_confirmEffects",[String(Tt.effectMultiSel.length)],()=>{const t=Symbol();for(const e of Tt.effectMultiSel)Tt.effects[e]=t;Tt.effects=Tt.effects.filter(e=>e!==t),Tt.effectMultiSel=[],Tt.effectMultiSelLast=!1,Tt.effectSelLast=!0,Tt.effectsTabSel=0})}}),Tt.effectsNSM.pages[1].items.push({type:"number",name:"edit_effects_item_track",hint:"edit_effects_item_track_sub",min:0,max:21,bigChange:3,smallChange:1,multiple:!0,vars:I.track},{type:"boolean",name:"edit_effects_item_disable",vars:I.disabled,hint:"edit_effects_item_disable_sub",multiple:!0},{type:"button",name:"edit_select_item_copy",event:On,hint:"edit_select_item_copy_sub"})}Tt.effectsNSM.draw({x:width-width/4,y:height/16*2,width:width/4,height:height/16*12,stacked:!0,maxBarHeight:height/16/1.25,buffer:height/16*12/128}),fill(255,200),textAlign(LEFT,TOP),textSize(kt/2.5),text(Zn(),kt,height/16+kt)}else if(0===Tt.editorMode&&0<Tt.selectedBeats.length){if(fill(0,0,0,200),rectMode(CORNER),noStroke(),rect(width-width/4,height/16*3,width/2,height/16*10,(width<height?width:height)/32),!Xi(Tt.sbeatsLast,Tt.selectedBeats)){for(var vt=[],i=0;i<Tt.transitionNames.length;i++)vt.push(i);for(I={time:[],holdLength:[],beatColor:[],beatSaturation:[],beatBrightness:[]},i=0;i<Tt.selectedBeats.length;i++)I.time.push([Tt.beat[Tt.selectedBeats[i]],"1"]),I.holdLength.push([Tt.beat[Tt.selectedBeats[i]],"6"]),I.beatColor.push([Tt.beat[Tt.selectedBeats[i]],"11"]),I.beatSaturation.push([Tt.beat[Tt.selectedBeats[i]],"16"]),I.beatBrightness.push([Tt.beat[Tt.selectedBeats[i]],"17"]);if(Tt.beatNSM.pages=[{title:"edit_select_metadata",items:[]},{title:"edit_select_transformations",items:[]}],1===Tt.selectedBeats.length){function mt(t){var e=Tt.selectedBeats[0];if(void 0!==e){const o=Tt.beat[e];if(o){var i=Tt.timelineTickFor(o[1]);for(let e=Tt.selectedBeats.length=0;e<Tt.beat.length;e++){const o=Tt.beat[e];t(i,Tt.timelineTickFor(o[1]))&&Tt.selectedBeats.push(e)}}}}Tt.beatNSM.pages[0].items.push({type:"number",name:"edit_select_item_time",hint:"edit_select_item_time_sub",var:[Tt.beat[Tt.selectedBeats[0]],"1"],min:!1,max:!1,bigChange:1,smallChange:[Tt,"snap"],display:function(){return Xt({recieve:"bpm",time:Tt.beat[Tt.selectedBeats[0]][1],bpm:Tt.beat[Tt.selectedBeats[0]][9],offset:Tt.beat[Tt.selectedBeats[0]][10],lvlBPM:Tt.bpm})},update:function(e){e.bigChange=Xt({recieve:"raw",time:1,bpm:Tt.beat[Tt.selectedBeats[0]][9],offset:0,lvlBPM:Tt.bpm}),e.smallChange=Xt({recieve:"raw",time:Tt.snap,bpm:Tt.beat[Tt.selectedBeats[0]][9],offset:0,lvlBPM:Tt.bpm})},convert:function(e){return Xt({recieve:"raw",time:e,bpm:Tt.beat[Tt.selectedBeats[0]][9],offset:Tt.beat[Tt.selectedBeats[0]][10],lvlBPM:Tt.bpm})}},{type:"number",name:"edit_select_item_bpm",hint:"edit_select_item_bpm_sub",var:[Tt.beat[Tt.selectedBeats[0]],"9"],min:0,max:!1,bigChange:10,smallChange:1},{type:"number",name:"edit_select_item_offset",hint:"edit_select_item_offset_sub",var:[Tt.beat[Tt.selectedBeats[0]],"10"],min:!1,max:!1,bigChange:10,smallChange:1}),1===Tt.beat[Tt.selectedBeats[0]][5]&&Tt.beatNSM.pages[0].items.push({type:"number",name:"edit_tool_object_holdLength",hint:"edit_tool_object_holdLength_sub",var:[Tt.beat[Tt.selectedBeats[0]],"6"],min:0,max:!1,bigChange:1,smallChange:[Tt,"snap"],display:function(){return Xt({recieve:"bpm",time:Tt.beat[Tt.selectedBeats[0]][6],bpm:Tt.beat[Tt.selectedBeats[0]][9],offset:0,lvlBPM:Tt.bpm})},update:function(e){e.bigChange=Xt({recieve:"raw",time:1,bpm:Tt.beat[Tt.selectedBeats[0]][9],offset:0,lvlBPM:Tt.bpm}),e.smallChange=Xt({recieve:"raw",time:Tt.snap,bpm:Tt.beat[Tt.selectedBeats[0]][9],offset:0,lvlBPM:Tt.bpm})},convert:function(e){return Xt({recieve:"raw",time:e,bpm:Tt.beat[Tt.selectedBeats[0]][9],offset:0,lvlBPM:Tt.bpm})}}),Tt.beatNSM.pages[0].items.push({type:"color",name:"edit_select_item_beatColor",hint:"edit_select_item_beatColor_sub",mode:HSB,hue:[Tt.beat[Tt.selectedBeats[0]],"11"],saturation:[Tt.beat[Tt.selectedBeats[0]],"16"],brightness:[Tt.beat[Tt.selectedBeats[0]],"17"]},{name:"edit_select_item_transitionIn",type:"dropdown",hint:"edit_select_item_transitionIn_sub",var:[Tt.beat[Tt.selectedBeats[0]],"13"],options:vt,labels:Tt.transitionNames},{name:"edit_select_item_transitionOut",type:"dropdown",hint:"edit_select_item_transitionOut_sub",var:[Tt.beat[Tt.selectedBeats[0]],"14"],options:vt,labels:Tt.transitionNames}),Tt.beatNSM.pages.push({title:"edit_select_quickSelect",items:[]}),Tt.beatNSM.pages[Tt.beatNSM.pages.length-1].items.push({type:"button",name:"edit_select_item_selectBefore",hint:"edit_select_item_selectBefore_sub",event:()=>mt((e,t)=>t<=e)},{type:"button",name:"edit_select_item_selectCurrent",hint:"edit_select_item_selectCurrent_sub",event:()=>mt((e,t)=>t===e)},{type:"button",name:"edit_select_item_selectAfter",hint:"edit_select_item_selectAfter_sub",event:()=>mt((e,t)=>e<=t)})}else{for(var pt=!1,i=0;i<Tt.selectedBeats.length;i++)if(0===Tt.beat[Tt.selectedBeats[i]][5]){pt=!0;break}Tt.beatNSM.pages[0].items.push({type:"number",name:"edit_select_item_time",hint:"edit_select_item_time_sub",min:!1,max:!1,bigChange:1,smallChange:[Tt,"snap"],multiple:!0,vars:I.time,update:function(e){e.bigChange=Xt({recieve:"raw",time:1,bpm:Tt.timelineBPM,offset:0,lvlBPM:Tt.bpm}),e.smallChange=Xt({recieve:"raw",time:Tt.snap,bpm:Tt.timelineBPM,offset:0,lvlBPM:Tt.bpm})}}),pt||Tt.beatNSM.pages[0].items.push({type:"number",name:"edit_tool_object_holdLength",hint:"edit_tool_object_holdLength_sub",min:0,max:!1,bigChange:1,smallChange:[Tt,"snap"],multiple:!0,vars:I.holdLength,update:function(e){e.bigChange=Xt({recieve:"raw",time:1,bpm:Tt.timelineBPM,offset:0,lvlBPM:Tt.bpm}),e.smallChange=Xt({recieve:"raw",time:Tt.snap,bpm:Tt.timelineBPM,offset:0,lvlBPM:Tt.bpm})}}),Tt.beatNSM.pages[0].items.push({type:"color",name:"edit_select_item_beatColor",hint:"edit_select_item_beatColor_sub",mode:HSB,multiple:!0,hues:I.beatColor,saturations:I.beatSaturation,brightnesses:I.beatBrightness})}Tt.beatNSM.pages[0].items.push({type:"button",name:"edit_select_item_copy",event:On,hint:"edit_select_item_copy_sub"},{type:"button",name:"edit_effects_item_deselectAutomation",event:function(){Tt.selectedBeats=[]},hint:"edit_effects_item_deselectAutomation_sub"}),Tt.beatNSM.pages[1].items.push({type:"button",name:"edit_select_item_rotateCW",hint:"edit_select_item_rotateCW_sub",event:()=>ds([2,5,8,1,4,7,0,3,6])},{type:"button",name:"edit_select_item_rotateCCW",hint:"edit_select_item_rotateCCW_sub",event:()=>ds([6,3,0,7,4,1,8,5,2])},{type:"button",name:"edit_select_item_cycleCW",hint:"edit_select_item_cycleCW_sub",event:()=>ds([1,2,5,0,4,8,3,6,7])},{type:"button",name:"edit_select_item_cycleCCW",hint:"edit_select_item_cycleCCW_sub",event:()=>ds([3,0,1,6,4,2,7,8,5])},{type:"button",name:"edit_select_item_flipH",hint:"edit_select_item_flipH_sub",event:()=>ds([2,1,0,5,4,3,8,7,6])},{type:"button",name:"edit_select_item_flipV",hint:"edit_select_item_flipV_sub",event:()=>ds([6,7,8,3,4,5,0,1,2])}),1===Tt.selectedBeats.length&&Tt.beatNSM.pages[0].items.push({type:"button",name:"edit_effects_item_deleteAutomation",event:function(){Tt.beat.splice(Tt.selectedBeats[0],1),Tt.selectedBeats=[]},hint:"edit_effects_item_deleteAutomation_sub"}),1<Tt.selectedBeats.length&&Tt.beatNSM.pages[0].items.push({type:"button",name:"edit_delete_multiple",keys:[String(Tt.selectedBeats.length)],hint:"edit_effects_item_deleteAutomation_sub",event:()=>{_o.activate("edit_delete_confirmNotes",[String(Tt.selectedBeats.length)],()=>{const t=Symbol();for(const e of Tt.selectedBeats)Tt.beat[e]=t;Tt.beat=Tt.beat.filter(e=>e!==t),Tt.selectedBeats=[]})}}),Tt.sbeatsLast=Tt.selectedBeats.concat()}Tt.beatNSM.draw({x:width-width/4,y:height/16*3,width:width/4,height:height/16*10,stacked:!0,maxBarHeight:height/16/1.25,buffer:height/16*12/128})}}else fill(0,0,0,200),rectMode(CORNER),noStroke(),rect(width-width/4,height/16*3,width/2,height/16*10,(width<height?width:height)/32),Xi(Tt.sectionsSelectedLast,Tt.sectionsSelected)||(Tt.sectionsNSM.pages=[{title:"edit_sections_information",items:[]}],Tt.sectionsNSM.pages[0].items.push({type:"number",name:"edit_effects_item_startTime",hint:"edit_effects_item_startTime_sub",min:!1,max:!1,var:[Tt.sections[Tt.sectionsSelected[0]],"time"],bigChange:1,smallChange:[Tt,"snap"],display:function(){return Xt({recieve:"bpm",time:Tt.sections[Tt.sectionsSelected[0]].time,bpm:Tt.sections[Tt.sectionsSelected[0]].bpm,offset:Tt.sections[Tt.sectionsSelected[0]].offset,lvlBPM:Tt.bpm})},update:function(e){e.bigChange=Xt({recieve:"raw",time:1,bpm:Tt.sections[Tt.sectionsSelected[0]].bpm,offset:0,lvlBPM:Tt.bpm}),e.smallChange=Xt({recieve:"raw",time:Tt.snap,bpm:Tt.sections[Tt.sectionsSelected[0]].bpm,offset:0,lvlBPM:Tt.bpm})},convert:function(e){return Xt({recieve:"raw",time:e,bpm:Tt.sections[Tt.sectionsSelected[0]].bpm,offset:Tt.sections[Tt.sectionsSelected[0]].offset,lvlBPM:Tt.bpm})}},{type:"number",name:"edit_select_item_bpm",hint:"edit_select_item_bpm_sub",var:[Tt.sections[Tt.sectionsSelected[0]],"bpm"],min:0,max:!1,bigChange:10,smallChange:1},{type:"number",name:"edit_select_item_offset",hint:"edit_select_item_offset_sub",var:[Tt.sections[Tt.sectionsSelected[0]],"offset"],min:!1,max:!1,bigChange:10,smallChange:1},{type:"string",name:"edit_sections_name",hint:"edit_sections_name_sub",var:[Tt.sections[Tt.sectionsSelected[0]],"name"]},{type:"color",name:"edit_effects_item_displayColor",hint:"edit_effects_item_displayColor_sub",mode:HSB,hue:[Tt.sections[Tt.sectionsSelected[0]],"color"],saturation:[Tt.sections[Tt.sectionsSelected[0]],"saturation"],brightness:[Tt.sections[Tt.sectionsSelected[0]],"brightness"]},{type:"boolean",name:"edit_sections_visible",hint:"edit_sections_visible_sub",var:[Tt.sections[Tt.sectionsSelected[0]],"visible"]},{type:"button",name:"edit_sections_align",hint:"edit_sections_align_sub",event:()=>{var e=Tt.sectionsSelected[0];void 0!==e&&(e=Tt.sections[e])&&(Tt.timelineBPM=e.bpm,Tt.timelineOffset=e.offset)}},{type:"button",name:"edit_effects_item_deselectAutomation",event:function(){Tt.sectionsSelected=[]},hint:"edit_effects_item_deselectAutomation_sub"},{type:"button",name:"edit_effects_item_deleteAutomation",event:function(){Tt.sections.splice(Tt.sectionsSelected[0],1),Tt.sectionsSelected=[]},hint:"edit_effects_item_deleteAutomation_sub"}),Tt.sectionsSelectedLast=Tt.sectionsSelected.concat()),Tt.sectionsNSM.draw({x:width-width/4,y:height/16*3,width:width/4,height:height/16*10,stacked:!0,maxBarHeight:height/16/1.25,buffer:height/16*12/128});if(Tt.showGUI&&(fill(255,200),textAlign(LEFT,BOTTOM),textSize(kt/2),text(Jt("edit_hint_keybinds_array",xt).join("\n"),kt,height-(height/16+kt)),fill(lerp(0,25,Tt.menuSize),lerp(200,255,Tt.menuSize)),rectMode(CORNER),noStroke(),rect(0,height-height/16*Tt.headerY,width,lerp(height/16*-(Tt.toolsH+1),-height,Tt.menuSize))),Tt.tools[1][3]=[],0===Tt.objType?(Tt.tools[1][0]="edit_tool_object_beat",Tt.tools[1][1]=St.objectBeat,Tt.tools[1][4]="edit_tool_object_beat"):(Tt.tools[1][0]="edit_tool_object_hold",Tt.tools[1][1]=St.objectHold,Tt.tools[1][3].push(["edit_tool_object_holdLengthVal",St.objectHoldTime,0,!1,!1,[Tt.holdLength]]),Tt.tools[1][4]="edit_tool_object_hold"),Tt.tools[1][3].push(["edit_tool_object_beatColor",St.beatColor,0,!1,!1,[Tt.beatColor,Tt.beatSaturation,Tt.beatBrightness]],["edit_tool_object_transitionIn",St.beatTransitionIn,0,!1,!1,[Tt.transitionNames[Tt.transitionIn]]],["edit_tool_object_transitionOut",St.beatTransitionOut,0,!1,!1,[Tt.transitionNames[Tt.transitionOut]]]),.5===Tt.playbackRate?Tt.tools[2][1]=St.playbackHalf:Tt.tools[2][1]=St.playbackFull,0===Tt.editorMode?(Tt.tools[7][0]="edit_tool_mode_gameplay",Tt.tools[7][1]=St.editorModeGameplay):(Tt.tools[7][0]="edit_tool_mode_effects",Tt.tools[7][1]=St.editorModeEffects),Tt.tools[2][0]="edit_tool_playback",Tt.tools[2][5]=[Tt.playbackRate],void 0!==Qt[Tt.song]&&Qt[Tt.song].rate(Tt.playbackRate),Tt.tools[3][0]="edit_tool_timeline",Tt.tools[3][1]=St.timelineTools,Tt.tools[3][4]="edit_tool_timeline",Tt.tools[3][3]=[],Tt.tools[3][3].push(["edit_tool_snap",St.timelineSnap,0,!1,!1,["1/"+Ot(1/Tt.snap)]],["edit_tool_bpm",St.metronome,0,!1,!1,[Tt.timelineBPM]],["edit_tool_bpm_offset",St.timelineOffset,0,!1,!1,[Pt("milliseconds_short",xt,Tt.timelineOffset)]],["edit_tool_section",St.bookmark,0],["edit_tool_timestamp",St.jumpToTimestamp,0]),"scroll"===Tt.timelineMode?(Tt.tools[4][0]="edit_tool_timelineMode",Tt.tools[4][1]=St.clickModeScroll,Tt.tools[4][5]=[Pt("edit_timelineMode_scroll",xt)],Tt.selectedBeats=[],Tt.sectionsSelected=[]):"select"===Tt.timelineMode&&(Tt.tools[4][0]="edit_tool_timelineMode",Tt.tools[4][1]=St.clickModeSelect,Tt.tools[4][5]=[Pt("edit_timelineMode_select",xt)]),Tt.saveNoticeDis+=At(Tt.saveNotice,Tt.saveNoticeDis,.15),Ot(100*Tt.saveNoticeDis)/100==1&&(Tt.saveNotice=0),textAlign(RIGHT,TOP),fill(255),Dt(Pt("edit_menu_item_saved",xt),width-kt,height+2*kt-Tt.saveNoticeDis*(6*kt),width,kt),!1===Tt.menu){if(Tt.saved=!1,Tt.showGUI)for(i=0;i<Tt.tools.length;i++){if(Ft("rcorner",width/Tt.tools.length*i,height-height/16*Tt.headerY,width/Tt.tools.length,height/16*-(Tt.toolsH+1)*(!1!==Tt.tools[i][3]?+Tt.tools[i][2]+1:1))?Tt.tools[i][2]+=At(1,Tt.tools[i][2],.2):Tt.tools[i][2]+=At(0,Tt.tools[i][2],.1),!1!==Tt.tools[i][3])for(pt=!1,t=0;t<Tt.tools[i][3].length+1;t++)t<Tt.tools[i][3].length?Ft("rcorner",width/Tt.tools.length*i+width/Tt.tools.length/Tt.tools[i][3].length*t,height-height/32*(Tt.toolsH+1)*(4*Tt.tools[i][2]),width/Tt.tools.length/Tt.tools[i][3].length,height/16*(Tt.toolsH+1))?(Tt.tools[i][3][t][2]+=At(1,Tt.tools[i][3][t][2],.2),Tt.tools[i][0]=Tt.tools[i][3][t][0],Tt.tools[i][5]=Tt.tools[i][3][t][5],pt=!0):Tt.tools[i][3][t][2]+=At(0,Tt.tools[i][3][t][2],.2):!1===pt&&(Tt.tools[i][0]=Tt.tools[i][4]);textSize(height/32*(Tt.toolsH+1));var bt="",bt=void 0!==Tt.tools[i][5]?Pt(Tt.tools[i][0],xt,Tt.tools[i][5][0],Tt.tools[i][5][1],Tt.tools[i][5][2],Tt.tools[i][5][3],Tt.tools[i][5][4]):Pt(Tt.tools[i][0],xt),wt=width/Tt.tools.length*i,Ct=textWidth(bt)+height/32*(Tt.toolsH+1),yt=1;if((wt=wt<height/32*(Tt.toolsH+1)/2?height/32*(Tt.toolsH+1)/2:wt)+Ct>width-height/32*(Tt.toolsH+1)/2&&(wt=width-height/32*(Tt.toolsH+1)/2-Ct),!1!==Tt.tools[i][3]&&(yt=1.5),fill(25,255),ellipseMode(CORNER),rect(wt,height-height/32*(Tt.toolsH+1)*(4*yt*Tt.tools[i][2]),Ct,height/32*(Tt.toolsH+1)*1.5,height/32*(Tt.toolsH+1)*2),fill(255),textAlign(CENTER,CENTER),text(bt,wt+(textWidth(bt)+height/32*(Tt.toolsH+1))/2,height-height/32*(Tt.toolsH+1)*(4*yt*Tt.tools[i][2])+height/32*(Tt.toolsH+1)*1.5/2),!1!==Tt.tools[i][3]){rectMode(CORNER),fill(0,200*Tt.tools[i][2]),rect(width/Tt.tools.length*i,height-height/32*(Tt.toolsH+1)*(4*Tt.tools[i][2]),width/Tt.tools.length,height/16*(Tt.toolsH+1));for(t=0;t<Tt.tools[i][3].length;t++)fill(25,255*Tt.tools[i][3][t][2]*Tt.tools[i][3].length),rect(width/Tt.tools.length*i+width/Tt.tools.length/Tt.tools[i][3].length*t,height-height/32*(Tt.toolsH+1)*(4*Tt.tools[i][2]),width/Tt.tools.length/Tt.tools[i][3].length,height/16*(Tt.toolsH+1)),imageMode(CENTER),smooth(),image(Tt.tools[i][3][t][1],width/Tt.tools.length*i+width/Tt.tools.length/Tt.tools[i][3].length*t+width/Tt.tools.length/Tt.tools[i][3].length/2,height-height/32*(Tt.toolsH+1)*(4*Tt.tools[i][2])+height/16*(Tt.toolsH+1)/2,height/16*-(Tt.toolsH+1)/1.5,height/16*-(Tt.toolsH+1)/1.5)}rectMode(CORNER),fill(25,255*Tt.tools[i][2]),rect(width/Tt.tools.length*i,height-height/16*Tt.headerY,width/Tt.tools.length,height/16*-(Tt.toolsH+1)),imageMode(CENTER),image(Tt.tools[i][1],width/Tt.tools.length*i+width/Tt.tools.length/2,height-height/16*Tt.headerY+height/16*-(Tt.toolsH+1)/2,height/16*-(Tt.toolsH+1)/1.5,height/16*-(Tt.toolsH+1)/1.5)}}else Tt.playing&&en(),rectMode(CORNER),Tt.menuNSM.draw({x:0,y:0,width:width,height:height,stacked:!1,maxBarHeight:height/15,buffer:(height-height/16)/64}),Tt.ar=Tt.bpm/60/2*Tt.oldAr,Tt.arInit=Tt.ar,push(),translate(width*(1-(Tt.menuHLX/(width/(Tt.menuItems.length+1))-1)),0),textAlign(CENTER,CENTER),fill(255),!0!==Lt(Tt.song,"id").error&&void 0===Qt[Tt.song]&&(ei=ti=!1,ho(Tt.song)),pop(),rectMode(CENTER),fill(255),rect(width/Tt.tools.length*(Tt.tools.length-1)+width/Tt.tools.length/2,height-height/16+height/16/2,width/Tt.tools.length,height/16,height/64,0,0,0),fill(0),textAlign(CENTER,CENTER),Dt(Pt("menu_close",xt),width/Tt.tools.length*(Tt.tools.length-1)+width/Tt.tools.length/2,height-height/16+height/16/2,width/Tt.tools.length*.75,height/16*.75),Tt.exiting&&(rectMode(CORNER),fill(0,200),rect(0,0,width,height),textAlign(CENTER,CENTER),fill(255),Dt(Pt("edit_menu_item_confirmExit",xt),width/2,height/4*1.5,width/1.5,height/4),H=(width/2-2*kt)/1.5,R=height/4/1.5,Kt(width/4-H/2,height/4*2.5-R/4,H,R,Pt("edit_menu_item_confirmExit_yes",xt),Tt.buttonHover,2),Kt(width/4*3-H/2,height/4*2.5-R/4,H,R,Pt("edit_menu_item_confirmExit_no",xt),Tt.buttonHover,3));if(qt&&(Rt=[],Rt=Uo(Ht.saved,"dateDesc"),Yi(Ht.saved.indexOf(Rt[Tt.lvlSel])),qt=!1),Zt&&!1===Tt.menu&&!Nt.active&&(0===Tt.editorMode?(0<Tt.selectedBeats.length?On:Nn)():1===Tt.editorMode&&(0<Tt.effectMultiSel.length?On:Nn)(),Zt=!1),jt&&!1===Tt.menu&&!Nt.active&&(zn(),jt=!1),0!==Mt())for(var Et=Ot(Mt()/33/4),i=0;i<abs(Et);i++)qn(Et<0?"LEFT":"RIGHT",Gt,Yt);Vt*=.25,colorMode(HSB),fill(Tt.beatColor,Tt.beatSaturation,Tt.beatBrightness,200),"scroll"===Tt.timelineMode&&0===Tt.editorMode?0===Tt.objType?rect(mouseX-.5*kt,mouseY+.625*kt,kt/3,kt/3):1===Tt.objType&&(ellipseMode(CORNER),ellipse(mouseX-.5*kt,mouseY+.625*kt,kt/3,kt/3),textAlign(RIGHT,CENTER),textSize(kt/2),text(Tt.holdLength,mouseX-.75*kt,mouseY+.625*kt+kt/3/2)):"select"===Tt.timelineMode&&(colorMode(RGB),fill(255),imageMode(CORNER),image(St.select,mouseX-.5*kt,mouseY+.625*kt,kt/3,kt/3),textAlign(RIGHT,CENTER),textSize(kt/2),0<Tt.selectedBeats.length&&0===Tt.editorMode?text(Tt.selectedBeats.length,mouseX-.75*kt,mouseY+.625*kt+kt/3/2):0<Tt.effectMultiSel.length&&1===Tt.editorMode?text(Tt.effectMultiSel.length,mouseX-.75*kt,mouseY+.625*kt+kt/3/2):0<Tt.sectionsSelected.length&&text(Tt.sectionsSelected.length,mouseX-.75*kt,mouseY+.625*kt+kt/3/2))}colorMode(RGB)},cs.musicTime=function(){var e,t;1===soundManager.getSoundById("menuMusic").playState&&(soundManager.stop("menuMusic"),soundManager.setVolume(Tt.song,Bt.settings.musicVolume)),!1===Tt.edit&&(!1===Tt.preLevelStart&&(Tt.preLevelStart=millis()),5e3<=millis()-Tt.preLevelStart+(Tt.songOffset+Tt.mods.offset+Bt.settings.offset)&&!Tt.songPlaying&&!Tt.paused?(Qt[Tt.song].rate(Tt.mods.bpm),Qt[Tt.song].volume(Bt.settings.musicVolume/100),e=Qt[Tt.song].play(),Qt[Tt.song].seek((Tt.songOffset+Tt.mods.offset+Bt.settings.offset)/1e3+(0===Tt.playingOffset?-5:Tt.playingOffset/120*60),e),Tt.songPlaying=!0):Tt.paused&&(Qt[Tt.song].pause(),Tt.songPlaying=!1)),Tt.edit||!1!==Tt.songEnded||Qt[Tt.song].on("end",function(){console.log("ENDED SONG"),Tt.songEnded=[millis(),Qt[Tt.song].duration]}),!1!==Tt.edit||Tt.paused||1!==Tt.disMode||(!1!==Tt.songPlaying||!1!==Ne&&"hidden"!==Ne||!1===Tt.preLevelStart?(console.log("Seek:"+Qt[Tt.song].seek()),t=((e=!1===Tt.songEnded?Qt[Tt.song].seek():Qt[Tt.song].duration()+(!1===Tt.songEnded?0:(millis()-Tt.songEnded[0])/1e3*Tt.mods.bpm))-(Tt.songOffset+Tt.mods.offset+Bt.settings.offset)/1e3)*(Tt.bpm/60)/Tt.mods.bpm,console.log("Song pos:"+e),console.log("Next time:"+t),(-1e3<(t-Tt.time)*Tt.mods.bpm/(Tt.bpm/60)||"set"===Tt.time)&&(Tt.time=t)):(Tt.time=(millis()-Tt.preLevelStart-5e3)/1e3*(Tt.bpm/60)/Tt.mods.bpm,console.log(Tt.time)))},cs.parseEffects=function(){var e=[];if(Tt.edit){for(var e=[],t=0;t<Tt.effects.length;t++)e.push(t);e.sort(function(e,t){return Tt.effects[e].time-Tt.effects[t].time})}if(Tt.effected.boardX=0,Tt.effected.boardY=0,Tt.effected.boardW=1,Tt.effected.boardH=1,Tt.effected.boardR=0,Tt.effected.boardA=1,Tt.effected.tileX=[0,0,0,0,0,0,0,0,0],Tt.effected.tileY=[0,0,0,0,0,0,0,0,0],Tt.effected.tileW=[1,1,1,1,1,1,1,1,1],Tt.effected.tileH=[1,1,1,1,1,1,1,1,1],Tt.effected.tileR=[0,0,0,0,0,0,0,0,0],Tt.effected.tileA=[1,1,1,1,1,1,1,1,1],Tt.effected.ar=0,Tt.effected.subtitles=[],Tt.effected.vignette=0,Tt.effected.letterboxX=0,Tt.effected.letterboxY=0,Tt.effected.tileColor=[141,141,141,141,141,141,141,141,141],Tt.effected.tileSaturation=[0,0,0,0,0,0,0,0,0],Tt.effected.tileBrightness=[255,255,255,255,255,255,255,255,255],Tt.effected.tileAlpha=[255,255,255,255,255,255,255,255,255],Tt.effected.tileOverlayColor=[141,141,141,141,141,141,141,141,141],Tt.effected.tileOverlaySaturation=[0,0,0,0,0,0,0,0,0],Tt.effected.tileOverlayBrightness=[255,255,255,255,255,255,255,255,255],Tt.effected.tileOverlayAlpha=[255,255,255,255,255,255,255,255,255],Tt.effected.foregroundOverlayColor=141,Tt.effected.foregroundOverlaySaturation=255,Tt.effected.foregroundOverlayBrightness=255,Tt.effected.foregroundOverlayAlpha=0,Tt.effected.backgroundOverlayColor=141,Tt.effected.backgroundOverlaySaturation=255,Tt.effected.backgroundOverlayBrightness=255,Tt.effected.backgroundOverlayAlpha=0,Tt.effected.tileTrailLength=[0,0,0,0,0,0,0,0,0],Tt.effected.tileTrailSpacing=[25,25,25,25,25,25,25,25,25],Tt.effected.tileTrailAlpha=[.5,.5,.5,.5,.5,.5,.5,.5,.5],Tt.effected.tileTrailColor=[!0,!0,!0,!0,!0,!0,!0,!0,!0],Tt.effected.tileTrailDelete=[0,0,0,0,0,0,0,0,0],Tt.edit&&1===Tt.editorMode){Tt.drawEffects=[];for(var i=0;i<e.length;i++){t=e[i];void 0!==Tt.effects[t]&&(6!==Tt.effects[t].type||null!==Tt.effects[t].time&&void 0!==Tt.effects[t].time?(Tt.time>=Tt.effects[t].time&&In("effected",Tt.effects[t]),1===Tt.editorMode&&Tt.showGUI&&Tt.effects[t].time<=Tt.time+5&&Tt.effects[t].time+Tt.effects[t].moveTime>=Tt.time-5&&Tt.drawEffects.push(t)):Tt.effects.splice(t,1))}}if(!Tt.edit&&!Tt.mods.noEffects){void 0===Tt.effectsCache.boardX&&(Tt.effectsCache.boardX=0,Tt.effectsCache.boardY=0,Tt.effectsCache.boardW=1,Tt.effectsCache.boardH=1,Tt.effectsCache.boardR=0,Tt.effectsCache.boardA=1,Tt.effectsCache.tileX=[0,0,0,0,0,0,0,0,0],Tt.effectsCache.tileY=[0,0,0,0,0,0,0,0,0],Tt.effectsCache.tileW=[1,1,1,1,1,1,1,1,1],Tt.effectsCache.tileH=[1,1,1,1,1,1,1,1,1],Tt.effectsCache.tileR=[0,0,0,0,0,0,0,0,0],Tt.effectsCache.tileA=[1,1,1,1,1,1,1,1,1],Tt.effectsCache.ar=0,Tt.effectsCache.subtitles=[],Tt.effectsCache.vignette=0,Tt.effectsCache.letterboxX=0,Tt.effectsCache.letterboxY=0,Tt.effectsCache.tileColor=[141,141,141,141,141,141,141,141,141],Tt.effectsCache.tileSaturation=[0,0,0,0,0,0,0,0,0],Tt.effectsCache.tileBrightness=[255,255,255,255,255,255,255,255,255],Tt.effectsCache.tileAlpha=[255,255,255,255,255,255,255,255,255],Tt.effectsCache.tileOverlayColor=[141,141,141,141,141,141,141,141,141],Tt.effectsCache.tileOverlaySaturation=[0,0,0,0,0,0,0,0,0],Tt.effectsCache.tileOverlayBrightness=[255,255,255,255,255,255,255,255,255],Tt.effectsCache.tileOverlayAlpha=[255,255,255,255,255,255,255,255,255],Tt.effectsCache.foregroundOverlayColor=141,Tt.effectsCache.foregroundOverlaySaturation=255,Tt.effectsCache.foregroundOverlayBrightness=255,Tt.effectsCache.foregroundOverlayAlpha=0,Tt.effectsCache.backgroundOverlayColor=141,Tt.effectsCache.backgroundOverlaySaturation=255,Tt.effectsCache.backgroundOverlayBrightness=255,Tt.effectsCache.backgroundOverlayAlpha=0,Tt.effectsCache.tileTrailLength=[0,0,0,0,0,0,0,0,0],Tt.effectsCache.tileTrailSpacing=[25,25,25,25,25,25,25,25,25],Tt.effectsCache.tileTrailAlpha=[.5,.5,.5,.5,.5,.5,.5,.5,.5],Tt.effectsCache.tileTrailColor=[!0,!0,!0,!0,!0,!0,!0,!0,!0],Tt.effectsCache.tileTrailDelete=[0,0,0,0,0,0,0,0,0]),Tt.effected.boardX=Tt.effectsCache.boardX,Tt.effected.boardY=Tt.effectsCache.boardY,Tt.effected.boardW=Tt.effectsCache.boardW,Tt.effected.boardH=Tt.effectsCache.boardH,Tt.effected.boardR=Tt.effectsCache.boardR,Tt.effected.boardA=Tt.effectsCache.boardA;for(t=0;t<9;t++)Tt.effected.tileX[t]=Tt.effectsCache.tileX[t],Tt.effected.tileY[t]=Tt.effectsCache.tileY[t],Tt.effected.tileW[t]=Tt.effectsCache.tileW[t],Tt.effected.tileH[t]=Tt.effectsCache.tileH[t],Tt.effected.tileR[t]=Tt.effectsCache.tileR[t],Tt.effected.tileA[t]=Tt.effectsCache.tileA[t],Tt.effected.tileColor[t]=Tt.effectsCache.tileColor[t],Tt.effected.tileSaturation[t]=Tt.effectsCache.tileSaturation[t],Tt.effected.tileBrightness[t]=Tt.effectsCache.tileBrightness[t],Tt.effected.tileAlpha[t]=Tt.effectsCache.tileAlpha[t],Tt.effected.tileOverlayColor[t]=Tt.effectsCache.tileOverlayColor[t],Tt.effected.tileOverlaySaturation[t]=Tt.effectsCache.tileOverlaySaturation[t],Tt.effected.tileOverlayBrightness[t]=Tt.effectsCache.tileOverlayBrightness[t],Tt.effected.tileOverlayAlpha[t]=Tt.effectsCache.tileOverlayAlpha[t],Tt.effected.tileTrailLength[t]=Tt.effectsCache.tileTrailLength[t],Tt.effected.tileTrailSpacing[t]=Tt.effectsCache.tileTrailSpacing[t],Tt.effected.tileTrailAlpha[t]=Tt.effectsCache.tileTrailAlpha[t],Tt.effected.tileTrailColor[t]=Tt.effectsCache.tileTrailColor[t],Tt.effected.tileTrailDelete[t]=Tt.effectsCache.tileTrailDelete[t];Tt.effected.ar=Tt.effectsCache.ar,Tt.effected.subtitles=[],Tt.effected.vignette=Tt.effectsCache.vignette,Tt.effected.letterboxX=Tt.effectsCache.letterboxX,Tt.effected.letterboxY=Tt.effectsCache.letterboxY,Tt.effected.foregroundOverlayColor=Tt.effectsCache.foregroundOverlayColor,Tt.effected.foregroundOverlaySaturation=Tt.effectsCache.foregroundOverlaySaturation,Tt.effected.foregroundOverlayBrightness=Tt.effectsCache.foregroundOverlayBrightness,Tt.effected.foregroundOverlayAlpha=Tt.effectsCache.foregroundOverlayAlpha,Tt.effected.backgroundOverlayColor=Tt.effectsCache.backgroundOverlayColor,Tt.effected.backgroundOverlaySaturation=Tt.effectsCache.backgroundOverlaySaturation,Tt.effected.backgroundOverlayBrightness=Tt.effectsCache.backgroundOverlayBrightness,Tt.effected.backgroundOverlayAlpha=Tt.effectsCache.backgroundOverlayAlpha;for(t=0;t<Tt.effects.length&&!(Tt.effects[t].time>Tt.time);t++)Tt.effectsFinished[t]||(Tt.effects[t].time+Tt.effects[t].moveTime<Tt.time&&(Tt.effectsFinished[t]=!0,In("cache",Tt.effects[t])),In("effected",Tt.effects[t]))}},cs.paused=function(){var e,t,i;Tt.paused?(void 0===Tt.pauseMillis&&(Tt.pauseMillis=millis()),cursor(),i=t=e=0,i=Tt.retry?(e=1+It(millis()-Tt.retryMillis,500,-1,26),t=-width/4*3,lerp(200,0,constrain((millis()-Tt.retryMillis)/500,0,1))):(t=!1===Tt.resumeTime?(e=It(millis()-Tt.pauseMillis,750,1,26),width/4):(e=1+It(millis()-Tt.resumeTime,1500,-1,26),-width/4*3),lerp(0,200,constrain((millis()-Tt.pauseMillis)/500,0,1))),rectMode(CORNER),fill(0,i),rect(0,0,width,height),fill(255,i),textAlign(LEFT,TOP),textSize(height/64),text(Pt("game_paused",xt),kt,kt),noStroke(),push(),translate(lerp(-t,0,e),0),Kt(width/2-width/4/2,height/2-height/8/2-height/8*1.25,width/4,height/8,Pt("game_continue",xt),Tt.buttonHover,2),Kt(width/2-width/4/2,height/2-height/8/2+height/8*1.25,width/4,height/8,Pt("game_backToMenu",xt),Tt.buttonHover,1),pop(),push(),translate(lerp(t,0,e),0),Kt(width/2-width/4/2,height/2-height/8/2,width/4,height/8,Tt.replay.on?Pt("game_replayRetry",xt):Pt("game_retry",xt),Tt.buttonHover,0),pop(),!1!==Tt.resumeTime?(void 0===Tt.resumePos&&(Tt.resumePos=4),Tt.resumePos+=At(ceil(3-(millis()-Tt.resumeTime)/1e3),Tt.resumePos,.1),textAlign(CENTER,CENTER),fill(0,175,255),textSize(height/2),Un(width/2,height/2,height/3,.8,4-Tt.resumePos,[{text:"",color:color(255)},{text:"3",color:color(0,175,255)},{text:"2",color:color(0,175,255)},{text:"1",color:color(0,175,255)}]),ceil(3-(millis()-Tt.resumeTime)/1e3)<=0&&(Tt.timeStart=millis(),Tt.paused=!Tt.paused,Tt.resumeTime=!1),fill(255),Dt(Pt("game_resuming",xt),width/2,height/4,width/2/1.5,height/2/1.5)):Tt.resumePos=void 0):Tt.pauseMillis=void 0},cs.resultsScreen=function(){var e=""!==T.uuid&&!Tt.failed&&!Tt.mods.auto&&H(Rt[Bt.lvl.sel],"id").ranked&&!Tt.replay.on&&0===Tt.mods.startPos&&0===Tt.mods.endPos,t=(!Tt.scoreSubmitted&&e&&(B("saveNewScore",{log:Tt.newScore.log,press:Tt.newScore.press,release:Tt.newScore.release,lvl:Rt[Bt.lvl.sel],user:T.uuid,mods:Tt.mods,session:T.session}),Tt.scoreSubmitted=!0),!1===Tt.endMillis&&(Tt.endMillis=millis()),Tt.scoreFinal=Gi(Tt.newScore.log),Ot(Tt.scoreFinal*wn(Tt.mods,!0))),i=t/Tt.scoreMax,o=(cursor(),void 0===Tt.retryMillis?fill(0,lerp(0,245,Ln(Tt.endMillis,500,0,1))):fill(0,lerp(245,0,Ln(Tt.retryMillis,500,0,1))),rectMode(CORNER),noStroke(),rect(0,0,width,height+height/64),push(),void 0===Tt.retryMillis?translate(0,lerp(-height,0,Ln(Tt.endMillis,500,0,1))):translate(0,lerp(0,-height,Ln(Tt.retryMillis,500,0,1))),imageMode(CORNER),push(),noStroke(),fill(255,0),rectMode(CORNER),rect(0,0,width,height),drawingContext.clip(),!1!==Tt.bg?(imageMode(CENTER),Wt(_t("https://i.imgur.com/pUovCs5.png"===Tt.bg&&0<Bt.settings.defaultBackground.length?Bt.settings.defaultBackground:Tt.bg),"zoom",width/2,height/2,width,height)):(imageMode(CENTER),Wt(St.bg,"zoom",width/2,height/2,width,height)),pop(),rectMode(CORNER),fill(0,245),rect(0,0,width,height),fill(2,150),rect(kt,kt,width/3*2-kt,Ot(height/32)),fill(0,150),rect(kt,kt+Ot(height/32),width/3*2-kt,height/4-kt-Ot(height/32)),fill(255),textSize(height/64),textAlign(LEFT,CENTER),text(Pt("game_info_title",xt),kt+height/64/2,kt+height/64),push(),height/4-3*kt-Ot(height/32)),n=(translate(kt,2*kt+Ot(height/32)),St.defaultPP),s=Pt("defaultUsername",xt),r=void 0===Ut(Tt.author,"uuid").user?Pt("defaultUsername",xt):Ut(Tt.author,"uuid").user,n=(Tt.mods.auto?(s="Pulsus",n=St.logo):Tt.replay.on?(s=Ut(Tt.replay.user,"uuid").user,n=_t(Ut(Tt.replay.user,"uuid").pp)):""!==T.uuid&&(s=void 0===Ut(T.uuid,"uuid").user?Pt("defaultUsername",xt):Ut(T.uuid,"uuid").user,n=_t(Ut(T.uuid,"uuid").pp)),imageMode(CORNER),image(n,kt,0,o,o),translate(o+kt,0),fill(255),textAlign(LEFT,CENTER),textStyle(BOLD),textSize(o/2/1.25),Pt("game_levelComplete",xt));if(0===Tt.hitStats[Tt.hitValues.length-1]){for(var h=0,a=0;a<Tt.hitValues.length;a++)h+=Tt.hitStats[a];n=Tt.hitStats[0]===h?Pt("game_levelMarvelous",xt):Tt.hitStats[0]+Tt.hitStats[1]===h?Pt("game_levelPerfect",xt):Pt("game_levelFullCombo",xt)}Tt.failed&&(n=Pt("game_levelFailed",xt)),Tt.replay.on&&(n=Pt("game_replayComplete",xt)),text(n,kt,o/4),textStyle(NORMAL),textSize(o/4/1.25),text(Pt("game_info_level",xt,Tt.title,r,Ot(100*Tt.stars)/100),kt,o/2+o/8),text(Pt("game_info_play",xt,s,Vo(Tt.mods)),kt,o/2+o/4+o/8),pop(),fill(2,150),rect(kt,kt+height/4,width/3-kt,Ot(height/32)),fill(0,150),rect(kt,kt+height/4+Ot(height/32),width/3-kt,height/4*3-2*kt-Ot(height/32)),fill(255),textSize(height/64),textAlign(LEFT,CENTER),text(Pt("game_sections_title",xt),kt+height/64/2,kt+height/4+height/64),push(),translate(kt,kt+height/4+height/32);var n=height/32,l=1.25*n;textSize(n),0===Tt.sectionAcc.length&&0<Tt.sections.length&&(Tt.sectionAcc=Wn(Tt.sectionPerformance,Tt.sections)),fill(255);for(a=0;a<Tt.sections.length;a++){var d=Tt.sections[a+1];textAlign(LEFT,CENTER),text(Tt.sections[a].name,kt,l*a+kt),textAlign(RIGHT,CENTER),text((isNaN(Tt.sectionAcc[a])||d&&d.time<=0?"--.---":Tt.sectionAcc[a].toFixed(3))+"%",width/3-2*kt,l*a+kt)}pop(),fill(2,150),rect(width/3*2+kt,kt,width/3-2*kt,Ot(height/32)),fill(0,150),rect(width/3*2+kt,kt+Ot(height/32),width/3-2*kt,height/3*2-kt-Ot(height/32)),fill(255),textSize(height/64),textAlign(LEFT,CENTER),text(Pt("game_performance_title",xt),width/3*2+kt+height/64/2,kt+height/64),push();var g=width/3*2+kt,c=kt+Ot(height/32),f=(translate(g,c),width/3-4*kt),u=f/1920*1080;if(Tt.performanceDotCallback=null,!1===Tt.performanceChart)Tt.performanceChart=createGraphics(640,360,P2D),Vn(Tt.performanceChart,640,360,Tt.hw,Tt.hitValues,Tt.sectionPerformance,Tt.timeEnd);else{imageMode(CORNER),image(Tt.performanceChart,kt,kt,f,u);var v=u/75;let e=null;for(const x of Tt.sectionPerformance){var m=Kn(f,u,Tt.hitValues,Tt.timeEnd,x);Ft("ccenter",m[0]+kt+g,m[1]+kt+c,4*v,4*v)&&(e=x)}if(e){push();var r=Kn(f,u,Tt.hitValues,Tt.timeEnd,e),[s,n,p]=e;fill(Tt.hitValues[n].color),strokeWeight(v),stroke($.select),ellipseMode(CENTER),ellipse(r[0]+kt,r[1]+kt,4*v,4*v);const S=Math.floor(s/Tt.bpm*60*1e3+Tt.mods.startPos);n=(p/Tt.bpm*60*1e3).toFixed(3);$t=Pt("game_performanceDot_tooltip",xt,Pt("milliseconds_short",xt,S),Pt("milliseconds_short",xt,n)),Tt.performanceDotCallback=()=>{So(S),Gn({type:"success",message:"game_performanceDot_copied",keys:[Pt("milliseconds_short",xt,S)]})},pop()}}translate(0,f/1920*1080+2*kt);var b=height/3*2-2*kt-Ot(height/32)-kt-f/1920*1080;textSize(b/Tt.hitValues.length/1.25);for(a=0;a<Tt.hitValues.length;a++){var w=Tt.hitValues[a];fill(w.color),textAlign(LEFT,CENTER),text(w.name,kt,b/Tt.hitValues.length*a),textAlign(RIGHT,CENTER),text(Tt.hitStats[a],kt+f,b/Tt.hitValues.length*a)}pop(),fill(0,150),rect(kt+width/3,kt+height/4,width/3-kt,height/4*3-2*kt),push(),translate(kt/2,0);for(var C=[""],a=Tt.ranks.length-1;0<=a;a--){var y=Tt.ranks[a];C.push({text:y.symbol,color:on(a)})}var r=0,s=(Tt.failed||(r=Tt.ranks.length-tn(i)-1),r++,constrain(375*r,1e3,3e3)),p=(fill(255),textAlign(CENTER,CENTER),textStyle(BOLD),Un(width/2,height/2,5*kt,lerp(.5,1,Ln(Tt.endMillis,s,1,r+1)/(r+1)),Ln(Tt.endMillis,s,0,r),C),push(),Tt.ranks.length-Ln(Tt.endMillis,s,0,r)),n=color(255),s=(void 0!==Tt.ranks[floor(p)]&&void 0!==Tt.ranks[ceil(p)]?n=lerpColor(on(floor(p)),color(255),p-floor(p)):void 0!==Tt.ranks[floor(p)]?n=on(floor(p)):void 0!==Tt.ranks[ceil(p)]&&(n=on(ceil(p))),rectMode(CENTER),translate(width/2+kt/8,height/2),rotate(-67.5),noFill(),stroke(n),strokeWeight(kt),rect(0,0,8*kt,8*kt),push(),Tt.ranks.length-r),E=Tt.ranks[s],s=Tt.ranks[s-1],P=on(floor(p)),O=on(floor(p-1));noStroke(),fill(P),rect(0,5.5*kt,8*kt+kt,kt/2);let z;z=Tt.ranks.length-floor(p)===r?void 0===E||void 0===s?0:(P=Tt.ranks.length-r-p+1,lerp(0,(i-E.score)/(s.score-E.score),P)):ceil(p)-p,O&&(rectMode(CORNER),r=(8*kt+kt)*z,fill(O),rect(-(8*kt+kt)/2,5.5*kt-kt/4,r,kt/2)),pop(),textAlign(CENTER,CENTER),fill(n),textStyle(BOLD),textSize(2*kt),noStroke(),text(Pt("game_rank_title",xt),0,6*-kt),pop(),push();o=height/4*3-2*kt,translate(0,height/4+kt+o/3*2+height/16*.75),textAlign(CENTER,CENTER),fill(255),textStyle(NORMAL),i=height/28,Tt.submittedScore?.top&&(push(),fill(201,176,55),textSize(1.5*i),textStyle(BOLD),text(Pt("game_newTopPlay",xt,t),width/2,-1.5*i),pop()),textSize(i),text(Pt("game_score",xt,t),width/2,0),text(Pt("game_accuracy",xt,Tt.acc.toFixed(3)),width/2,1.25*i),text(Pt("game_maxCombo",xt,Tt.comboMax),width/2,1.25*i*2),s=e?Tt.submittedScore?Pt("game_pulse",xt,Tt.submittedScore.performance.toFixed(2)):Pt("loading",xt):"";text(s,width/2,1.25*i*3),pop(),pop(),textFont(Je.n),noStroke(),Kt(width/3*2+kt,height-height/8*2-2*kt,width/3-2*kt,height/8,Tt.replay.on?Pt("game_replayRetry",xt):Pt("game_retry",xt),Tt.buttonHover,0),Kt(width/3*2+kt,height-height/8-kt,width/3-2*kt,height/8,Pt("game_backToMenu",xt),Tt.buttonHover,1),pop()},cs.retry=function(){void 0===Tt.retryMillis&&(Tt.retryMillis=millis()),Tt.songVol+=At(0,Tt.songVol,.2),Qt[Tt.song].volume(Tt.songVol/100*Bt.settings.musicVolume/100),(500<=millis()-Tt.retryMillis||Tt.quickRetry)&&(Tt.headerY=0,Qt[Tt.song].stop(),qi(Bt.lvl.sel),Tt.disMode=1,u.boxR=0,Tt.lineFade=1,Tt.transBackA=0,Tt.board.c=height<width?height:width,Tt.board.str=1,Tt.failed=!1,Tt.retryMillis=void 0,Ne=!1,Tt.retry=!1,Tt.quickRetry=!1)},cs.scanBeats=function(e){for(var t,i=[],o=!1,n=0;n<e.length&&(t=Tt.edit?e[n][e[n].length-1]:n,!(Tt.beat[t][1]-Tt.ar>Tt.time&&Tt.beat[t][1]-Tt.hw>Tt.time));n++)if(!0!==Tt.beat[t][2]){if(Tt.beat[t][1]+(1===Tt.beat[t][5]?Tt.beat[t][6]:0)+Tt.hw*Tt.hitValues[Tt.hitValues.length-2].timing<Tt.time){if(!1!==Tt.edit)continue;if(1!==Tt.beat[t][5]||!Tt.keysHeld[Tt.beat[t][0]]){Tt.beat[t][2]=!0,Zi(t);continue}o=t}else(abs(Tt.beat[t][1]-Tt.time)<=Tt.ar||1===Tt.beat[t][5]&&abs(Tt.time-(Tt.beat[t][1]+Tt.beat[t][6]))<=Tt.ar||Tt.time>Tt.beat[t][1]&&Tt.time<Tt.beat[t][1]+Tt.beat[t][6])&&(i.push(t),Tt.beat[t][15]=!0);void 0===Tt.next[Tt.beat[t][0]]&&(Tt.time-(Tt.beat[t][1]+(1===Tt.beat[t][5]?Tt.beat[t][6]:0))<=Tt.hw&&Tt.beat[t][1]-Tt.time<=Tt.hw&&Tt.beat[t][15]||!1!==o)&&o===(Tt.next[Tt.beat[t][0]]=t)?(Tt.beat[t][2]=!0,Rn(Tt.beat[t][0]),Tt.next[Tt.beat[t][0]]=void 0):Tt.mods.noRelease&&1===Tt.beat[t][5]&&Tt.next[Tt.beat[t][0]]===t&&Tt.beat[t][8]>=Tt.beat[t][6]&&Rn(Tt.beat[t][0])}return{drawableBeats:i}},cs.sortBeats=function(e,t){let i=[];if(t){i=X(e);for(var o=0;o<i.length;o++)i[o].push(o);i.sort(function(e,t){return e[1]-t[1]})}else i=e;return i},cs.touchscreen=function(){if(ct)for(var e=0;e<3;e++)for(var t=0;t<3;t++){for(var i=!1,o=width<height?width:height,n=0;n<touches.length;n++)Ft("rcorner",o/3*e+(width-o)/2,o/3*t+(height-o)/2,o/3,o/3,touches[n].x,touches[n].y)&&(xn(e+3*t),i=!0);!1===i&&!0===Tt.keysPressed[e+3*t]&&bn(e+3*t)}},cs.transitionFromMenu=function(){rectMode(CORNER),fill(255),rect(0,-height+height*u.screenY,width,height),push(),0!==Ie&&0!==Ae||(Ie=height<width?height/4:width/4,Ae=height<width?height/4:width/4),u.boxR+=At(0,u.boxR,.1),Tt.lineFade+=At(1,Tt.lineFade,.1),Ie+=At((height<width?height:width)*Tt.board.w,Ie,.1),Ae+=At((height<width?height:width)*Tt.board.h,Ae,.1),Ot((height<width?height:width)*Tt.board.w)>=Ot(Ie)-1&&Ot((height<width?height:width)*Tt.board.w)<=Ot(Ie)+1&&(Tt.disMode=1),translate(width/2,-height+height*u.boxY+height/2),rectMode(CENTER),fill(0),rotate(u.boxR),rect(0,0,Ie,Ae),fill(255),rectMode(CORNER),noStroke(),rect(-Ie/2-Ie/4,-Ae/2+Ae/4,(Ie+Ie/4*2)*Tt.lineFade,Ae/8),rect(-Ie/2-Ie/4,-Ae/2+Ae/4*2+Ae/8,(Ie+Ie/4*2)*Tt.lineFade,Ae/8),rect(-Ie/2+Ie/4,-Ae/2-Ae/4,Ie/8,(Ae+Ae/4*2)*Tt.lineFade),rect(-Ie/2+Ie/4*2+Ie/8,-Ae/2-Ae/4,Ie/8,(Ae+Ae/4*2)*Tt.lineFade),pop()},cs.updateAll=function(){Tt.transBackA+=At(0,Tt.transBackA,.2),Tt.board.c=height/1080<width/1920?height:width/(1920/1080),Tt.board.str+=At(1,Tt.board.str,.2),Tt.showGUI?Tt.guiAlpha+=At(1,Tt.guiAlpha,.3):Tt.guiAlpha+=At(0,Tt.guiAlpha,.3),!0===Le&&(!1===Tt.edit&&1===Tt.disMode?Tt.paused?Mn("continue"):(Tt.playingOffset=Tt.time,Tt.paused=!Tt.paused):Tt.menu=!Tt.menu),d&&xn(0)},cs.updateEditor=function(){if(!0===Tt.edit){Tt.timeEnd=Mi(),Tt.effectTypeNames=["edit_effects_type_moveBoard","edit_effects_type_scaleBoard","edit_effects_type_rotateBoard","edit_effects_type_moveTile","edit_effects_type_scaleTile","edit_effects_type_rotateTile","edit_effects_type_changeForesight","edit_effects_type_opaqueBoard","edit_effects_type_opaqueTile","edit_effects_type_subtitle","edit_effects_type_vignette","edit_effects_type_letterbox","edit_effects_type_colorTile","edit_effects_type_colorOverlay","edit_effects_type_trailTile"],Tt.transitionNames=Pt("beatTransitions",xt).split("\n");for(var e=0;e<Tt.transitionNames.length;e++)Tt.transitionNames[e]=[Tt.transitionNames[e]];Tt.textAlignNames=Pt("textAligns",xt).split("\n"),Tt.textDirectionNames=Pt("textDirections",xt).split("\n");for(e=0;e<Tt.textAlignNames.length;e++)Tt.textAlignNames[e]=[Tt.textAlignNames[e]];for(e=0;e<Tt.textDirectionNames.length;e++)Tt.textDirectionNames[e]=[Tt.textDirectionNames[e]];Tt.queueEditorMusic&&0<=Tt.time&&Tt.playing?($o=Qt[Tt.song].play(),Qt[Tt.song].seek((1/(Tt.bpm/Tt.mods.bpm/Tt.time)*60*1e3+Tt.songOffset)/1e3,$o),Tt.queueEditorMusic=!1):Tt.playing||(Tt.queueEditorMusic=!1),Tt.metronome?(Tt.tools[5][0]="edit_tool_metronome_on",Tt.tools[5][1]=Tt.metronomeFlip?St.metronomeFlip:St.metronome,Tt.tools[3][3][1][1]=Tt.metronomeFlip?St.metronomeFlip:St.metronome):Tt.tools[5][0]="edit_tool_metronome_off";var t=Tt.timelineBPM/Tt.bpm;if(!0===Tt.playing){!1===Tt.editorHSStart&&(Tt.editorHSStart=(millis()-Tt.timeStart)/1e3*(Tt.timelineBPM/60)*Tt.playbackRate+Tt.playingOffset-1/32),!1===Tt.metronomeLast&&(Tt.metronomeLast=floor(Tt.time*t)),Tt.time=(millis()-Tt.timeStart)/1e3*(Tt.bpm/60)*Tt.playbackRate+Tt.playingOffset,Tt.tools[0][0]="edit_tool_stop",Tt.tools[0][1]=St.stop;for(var i,e=0;e<Tt.beat.length;e++)void 0===Tt.editorHS[e]&&Tt.beat[e][1]<=Tt.time&&Tt.beat[e][1]>=Tt.editorHSStart&&!(mouseY<height/16*Tt.headerY+height/16*(Tt.headerH+1)&&0===Tt.editorMode&&mouseIsPressed)&&(lowLag.play("hitsound",Bt.settings.hitsoundVolume/100),Tt.editorHS[e]=!0),1===Tt.beat[e][5]&&void 0===Tt.editorHSH[e]&&Tt.beat[e][1]+Tt.beat[e][6]<=Tt.time&&Tt.beat[e][1]+Tt.beat[e][6]>=Tt.editorHSStart&&!(mouseY<height/16*Tt.headerY+height/16*(Tt.headerH+1)&&0===Tt.editorMode&&mouseIsPressed)&&(lowLag.play("holdRelease",Bt.settings.hitsoundVolume/100),Tt.editorHSH[e]=!0);floor(Tt.time*(1/Tt.snap)*t)/(1/Tt.snap)==floor(Tt.time*t)&&floor(Tt.time*t)-Tt.bpm/60/1e3*Tt.timelineOffset>Tt.metronomeLast&&Tt.metronome&&!(mouseY<height/16*Tt.headerY+height/16*(Tt.headerH+1)&&0===Tt.editorMode&&mouseIsPressed)&&(i=4,Tt.snap!==1/3&&Tt.snap!==1/6&&Tt.snap!==1/12||(i=3),floor(Tt.time*t-Tt.bpm/60/1e3*Tt.timelineOffset)%i==0?lowLag.play("metronomeHigh"):lowLag.play("metronome"),Tt.metronomeFlip=!Tt.metronomeFlip,Tt.metronomeLast=floor(Tt.time*t))}else Tt.editorHS=[],Tt.editorHSH=[],Tt.tools[0][0]="edit_tool_play",Tt.tools[0][1]=St.play}},cs.updateGameplay=function(){noCursor(),Tt.combo>Tt.comboMax&&(Tt.comboMax=Tt.combo),Tt.time>Tt.timeEnd+Tt.hw&&Tt.time>Tt.timeEnd+Tt.ar&&!1===Tt.edit&&(Tt.disMode=2);for(var e,t=0;t<Tt.keysHeld.length;t++)void 0!==Tt.next[t]&&!0===Tt.keysHeld[t]&&1===Tt.beat[Tt.next[t]][5]&&(e=Tt.beat[Tt.next[t]][8],Tt.beat[Tt.next[t]][8]=Tt.time-Tt.beat[Tt.next[t]][7],Tt.beat[Tt.next[t][8]]<e)&&(Tt.beat[Tt.next[t][8]]=e);for(var i=!1,t=0;t<Tt.hitValues.length;t++)Tt.mods.instantFail&&t===Tt.hitValues.length-1&&0<Tt.hitStats[t]&&(i=!0),Tt.mods.perfect&&Tt.hitValues[t].acc<100&&0<Tt.hitStats[t]&&(i=!0);if((Tt.hp<=0||i)&&!Tt.mods.noFail&&(Tt.failed=!0,Tt.disMode=2),Tt.mods.auto)for(t=0;t<Tt.keys.length;t++)void 0!==Tt.next[t]&&Tt.beat[Tt.next[t]][1]<=Tt.time+Tt.bpm/60/60/2&&(1!==Tt.beat[Tt.next[t]][5]||Tt.beat[Tt.next[t]][8]<Tt.beat[Tt.next[t]][6])&&!Tt.beat[Tt.next[t]][2]?(Tt.tilePress[t]=1,Tt.lastHitTile=t,Tt.tilePressRelease[t]=!1,void 0!==Tt.next[t]&&(0===Tt.beat[Tt.next[t]][5]?(Tt.beat[Tt.next[t]][2]=!0,Tt.beat[Tt.next[t]][3]=1-abs(Tt.beat[Tt.next[t]][1]-Tt.time)/Tt.hw,Tt.beat[Tt.next[t]][4]=Tt.beat[Tt.next[t]][1]-Tt.time<0,Zi(Tt.next[t]),lowLag.play("hitsound",Bt.settings.hitsoundVolume/100)):1===Tt.beat[Tt.next[t]][5]&&(Tt.keysHeld[t]||lowLag.play("hitsound",Bt.settings.hitsoundVolume/100),0===Tt.beat[Tt.next[t]][7]&&(Tt.beat[Tt.next[t]][7]=Tt.time),Tt.keysHeld[t]=!0,void 0!==Tt.beat[Tt.next[t]][12]&&null!==Tt.beat[Tt.next[t]][12]||(Tt.beat[Tt.next[t]][12]=Tt.time)))):bn(t);Tt.replay.on&&(Tt.replay.pressI<Tt.replay.press.length&&Tt.time>=Tt.replay.press[Tt.replay.pressI][1]-Tt.bpm/60/60/2&&(xn(Tt.replay.press[Tt.replay.pressI][0]),Tt.replay.pressI++),Tt.replay.releaseI<Tt.replay.release.length)&&Tt.time>=Tt.replay.release[Tt.replay.releaseI][1]-Tt.bpm/60/60/2&&(bn(Tt.replay.release[Tt.replay.releaseI][0]),Tt.replay.releaseI++)},fs.screens=function(){if("click"===He&&3e3<=millis()&&fs.screens.click(),"menu"===He)if("logo"===Bt.screen&&fs.screens.logo(),"logo"!==Bt.screen&&"main trans"!==Bt.screen&&fs.screens.header(),!0===Bt.side)fs.screens.nav();else if("account"===Bt.screen&&""===T.uuid)fs.screens.accountSignedOut();else if("account"===Bt.screen)fs.screens.accountSignedIn();else if("lvl"===Bt.screen&&!1===Bt.lvl.loading&&!0!==Ne){Rt=[],Rt=Uo(Ht.search,Bt.lvl.sortMode);for(var e=0;e<Rt.length;e++)(i=height/16+height/24+height/12*e-(Rt.length>(height-(height/16+height/24))/(height/12)?Bt.lvl.scroll/(height-(height/16+height/24)-(height-(height/16+height/24))/12)*(height/12*(Rt.length-(height-(height/16+height/24))/(height/12))):0))<height&&0<i&&(width>height?width:height,Ft("rcorner",0,i,width/3-width/48,height/12))&&(Bt.lvl.sel=e,!(Bt.lvl.deleteConfirm=!1)===Rt[e].local?Tt.mods.offset=Ht.localOffsets[Ht.saved.indexOf(Rt[e])]:Tt.mods.offset=Ht.onlineOffsets[Rt[e]],void 0!==Tt.mods.offset&&null!==Tt.mods.offset||(Tt.mods.offset=0));if(!1!==Bt.lvl.sel)if(!1===Bt.lvl.deleteConfirm&&!1===Bt.lvl.uploadConfirm)if(Bt.lvl.showMods)if(vt.active)vt.callback?.();else{if(Ft("rcorner",width/3+kt+((width/3*2-2*kt)/2+kt/2),height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt+(height-height/16)/3/3*2+kt/2+((height-height/16)/3/3-kt/2)/4*3-kt/2,(width/3*2-2*kt)/2-kt/2,((height-height/16)/3/3-kt/2)/2)&&(Bt.lvl.buttonHover[11]/=4,Bt.lvl.showMods=!Bt.lvl.showMods),Ft("rcorner",width/3+kt+((width/3*2-2*kt)/2+kt/2),height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt+(height-height/16)/3/3*2+kt/2+((height-height/16)/3/3-kt/2)/4*3-kt/2-((height-height/16)/3/3-kt/2)/2-kt/2,(width/3*2-2*kt)/2-kt/2,((height-height/16)/3/3-kt/2)/2)&&(Bt.lvl.buttonHover[15]/=4,vt.active=!0),Ft("rcorner",width/3+kt,height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt+(height-height/16)/3/3*2+kt/2+((height-height/16)/3/3-kt/2)/4*3-kt/2,(width/3*2-2*kt)/2-kt/2,((height-height/16)/3/3-kt/2)/2))for(var t in Bt.lvl.buttonHover[13]/=4,Tt.modsDef)"offset"!==t&&(Tt.mods[t]=Tt.modsDef[t]);Bt.lvl.modsNSM.click()}else if(!0===Rt[Bt.lvl.sel]?.local)Bt.lvl.showLeaderboard||Bt.lvl.showMods?Bt.lvl.showLeaderboard&&Ft("rcorner",width/3+kt+((width/3*2-2*kt)/2+kt/2),height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt+(height-height/16)/3/3*2+kt/2,(width/3*2-2*kt)/2-kt/2,(height-height/16)/3/3-kt/2)&&(Bt.lvl.buttonHover[9]/=2,Bt.lvl.showLeaderboard=!Bt.lvl.showLeaderboard):(Ft("rcorner",width/3+kt,height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt,(width/3*2-2*kt)/2-kt/2,(height-height/16)/3/3*2-kt/2)&&(Tt.edit=!1,Tt.replay.on=!1,qi(Bt.lvl.sel),Bt.lvl.buttonHover[0]/=2),Ft("rcorner",width/3+kt+(width/3*2-4*kt)/3*0,height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt+(height-height/16)/3/3*2+kt/2,(width/3*2-4*kt)/3,(height-height/16)/3/3-kt/2)&&(Bt.lvl.deleteConfirm=!0,Bt.lvl.buttonHover[1]/=2),Ft("rcorner",width/3+kt+((width/3*2-2*kt)/2-kt/2)+kt,height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt,(width/3*2-2*kt)/2-kt/2,(height-height/16)/3/3*2-kt/2)&&(Tt.edit=!0,Tt.replay.on=!1,qi(Bt.lvl.sel),Bt.lvl.buttonHover[2]/=2),!Ft("rcorner",width/3+3*kt+(width/3*2-4*kt)/3*2,height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt+(height-height/16)/3/3*2+kt/2,(width/3*2-4*kt)/3,(height-height/16)/3/3-kt/2)||void 0!==Rt[Bt.lvl.sel].copy&&Rt[Bt.lvl.sel].author!==T.uuid||(Bt.lvl.uploadConfirm=!0,Bt.lvl.buttonHover[3]/=2),Ft("rcorner",width/3+2*kt+(width/3*2-4*kt)/3*1,height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt+(height-height/16)/3/3*2+kt/2,(width/3*2-4*kt)/3,(height-height/16)/3/3-kt/2)&&(Bt.lvl.buttonHover[12]/=2,Bt.lvl.showMods=!Bt.lvl.showMods),Ft("ccenter",width/3+kt+(width/3*2/3*2-2*kt)+kt+width/3*2/3-kt-1.5*kt,height/16+kt+(height-height/16)/3-2*kt-1.5*kt,1.5*kt,1.5*kt)&&(Ht.savedDiffReq[Rt[Bt.lvl.sel].index]=void 0,Sn.clear(),--Bt.lvl.refreshArrowR));else if(Bt.lvl.showLeaderboard||Bt.lvl.showMods)Bt.lvl.showLeaderboard&&(r=floor(height/12)-kt,Ft("rcorner",width/3+width/3+kt/2,height-height/12+kt/2,width/6,r)&&(Bt.lvl.buttonHover[9]/=2,Bt.lvl.showLeaderboard=!Bt.lvl.showLeaderboard),"Loading..."!==Bt.lvl.leaderboardData&&Ft("rcorner",width/3+width/3-width/6-kt/2,height-height/12+kt/2,width/6,r)&&(Bt.lvl.buttonHover[14]/=2,v.grabbedScoresLevel.splice(Rt[Bt.lvl.sel],1),mn.clear()),Ft("rcorner",width/3,height-floor(height/12),width,floor(height/12))||Bt.lvl.newLeaderboard.click());else{if(Ft("rcorner",width/3+kt,height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt,width/3*2-2*kt,(height-height/16)/3/3*2-kt/2)){switch(qo(Rt[Bt.lvl.sel])){case 0:m(Rt[Bt.lvl.sel],"id",!0);break;case 1:break;case 2:Tt.edit=!1,Tt.replay.on=!1,qi(Bt.lvl.sel)}Bt.lvl.buttonHover[4]/=2}Ft("rcorner",width/3+kt+(width/3*2-4*kt)/3*0,height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt+(height-height/16)/3/3*2+kt/2,(width/3*2-4*kt)/3,(height-height/16)/3/3-kt/2)&&(-1!==Ht.saved.indexOf(Rt[Bt.lvl.sel])?(Ht.scores.splice(Ht.saved.indexOf(Rt[Bt.lvl.sel]),1),Ht.saved.splice(Ht.saved.indexOf(Rt[Bt.lvl.sel]),1),0===Bt.lvl.tab&&(Ht.search=[],Bt.lvl.sel=!1,Bt.lvl.searchSent=!1)):Ht.saved.push(Rt[Bt.lvl.sel]),Bt.lvl.buttonHover[5]/=2),Ft("rcorner",width/3+3*kt+(width/3*2-4*kt)/3*2,height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt+(height-height/16)/3/3*2+kt/2,(width/3*2-4*kt)/3,(height-height/16)/3/3-kt/2)&&(!0===H(Rt[Bt.lvl.sel],"id").ranked?Bt.lvl.showLeaderboard=!Bt.lvl.showLeaderboard:"Loading..."!==H(Rt[Bt.lvl.sel],"id").author&&"Metadata"!==H(Rt[Bt.lvl.sel],"id").beat&&Mo(Rt[Bt.lvl.sel]),Bt.lvl.buttonHover[8]/=2),Ft("rcorner",width/3+2*kt+(width/3*2-4*kt)/3*1,height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt+(height-height/16)/3/3*2+kt/2,(width/3*2-4*kt)/3,(height-height/16)/3/3-kt/2)&&(Bt.lvl.buttonHover[10]/=2,Bt.lvl.showMods=!Bt.lvl.showMods),Ft("ccenter",width/3+kt+(width/3*2/3*2-2*kt)+kt+width/3*2/3-kt-1.5*kt,height/16+kt+(height-height/16)/3-2*kt-1.5*kt,1.5*kt,1.5*kt)&&(v.newGrabbedLevels[Rt[Bt.lvl.sel]]=void 0,v.newGLRequested[Rt[Bt.lvl.sel]]=void 0,v.newGLRequestedT[Rt[Bt.lvl.sel]]=void 0,v.newGLDownloading[Rt[Bt.lvl.sel]]=void 0,Sn.clear(),--Bt.lvl.refreshArrowR)}else Ft("rcorner",-width/3*2+kt+width/3*3*Bt.lvl.deleteBanner,height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt+(height-height/16)/3/3*2+kt/2,(width/3*2-2*kt)/2-kt/2,(height-height/16)/3/3-kt/2)&&(Bt.lvl.deleteConfirm?(isNaN(Rt[Bt.lvl.sel].index)?Gn({type:"error",message:"menu_lvl_deleteError"}):(Ht.scores.splice(Rt[Bt.lvl.sel].index,1),Ht.localOffsets.splice(Rt[Bt.lvl.sel].index,1),Ht.saved.splice(Rt[Bt.lvl.sel].index,1),Ht.search=[],Bt.lvl.searchSent=!1,Bt.lvl.sel=!1),Bt.lvl.deleteConfirm=!1):Bt.lvl.uploadConfirm&&(Bt.lvl.uploading=!0,Bt.lvl.uploadConfirm=!1,void 0===Rt[Bt.lvl.sel].copy?Ho(Bt.lvl.sel):Ro(Rt[Bt.lvl.sel])),Bt.lvl.deleteBanner=0,Bt.lvl.buttonHover[6]/=2),Ft("rcorner",-width/3*2+width/3*3*Bt.lvl.deleteBanner+kt+((width/3*2-2*kt)/2-kt/2)+kt,height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt+(height-height/16)/3/3*2+kt/2,(width/3*2-2*kt)/2-kt/2,(height-height/16)/3/3-kt/2)&&(Bt.lvl.deleteConfirm=!1,Bt.lvl.uploadConfirm=!1,Bt.lvl.buttonHover[7]/=2);Bt.lvl.scrollNewLock||(Ft("rcorner",height/24*5,height/16,width/3-width/48-height/24*5,height/24)&&Ri({var:[Bt.lvl,"search"],title:"menu_lvl_search",type:"string",allowEmpty:!0,after:function(){Ht.search=[],Bt.lvl.sel=!1,Bt.lvl.searchSent=!1}}),Ft("rcorner",0,height/16,height/24,height/24)?(Bt.lvl.tab=0,Bt.lvl.sortMode="dateDesc",Bt.lvl.showUnranked=!0,Bt.lvl.search="",Ht.search=[],Bt.lvl.scroll=0,Bt.lvl.sel=!1,Bt.lvl.searchSent=!1,Bt.lvl.viewSkip=0):Ft("rcorner",height/24,height/16,height/24,height/24)?(Bt.lvl.tab=1,Bt.lvl.sortMode="starsAsc",Bt.lvl.showUnranked=!1,Bt.lvl.search="",Ht.search=[],Bt.lvl.scroll=0,Bt.lvl.sel=!1,Bt.lvl.searchSent=!1,Bt.lvl.viewSkip=0):Ft("rcorner",width/3-width/48,height/16,width/48,height/24)?Ji():Ft("rcorner",height/24*2,height/16,height/24,height/24)?(Bt.lvl.showUnranked=!Bt.lvl.showUnranked,Ht.search=[],Bt.lvl.sel=!1,Bt.lvl.tabHighlight[7]/=2,Bt.lvl.searchSent=!1,Bt.lvl.viewSkip=0):Ft("rcorner",height/24*4,height/16,height/24,height/24)?(Bt.lvl.searchMode=Bt.lvl.searchModes.indexOf(Bt.lvl.searchMode)+1,Bt.lvl.searchMode>Bt.lvl.searchModes.length-1&&(Bt.lvl.searchMode=0),Bt.lvl.searchMode=Bt.lvl.searchModes[Bt.lvl.searchMode],Bt.lvl.tabHighlight[2]/=2,Bt.lvl.searchSent=!1,Bt.lvl.viewSkip=0):Ft("rcorner",height/24*3,height/16,height/24,height/24)&&(Bt.lvl.sortMode=Bt.lvl.sortModes.indexOf(Bt.lvl.sortMode)+1,Bt.lvl.sortMode>Bt.lvl.sortModes.length-1&&(Bt.lvl.sortMode=0),Ht.search=[],Bt.lvl.sortMode=Bt.lvl.sortModes[Bt.lvl.sortMode],Bt.lvl.tabHighlight[4]/=2,Bt.lvl.searchSent=!1,Bt.lvl.viewSkip=0))}else if("song"===Bt.screen)if("song"===Bt.song.mode){Rt=[],Rt=Uo(O.search,Bt.song.sortMode);for(var i,e=0;e<Rt.length;e++)(i=height/16+height/24+height/12*e-(Rt.length>(height-(height/16+height/24))/(height/12)?Bt.lvl.scroll/(height-(height/16+height/24)-(height-(height/16+height/24))/12)*(height/12*(Rt.length-(height-(height/16+height/24))/(height/12))):0))<height&&0<i&&(width>height?width:height,Ft("rcorner",0,i,width/3-width/48,height/12))&&(!0===Bt.song.listening&&(Bt.song.listening=!1,soundManager.pause(Rt[Bt.song.sel]),soundManager.setVolume("menuMusic",Bt.settings.musicVolume)),Bt.song.sel=e);!1!==Bt.song.sel&&(Ft("rcorner",width/3+kt,height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt,width/3*2-2*kt,(height-height/16)/3/3*2-kt/2)&&(So(String(Rt[Bt.song.sel])),Bt.song.buttonHover[4]/=2),Ft("rcorner",width/3+kt,height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)+kt+(height-height/16)/3/3*2+kt/2,width/3*2-2*kt,(height-height/16)/3/3-kt/2)&&(-1!==O.saved.indexOf(Rt[Bt.song.sel])?(O.saved.splice(O.saved.indexOf(Rt[Bt.song.sel]),1),0===Bt.song.tab&&(O.search=[],Bt.song.sel=!1)):O.saved.push(Rt[Bt.song.sel]),Bt.song.buttonHover[5]/=2),Ft("rcorner",width/3+kt+kt,height/16+kt+((height-height/16)/3-2*kt)+kt+((height-height/16)/3-2*kt)/2-kt,2*kt,2*kt))&&(!1===Bt.song.listening?(Bt.song.listening=!0,ao(Rt[Bt.song.sel]),soundManager.load(Rt[Bt.song.sel]),soundManager.setVolume(Rt[Bt.song.sel],Bt.settings.musicVolume),soundManager.setVolume("menuMusic",0)):(Bt.song.listening=!1,soundManager.pause(Rt[Bt.song.sel]),soundManager.setVolume("menuMusic",Bt.settings.musicVolume))),Ft("rcorner",0,height/16,height/24,height/24)?(Bt.song.listening&&(Rt=[],Rt=O.search,Bt.song.listening=!1,soundManager.pause(Rt[Bt.song.sel]),soundManager.setVolume("menuMusic",Bt.settings.musicVolume)),Bt.song.tab=0,Bt.song.search="",O.search=[],Bt.lvl.scroll=0,Bt.song.sel=!1):Ft("rcorner",height/24,height/16,height/24,height/24)?(Bt.song.listening&&(Rt=[],Rt=O.search,Bt.song.listening=!1,soundManager.pause(Rt[Bt.song.sel]),soundManager.setVolume("menuMusic",Bt.settings.musicVolume)),Bt.song.tab=1,Bt.song.search="",O.search=[],Bt.lvl.scroll=0,Bt.song.sel=!1):Ft("rcorner",width/3-width/48,height/16,width/48,height/24)&&!Bt.lvl.scrollNewLock?void 0!==T.uuid&&null!==T.uuid&&0!==T.uuid.length&&(Bt.song.listening=!1,soundManager.pause(Rt[Bt.song.sel]),soundManager.setVolume("menuMusic",Bt.settings.menuMusicVolume),Bt.song.mode="newSong",Bt.song.overlayOn=!0):Ft("rcorner",height/24*3,height/16,height/24,height/24)?(Bt.song.searchMode=Bt.song.searchModes.indexOf(Bt.song.searchMode)+1,Bt.song.searchMode>Bt.song.searchModes.length-1&&(Bt.song.searchMode=0),Bt.song.searchMode=Bt.song.searchModes[Bt.song.searchMode],Bt.song.tabHighlight[2]/=2):Ft("rcorner",height/24*2,height/16,height/24,height/24)&&(Bt.song.sortMode=Bt.song.sortModes.indexOf(Bt.song.sortMode)+1,Bt.song.sortMode>Bt.song.sortModes.length-1&&(Bt.song.sortMode=0),Bt.song.sortMode=Bt.song.sortModes[Bt.song.sortMode],Bt.song.tabHighlight[4]/=2),Ft("rcorner",height/24*4,height/16,width/3-width/48-height/24*4,height/24)&&Ri({var:[Bt.song,"search"],title:"menu_lvl_search",type:"string",allowEmpty:!0,after:function(){O.search=[],Bt.song.sel=!1}})}else"newSong"===Bt.song.mode?(Ft("rcorner",3*kt,height/16+height/32*3+7*kt+height/16*8,width/8,height/16)?(Bt.song.mode="song",Bt.song.overlayOn=!1,Bt.newSong.title="",Bt.newSong.artist="",Bt.newSong.link="",Bt.song.errors=[],Bt.song.blankErrors=[],Bt.song.takenErrors=[],Bt.song.buttonHover[4]/=2):Ft("rcorner",4*kt+width/8,height/16+height/32*3+7*kt+height/16*8,width/8,height/16)&&(gn(),Bt.account.buttonHover[3]/=2),Ft("rcorner",3*kt,height/16+height/32*3+3*kt+height/16,width/2,height/16)?Ri({var:[Bt.newSong,"title"],title:"menu_newSong_songTitle",type:"string",allowEmpty:!0}):Ft("rcorner",3*kt,height/16+height/32*3+4*kt+height/16*3,width/2,height/16)?Ri({var:[Bt.newSong,"artist"],title:"menu_newSong_songArtist",type:"string",allowEmpty:!0}):Ft("rcorner",3*kt,height/16+height/32*3+5*kt+height/16*5,width/2,height/16)&&(re.type="audio",re.sizeLimit=Bt.newSong.sizeLimit,re.success=e=>{e=e.file;const t=new FileReader;t.addEventListener("load",()=>{var e=t.result;Bt.newSong.link=e},!1),t.readAsDataURL(e)},settingsFileInput.elt.click())):"verify"===Bt.song.mode?2===Bt.newSong.songObject.readyState||!0===Bt.newSong.failedLinksCheck?Ft("rcorner",width/2-width/4/2,(height-height/16)/4*3,width/4,height/8)&&(Bt.song.mode="newSong",Bt.newSong.songLoading=!1,Bt.newSong.songPlaying=!1,Bt.newSong.failedLinks[Bt.newSong.failedLinks.length]=Bt.newSong.link,Bt.newSong.failedLinksCheck=!1,Bt.song.buttonHover[7]/=2):3===Bt.newSong.songObject.readyState&&(Ft("rcorner",width/16*11-width/4/2,(height-height/16)/4*3,width/4,height/8)&&(Bt.song.mode="newSong",Bt.newSong.songLoading=!1,Bt.newSong.songPlaying=!1,Bt.newSong.verifyDim=0,Bt.newSong.failedLinksCheck=!1,Bt.song.buttonHover[8]/=2,soundManager.stop(Bt.newSong.link+"verify"),to()),Ft("rcorner",width/16*5-width/4/2,(height-height/16)/4*3,width/4,height/8))&&(Bt.song.mode="upload",Bt.song.buttonHover[7]/=2,soundManager.stop(Bt.newSong.link+"verify"),to(),B("uploadSong",{name:Bt.newSong.title,artist:Bt.newSong.artist,link:Bt.newSong.link,uploader:T.uuid,session:T.session})):"upload"===Bt.song.mode&&Ft("rcorner",width/2-width/4/2,(height-height/16)/4*3,width/4,height/8)&&(Bt.song.mode="song",Bt.song.overlayOn=!1,Bt.newSong.songLoading=!1,Bt.newSong.songPlaying=!1,Bt.newSong.failedLinks[Bt.newSong.failedLinks.length]=Bt.newSong.link,Bt.newSong.failedLinksCheck=!1,Bt.newSong.title="",Bt.newSong.artist="",Bt.newSong.link="",Bt.song.buttonHover[7]/=2);else if("online"===Bt.screen){if("main"===Bt.online.mode){for(e=0;e<Bt.online.searchedUsers.length;e++)Ft("rcorner",kt+((width-width/48-4*kt)/3+kt)*(e%3),kt+height/16+height/24+5*kt*floor(e/3)+(-(kt+height/16+height/24+5*kt*floor((Bt.online.searchedUsers.length-1)/3))+height-5*kt<0?Bt.online.scroll:0),(width-width/48-4*kt)/3,4*kt)&&mouseY>height/16+height/24&&(Bt.online.viewUser=Bt.online.searchedUsers[e],Bt.online.mode="viewUser",Bt.online.viewUserUUIDCheck=!1,bo(Bt.online.viewUser));Ft("rcorner",height/24,height/16,width-height/24,height/24)&&Ri({var:[Bt.online,"search"],title:"menu_lvl_search",type:"string",allowEmpty:!0,after:function(){Bt.online.searchedUsers=[]}}),Ft("rcorner",0,height/16,height/24,height/24)&&(Bt.online.searchOnline=!Bt.online.searchOnline,Bt.online.tabHighlight[0]/=2,Bt.online.searchedUsers=[],v.newGrabbedUser=[],v.newGrabbedUserUsername=[],v.newGUUnix=[],v.newGURequested=[],v.newGURequestedT=[])}else if("viewUser"===Bt.online.mode)$n("online");else if("newSong"===Bt.online.mode)!1===Bt.newSong.verify?Ft("rcorner",width/32/2,(height-(height/16+height/32*3))/16*11+(height/16+height/32*3),(width/4*3-width/32)/3,(height-(height/16+height/32*3))/8,height/64)?Bt.online.mode="song":Ft("rcorner",width/4+width/32/2,(height-(height/16+height/32*3))/16*2+(height/16+height/32*3),width/4*3-width/32,(height-(height/16+height/32*3))/8)?Ri({var:[Bt.newSong,"title"],title:"menu_newSong_songTitle",type:"string",allowEmpty:!1}):Ft("rcorner",width/4+width/32/2,(height-(height/16+height/32*3))/16*5+(height/16+height/32*3),width/4*3-width/32,(height-(height/16+height/32*3))/8)?Ri({var:[Bt.newSong,"artist"],title:"menu_newSong_songArtist",type:"string",allowEmpty:!1}):Ft("rcorner",width/4+width/32/2,(height-(height/16+height/32*3))/16*8+(height/16+height/32*3),width/4*3-width/32,(height-(height/16+height/32*3))/8)||Ft("rcorner",width/4+width/32/2,(height-(height/16+height/32*3))/16*11+(height/16+height/32*3),(width/4*3-width/32)/3,(height-(height/16+height/32*3))/8)&&(0!==Bt.newSong.title.length&&0!==Bt.newSong.artist.length&&0!==Bt.newSong.link.length?Bt.newSong.verify=!0:Bt.newSong.verifyError=!0):!0===Bt.newSong.verify?2===Bt.newSong.songObject.readyState||!0===Bt.newSong.failedLinksCheck?Ft("rcorner",width/32/2,(height-(height/16+height/32*3))/16*11+(height/16+height/32*3),(width/4*3-width/32)/3,(height-(height/16+height/32*3))/8,height/64)&&(Bt.newSong.verify=!1,Bt.newSong.songLoading=!1,Bt.newSong.songPlaying=!1,Bt.newSong.verifyDim=0,Bt.newSong.failedLinks[Bt.newSong.failedLinks.length]=Bt.newSong.link,Bt.newSong.failedLinksCheck=!1):3===Bt.newSong.songObject.readyState&&(Ft("rcenter",width/16*11,(height-height/16)/4*3,width/4,height/8,height/64)&&(Bt.newSong.verify=!1,Bt.newSong.songLoading=!1,Bt.newSong.songPlaying=!1,Bt.newSong.verifyDim=0,Bt.newSong.failedLinksCheck=!1,soundManager.stop(Bt.newSong.link+"verify")),Ft("rcenter",width/16*5,(height-height/16)/4*3,width/4,height/8,height/64))&&(Bt.newSong.verify="upload",soundManager.stop(Bt.newSong.link+"verify"),B("uploadSong",{name:Bt.newSong.title,artist:Bt.newSong.artist,link:Bt.newSong.link,uploader:T.uuid,session:T.session})):"upload"===Bt.newSong.verify&&Ft("rcorner",width/32/2,(height-(height/16+height/32*3))/16*11+(height/16+height/32*3),(width/4*3-width/32)/3,(height-(height/16+height/32*3))/8,height/64)&&(Bt.newSong.verify=!1,Bt.newSong.songLoading=!1,Bt.newSong.songPlaying=!1,Bt.newSong.verifyDim=0,Bt.newSong.failedLinks[Bt.newSong.failedLinks.length]=Bt.newSong.link,Bt.newSong.failedLinksCheck=!1,Bt.newSong.uploaded=!1,Bt.newSong.uploadID=0);else if("levels"===Bt.online.mode){if(mouseY>(height-height/16)/4+height/16)for(e=0;e<Bt.onlineLvl.data.length;e++)Ft("rcorner",0,(height-height/16)/4+height/16+(height-height/16)/4*3/8*e+(height-height/16)/4*3/8*(-Bt.onlineLvl.scroll*Bt.onlineLvl.scrollSize),width-width/32,(height-height/16)/4*3/8)&&(Bt.onlineLvl.sel=e);Ft("rcenter",width/12*5/4/2+(width/12*5-width/12*5/4)/4/2,(height-height/16)/4/3*1+height/16,(width/12*5-width/12*5/4)/4,(height-height/16)/4/2/2)&&(Bt.online.mode="main"),Ft("rcenter",width/12*5+width/4+width/3/8*4,height/16+(height-height/16)/4/6*2,width/3-2*(width/12*5+width/4+width/3/8*2.0625-width/3/8*3.5/2-(width/12*5+width/4)),(height-height/16)/4/6*3)&&_i(Bt.onlineLvl.data[Bt.onlineLvl.sel].id)}}else if("settings"===Bt.screen)Bt.settings.menu.click();else if("socialMedia"===Bt.screen)Ft("rcorner",width/2-width/4/2,height/2,width/4,height/8)&&(Bt.socialMedia.buttonHover[0]/=2,p());else if("patreon"===Bt.screen)Ut(T.uuid,"uuid").patreon>w||Ft("rcorner",width/2-width/4/2,height/2+height/8,width/4,height/8)&&(Bt.socialMedia.buttonHover[0]/=2,b());else if("morePulsus"===Bt.screen){var o=width/16/2/2,n=height/16*1.5;let e=0;for(const f of["https://patreon.com/tetrogem","https://discord.pulsus.cc","https://wiki.pulsus.cc","https://contribute.pulsus.cc"]){var s=height/8*1.5*e+height/8;Ft("rcorner",width-width/4-width/16+o,-height/8/2+n+s,width/4,height/8)&&(console.log("Open "+e),open(f),Bt.socialMedia.buttonHover[e]/=2),e++}}if("game"===He){if(1===Tt.disMode)if(!0===Tt.edit){var r,h,a=Tt.timelineBPM/Tt.bpm;if(!1===Tt.menu)if(Ft("rcorner",0,0,kt,kt))Nn();else{if(0===Tt.editorMode){for(e=0;e<9;e++)if(Ft("rcenter",Tt.board.w*Tt.board.c*3/8*(e%3-1)+width/2,Tt.board.h*Tt.board.c*3/8*(floor(e/3)-1)+height/2,Tt.board.w*Tt.board.c/4+Tt.board.str*(Tt.board.c/64)*Tt.missTiles[e][0],Tt.board.h*Tt.board.c/4+Tt.board.str*(Tt.board.c/64)*Tt.missTiles[e][0])){for(var l=!1,d=0;d<Tt.beat.length;d++)Ot(1e6*Tt.beat[d][1])/1e6==Ot(1e6*(Ot((Tt.time-Tt.bpm/60/1e3*Tt.timelineOffset)*(1/Tt.snap)*a)/(1/Tt.snap*a)+Tt.bpm/60/1e3*Tt.timelineOffset))/1e6&&Tt.beat[d][0]===e&&(l=d);"scroll"===Tt.timelineMode?!1===l?(Tt.beat[Tt.beat.length]=[],Tt.beat[Tt.beat.length-1]=[e,Ot((Tt.time-Tt.bpm/60/1e3*Tt.timelineOffset)*(1/Tt.snap)*a)/(1/Tt.snap*a)+Tt.bpm/60/1e3*Tt.timelineOffset,!1,0,!1,Tt.objType,Tt.holdLength/a,0,0,Tt.timelineBPM,Tt.timelineOffset,Tt.beatColor,null,Tt.transitionIn,Tt.transitionOut,!1,Tt.beatSaturation,Tt.beatBrightness]):Tt.beat.splice(l,1):"select"===Tt.timelineMode&&!1!==l&&jn(l,"beat")}if("select"===Tt.timelineMode){for(e=0;e<Tt.beat.length;e++)Ft("rcenter",width/32*(Tt.beat[e][1]*a)*(1/Tt.snap)-floor(width/36)/3+Ot(floor(width/36)/3)*floor(Tt.beat[e][0]%3)+(width/2-width/32*(Tt.time*a/Tt.snap)),height/16*Tt.headerY+height/16-height/16/2-floor(width/36)/3+Ot(floor(width/36)/3)*floor(Tt.beat[e][0]/3),floor(width/48)/3,floor(width/48)/3)&&jn(e,"beat");0<Tt.selectedBeats.length&&Tt.beatNSM.click()}}else if(1===Tt.editorMode)if(Ft("rcorner",width-width/4,height/16*2,width/2,height/16*14))Tt.effectsNSM.click();else if("select"===Tt.timelineMode)for(e=0;e<Tt.effects.length;e++)if(Ft("rcenter",width/32*(Tt.effects[e].time*a)*(1/Tt.snap)+width/32*(1/Tt.snap)*(Tt.effects[e].moveTime*a)/2+(width/2-width/32*(Tt.time*a/Tt.snap)),height/16*Tt.headerY+height/16-height/16/2+height/24*Tt.effects[e].track,width/64+width/32*(1/Tt.snap)*(Tt.effects[e].moveTime*a),width/64,width)){jn(e,"effects");break}if("select"===Tt.timelineMode){for(var g=Fn(),e=0;e<Tt.sections.length;e++)if(Ft("ccenter",width/32*(Tt.sections[e].time*a)*(1/Tt.snap)+(width/2-width/32*(Tt.time*a/Tt.snap)),height/16*Tt.headerY+height/16+floor(width/48)/3+height/24*(1===Tt.editorMode?g:0),floor(width/48)/3,floor(width/48)/3)){jn(e,"sections");break}0<Tt.sectionsSelected.length&&Tt.sectionsNSM.click()}if(!1===Tt.menu)for(e=0;e<Tt.tools.length;e++)if(Ft("rcorner",width/Tt.tools.length*e,height-height/16*Tt.headerY,width/Tt.tools.length,height/16*-(Tt.toolsH+1)))0===e&&en(),1===e&&kn("objType"),2===e&&(1===Tt.playbackRate?Tt.playbackRate=.5:.5===Tt.playbackRate&&(Tt.playbackRate=1),Tt.timeStart=millis(),Tt.playingOffset=Tt.time),4===e&&kn("clickMode"),5===e&&(Tt.metronome=!Tt.metronome),6===e&&zn(),7===e&&kn("editMode"),e===Tt.tools.length-1&&(Tt.menu=!0);else if(!1!==Tt.tools[e][3])for(var c,d=0;d<Tt.tools[e][3].length;d++)Ft("rcorner",width/Tt.tools.length*e+width/Tt.tools.length/Tt.tools[e][3].length*d,height-height/32*(Tt.toolsH+1)*(4*Tt.tools[e][2]),width/Tt.tools.length/Tt.tools[e][3].length,height/16*(Tt.toolsH+1))&&(1===e?(c=d,-1===(c=1===Tt.objType?d-1:c)?kn("holdLength"):0===c?Ni({hue:[Tt,"beatColor"],saturation:[Tt,"beatSaturation"],brightness:[Tt,"beatBrightness"],mode:HSB,title:"edit_select_item_beatColor"}):1===c?mouseButton===LEFT?Tt.transitionIn=Tt.transitionIn>=Tt.transitionNames.length-1?0:Tt.transitionIn+1:mouseButton===RIGHT&&(Tt.transitionIn=Tt.transitionIn<=0?Tt.transitionNames.length-1:Tt.transitionIn-1):2===c&&(mouseButton===LEFT?Tt.transitionOut=Tt.transitionOut>=Tt.transitionNames.length-1?0:Tt.transitionOut+1:mouseButton===RIGHT&&(Tt.transitionOut=Tt.transitionOut<=0?Tt.transitionNames.length-1:Tt.transitionOut-1))):3===e&&(0===d?kn("timelineSnap"):1===d?(J=Tt.timelineBPM,Tt.playing&&en(),Ri({var:[Tt,"timelineBPM"],title:"edit_tool_bpm_inp",type:"number",allowEmpty:!1,after:function(){var e=Tt.timelineBPM/Tt.bpm;Tt.time=Ot(Tt.time/J*Tt.timelineBPM*e*(1/Tt.snap))*Tt.snap/e,Tt.editorHSStart=!1,Tt.metronomeLast=!1}})):2===d?(_=Tt.timelineOffset,Tt.playing&&en(),Ri({var:[Tt,"timelineOffset"],title:"edit_tool_bpm_offset_inp",type:"number",allowEmpty:!1,after:function(){Tt.time+=Tt.bpm/60/1e3*(Tt.timelineOffset-_),Tt.editorHSStart=!1,Tt.metronomeLast=!1}})):3===d?An():4===d&&(Tt.playing&&en(),Tt.jumpToTimestamp=!1,Ri({var:[Tt,"jumpToTimestamp"],title:"edit_tool_timestamp",type:"string",allowEmpty:!0,after:function(){var e;null!==Tt.jumpToTimestamp&&!1!==(e=Ii(Tt.jumpToTimestamp))&&(Tt.time=e)},display:Xt({recieve:"bpm",time:Tt.time,bpm:Tt.timelineBPM,offset:Tt.timelineOffset,lvlBPM:Tt.bpm})}))))}else Tt.exiting?(r=(width/2-2*kt)/1.5,h=height/4/1.5,Ft("rcorner",width/4-r/2,height/4*2.5-h/4,r,h)&&(Tt.buttonHover[2]/=2,yn()),Ft("rcorner",width/4*3-r/2,height/4*2.5-h/4,r,h)&&(Tt.buttonHover[3]/=2,Tt.exiting=!1)):(Tt.menuNSM.click(),Ft("rcorner",width/Tt.tools.length*(Tt.tools.length-1),height-height/16*Tt.headerY,width/Tt.tools.length,height/16*-(Tt.toolsH+1))&&(Tt.menu=!1))}else Tt.paused&&1===Tt.disMode&&!1===Tt.resumeTime&&(Ft("rcorner",width/2-width/4/2,height/2-height/8/2-height/8*1.25,width/4,height/8)?Mn("continue"):Ft("rcorner",width/2-width/4/2,height/2-height/8/2,width/4,height/8)&&Mn("retry"),Ft("rcorner",width/2-width/4/2,height/2-height/8/2+height/8*1.25,width/4,height/8))&&Mn("menu");2===Tt.disMode&&!1===Tt.edit&&(Ft("rcorner",width/3*2+kt,height-height/8-kt,width/3-2*kt,height/8)?Mn("menu"):Ft("rcorner",width/3*2+kt,height-height/8*2-2*kt,width/3-2*kt,height/8)?Mn("retry"):Tt.performanceDotCallback&&Tt.performanceDotCallback())}};let us=function(){var e=width>height?width/64:height/64;Ft("rcorner",2*e,height/16+2*e,(width>height?height:width)/3-2*e,(width>height?height:width)/3-2*e)&&(re.type="image",re.sizeLimit=512e3,re.success=function(e){B("changePP",{pp:e.data,user:T.uuid,session:T.session})},settingsFileInput.elt.click()),Ft("rcorner",3*e+(width>height?height:width)/3-2*e,height/16+e+(width>height?height:width)/3/4*3-(width>height?height:width)/3/4/1.5/2,width/3*1.5-(width>height?height:width)/3-2*e,(width>height?height:width)/3/4/1.5)&&(Bt.account.countryScreen=!0),Ft("rcorner",e,height/16+2*e+height/3,width/3*1.5,height/3*2-height/16-3*e-3*e)&&(Bt.newBio="",e=(e=Ut(T.uuid,"uuid").bio)!==String(e)?void 0:e.substr(0,256),Bt.newBio=e,Ri({var:[Bt,"newBio"],title:"menu_account_changeBio",type:"string",allowEmpty:!0,after:function(){B("changeBio",{bio:Bt.newBio.substr(0,256),user:T.uuid,session:T.session})}})),$n()},vs=function(){mouseY>height/16&&B("changeCountry",{country:Me[xt][Bt.account.countrySel][1],user:T.uuid,session:T.session})},ms=function(){for(var e=0;e<Bt.online.searchedUsers.length;e++)Ft("rcorner",kt+((width-width/48-4*kt)/3+kt)*(e%3),kt+height/16+height/24+5*kt*floor(e/3)+(-(kt+height/16+height/24+5*kt*floor((Bt.online.searchedUsers.length-1)/3))+height-5*kt<0?Bt.online.scroll:0),(width-width/48-4*kt)/3,4*kt,kt)&&mouseY>height/16+height/24&&(Bt.account.viewFriend=Bt.online.searchedUsers[e]);Ft("rcorner",0,height/16,height/24,height/24)&&(Bt.account.onlineOnly=!Bt.account.onlineOnly,Bt.account.tabHighlight[0]/=2,Bt.online.searchedUsers=[]),Ft("rcorner",height/24+width-height/24*4,height/16,height/24*3,height/24)&&(Bt.account.friendsScreen=!1,Bt.account.tabHighlight[1]/=2)};function ps(){if(0<T.uuid.length){for(var e=[],t=[],i=((!0===Ut(T.uuid,"uuid").contributor?e:t).push([3,"theme_contributor"]),(Ut(T.uuid,"uuid").patreon>w?e:t).push([4,"theme_platinum"],[5,"theme_gold"],[6,"theme_blackGold"],[7,"theme_premium"],[8,"theme_ruby"],[9,"theme_amethyst"]),Bt.settings.menu.pages[0].items[2]),o=0;o<e.length;o++)-1===i.options.indexOf(e[o][0])&&(i.options.push(e[o][0]),i.labels.push(e[o][1]));for(var n,o=0;o<t.length;o++)-1!==i.options.indexOf(t[o][0])&&(n=i.indexOf(t[o][0]),i.options.splice(n,1),i.labels.splice(n,1),Bt.settings.themeSel===t[o][0])&&(Bt.settings.themeSel=i.options[0])}var s;!0===Bt.lvl.downloading&&(Ht[Ht.length]={},s=Ht.length-1,Ht[s].beat=Bt.lvl.downloadVar.beat,Ht[s].id=Bt.lvl.downloadVar.id,Ht[s].bpm=Bt.lvl.downloadVar.bpm,Ht[s].ar=Bt.lvl.downloadVar.ar,Ht[s].hpD=Bt.lvl.downloadVar.hpD,Ht[s].effects=Bt.lvl.downloadVar.effects,Ht[s].song=Bt.lvl.downloadVar.song,Ht[s].bg=Bt.lvl.downloadVar.bg,Ht[s].songOffset=Bt.lvl.downloadVar.songOffset,Ht[s].title=Bt.lvl.downloadVar.title,Ht[s].desc=Bt.lvl.downloadVar.desc,Ht[s].author=Bt.lvl.downloadVar.author,Bt.lvl.downloading=!1)}function bs(){G(),it!==Bt.settings.fpsLimit&&(clearInterval(he),"vsync"!==Bt.settings.fpsLimit&&(he=setInterval(()=>gs(),1e3/Bt.settings.fpsLimit)),it=Bt.settings.fpsLimit),no.gain.setValueAtTime(0,oo.currentTime),w=Math.round((new Date).getTime()/1e3),rt=performance.now()-st,st=performance.now(),xe=!1,kt=width>height?width/64:height/64;var e=verge.viewportW(),t=verge.viewportH(),e=(!(0===Ke||1e3<=millis()-Ke)||width===e&&height===t||(resizeCanvas(e,t),console.log("Resized"),Ke=millis(),fitth=width>height?height:width),Fe.log.push(rt),50<Fe.log.length&&Fe.log.shift(),Fe.log.reduce((e,t)=>e+t,0)/Fe.log.length);Fe.dis=1/(e/1e3),"c25cd9c8-d6e1-4d7e-8faa-ecd5e277c833"===T.uuid&&(Tt.ranks[Tt.ranks.length-2].symbol="7"),0===Bt.settings.language?xt="en":1===Bt.settings.language?xt="de":2===Bt.settings.language?xt="es":3===Bt.settings.language?xt="fr":4===Bt.settings.language?xt="ru":5===Bt.settings.language?xt="nl":6===Bt.settings.language?xt="th":7===Bt.settings.language?xt="ro":8===Bt.settings.language?xt="pt_BR":9===Bt.settings.language?xt="pl":10===Bt.settings.language?xt="tl":11===Bt.settings.language&&(xt="tr"),Tt.hitValues[0].name=Pt("game_hit_marvelous",xt),Tt.hitValues[1].name=Pt("game_hit_great",xt),Tt.hitValues[2].name=Pt("game_hit_good",xt),Tt.hitValues[3].name=Pt("game_hit_ok",xt),Tt.hitValues[4].name=Pt("game_hit_miss",xt),0===Bt.settings.keyboard?Tt.keys=["R","T","Y","F","G","H","V","B","N"]:1===Bt.settings.keyboard?Tt.keys=["R","T","Z","F","G","H","V","B","N"]:2===Bt.settings.keyboard?Tt.keys=[["Numpad7","Digit7"],["Numpad8","Digit8"],["Numpad9","Digit9"],["Numpad4","Digit4"],["Numpad5","Digit5"],["Numpad6","Digit6"],["Numpad1","Digit1"],["Numpad2","Digit2"],["Numpad3","Digit3"]]:3===Bt.settings.keyboard?Tt.keys=["KeyR","KeyT","KeyY","KeyF","KeyG","KeyH","KeyV","KeyB","KeyN"]:4===Bt.settings.keyboard?Tt.keys=["PrintScreen","ScrollLock","Pause","Insert","Home","PageUp","Delete","End","PageDown"]:5===Bt.settings.keyboard&&(Tt.keys=[["KeyR","Numpad7","Digit7"],["KeyT","Numpad8","Digit8"],["KeyY","Numpad9","Digit9"],["KeyF","Numpad4","Digit4"],["KeyG","Numpad5","Digit5"],["KeyH","Numpad6","Digit6"],["KeyV","Numpad1","Digit1"],["KeyB","Numpad2","Digit2"],["KeyN","Numpad3","Digit3"]]),!(Ut(T.uuid,"uuid").patreon>w)&&"Loading..."!==Ut(T.uuid,"uuid").patreon&&"Loading..."!==Ut(T.uuid,"uuid").user&&null!==Ut(T.uuid,"uuid").user&&void 0!==Ut(T.uuid,"uuid").user&&0<T.uuid.length&&(Bt.settings.menuMusic="",Bt.settings.defaultBackground=""),$=qe[Bt.settings.themeSel]}function c(){imageMode(CORNER),Wt(0<Bt.settings.defaultBackground.length?_t(Bt.settings.defaultBackground):St.bg,"zoom",0,0,width,height),noStroke(),rectMode(CORNER),fill(0,Bt.settings.bgDim/100*255),rect(0,0,width,height),s.bg+=At(0,s.bg,.2),!1!==Ne&&"hidden"!==Ne||!1===Bt.newSong.verify&&!1===Bt.song.listening&&(Bt.loopVol+=At(Bt.settings.menuMusicVolume,Bt.loopVol,.2),soundManager.setVolume("menuMusic",Bt.loopVol),void 0!==Lt(parseInt(Bt.lvl.prevPlay),"id").name&&void 0!==Qt[Bt.lvl.prevPlay]&&(Tt.songVol+=At(0,Tt.songVol,.2),Qt[Bt.lvl.prevPlay].volume(Bt.lvl.songVol*Bt.settings.musicVolume)),0===Ot(Tt.songVol))&&void 0!==Bt.lvl.prevPlay&&null!==Bt.lvl.prevPlay&&(Qt[Bt.lvl.prevPlay].seek(0),Qt[Bt.lvl.prevPlay].playing())&&Qt[Bt.lvl.prevPlay].stop(),noStroke(),rectMode(CORNER),fill(255,255,255,s.bg),rect(0,0,width,height),"logo"===Bt.screen?(s.theta+=.25,90<=s.theta&&(s.theta-=90),0===s.pulseTime&&(s.pulseTime=millis()),millis()-s.pulseTime>6e4/140&&(s.pulseBackR=s.theta,s.pulseBackS=s.size*(width/4)+2*s.pulse,s.pulse=1,s.pulseTime=millis()),s.pulse=Et(millis()-s.pulseTime,millis()-s.pulseTime,1,.2,6e4/140)):"main trans"===Bt.screen&&(s.pulse+=At(1,s.pulse,.2),s.w+=At(width/100,s.w,.2),s.h+=At(height/100,s.h,.2),s.size+=At(1,s.size,.2),s.theta+=At(0,s.theta,.2),s.strC[3]+=At(0,s.strC[3],.2),s.fillC[0]+=At(red($.main),s.fillC[0],.2),s.fillC[1]+=At(green($.main),s.fillC[1],.2),s.fillC[2]+=At(blue($.main),s.fillC[2],.2),Ot(5*s.w)===Ot(width/100*5))&&(Bt.screen="lvl"),!1!==Bt.trans&&(Bt.sideW+=At(6,Bt.sideW,.3),Bt.sideTextA+=At(0,Bt.sideTextA,.6),Ot(width/6*Bt.sideW)===width&&(Bt.sideW=6,Bt.sideTextA=0,Bt.sideX+=At(6,Bt.sideX,.3),Bt.screen=Bt.trans),Ot(width/6*Bt.sideX)===width)&&(Bt.side=!1,Bt.sideW=1,Bt.sideTextA=255,Bt.sideX=-1,Bt.trans=!1),"logo"===Bt.screen||"main trans"===Bt.screen?c.logo():c.pages()}function ws(){background(10),fill(255),textAlign(CENTER,CENTER),3e3<=millis()?Dt(Pt("clickToPlay",xt),width/2,height-height/8,width,height/32):Dt(Pt("loading",xt),width/2,height-height/8,width,height/32)}function Cs(){background(255);var e=width>height?width/64:height/64,t=(fill(0,s.textA),textSize(100),textAlign(CENTER,CENTER),Pt("welcome",xt)+(1===s.wave?" o/":"")),i=(fill(0,0),Dt(t,width/2,height/2,width/4,height/4),split(t,""));textAlign(LEFT,CENTER),textSize(5*e),noStroke();for(var o,n=0;n<i.length;n++)void 0!==Ze[n]?(push(),translate(0,8*e*Ze[n]),fill(0,255-255*(abs(Ze[n])<.25?4*abs(Ze[n]):1)),o=textWidth(t.substr(0,n)),text(i[n],width/2+o-textWidth(t)/2,height/2),s.drop?Ze[n]+=At(pow(-1,n),Ze[n],.15*Ze.length/7*(n<Ze.length-1?abs(Ze[n+1]):1)):Ze[n]+=At(0,Ze[n],(.075-.03*n/i.length)*(0<n?abs(abs(Ze[n-1])-1):1)),pop()):Ze[n]=pow(-1,n);!1===s.drop&&(rectMode(CORNER),fill(190),rect(0,0-height/2*(1-abs(Ze[3]))*1,width,height/2),rect(0,height/2+height/2*(1-abs(Ze[3]))*1,width,height/2),fill(130),rect(0,0-height/2*(1-abs(Ze[2]))*1,width,height/2),rect(0,height/2+height/2*(1-abs(Ze[2]))*1,width,height/2),fill(70),rect(0,0-height/2*(1-abs(Ze[1]))*1,width,height/2),rect(0,height/2+height/2*(1-abs(Ze[1]))*1,width,height/2),fill(10),rect(0,0-height/2*(1-abs(Ze[0]))*1,width,height/2),rect(0,height/2+height/2*(1-abs(Ze[0]))*1,width,height/2),fill(255),textAlign(CENTER,CENTER),Dt(Pt("clickToPlay",xt),width/2,height-height/8+height/2*(1-abs(Ze[0]))*1,width,height/32),5e3<=millis()-s.startTime)&&(s.drop=!0,s.dropTime=millis()),!1===s.drop?s.textA+=At(255,s.textA,.1):(s.textA+=At(0,s.textA,.1),push(),rectMode(CENTER),translate(width/2,s.boxY),noStroke(),rotate("menu trans"===Bt.screen?-s.theta:0),rectMode(CENTER),fill(255),rect(0,0,5*s.cross,height*s.cross),rotate(-s.theta),fill(s.fillC[0],s.fillC[1]/175*125,s.fillC[2]/255*205,s.fillC[3]),strokeWeight(.05*s.size*((width<height?width:height)/3)),stroke(s.strC[0],s.strC[1],s.strC[2],s.strC[3]),rect(0,0,s.size*((width<height?width:height)/3),s.size*((width<height?width:height)/3)),rotate(22.5*s.size),fill(s.fillC[0],s.fillC[1],s.fillC[2],s.fillC[3]),strokeWeight(.05*s.size*((width<height?width:height)/3)),stroke(s.strC[0],s.strC[1],s.strC[2],s.strC[3]),rect(0,0,s.size*((width<height?width:height)/3),s.size*((width<height?width:height)/3)),noStroke(),rotate(-22.5*s.size),rotate(s.theta),textStyle(BOLD),$e="",textAlign(CENTER,CENTER),textSize(+s.size/500*250*((width<height?width:height)/3)),fill(0,s.strC[3]/255*100),text("Pulsus",0+(width<height?width:height)/500*5,0+(width<height?width:height)/500*5),fill(s.strC[0],s.strC[1],s.strC[2],s.strC[3]),text("Pulsus",0,0),"Pulsus"!==Pt("title_transliteration",xt)&&(push(),scale(+s.size),textSize((width<height?width:height)/3*.5/5),fill(0,s.strC[3]/255*100),text(Pt("title_transliteration",xt),4*-e+(width<height?width:height)/500*1.15,3*e+(width<height?width:height)/500*1.15),fill(s.strC[0],s.strC[1],s.strC[2],s.strC[3]),text(Pt("title_transliteration",xt),4*-e,3*e),pop()),!0===Xe.active&&(fill(255,0,0,s.strC[3]),text("ADMIN",0,height/4)),pop(),millis()<s.dropTime+1e3?(s.boxY=Bi(millis()-s.dropTime,millis()-s.dropTime,0,height/2,999),s.size=fi(millis()-s.dropTime,millis()-s.dropTime,100,250,999)/350,s.theta=fi(millis()-s.dropTime,millis()-s.dropTime,0,-540,999),s.fillC[0]=vi(millis()-s.dropTime,millis()-s.dropTime,0,0,999),s.fillC[1]=vi(millis()-s.dropTime,millis()-s.dropTime,0,175,999),s.fillC[2]=vi(millis()-s.dropTime,millis()-s.dropTime,0,255,999),s.fillC[3]=vi(millis()-s.dropTime,millis()-s.dropTime,255,0,999),s.strC[0]=vi(millis()-s.dropTime,millis()-s.dropTime,0,255,999),s.strC[1]=vi(millis()-s.dropTime,millis()-s.dropTime,0,255,999),s.strC[2]=vi(millis()-s.dropTime,millis()-s.dropTime,0,255,999),s.strC[3]=vi(millis()-s.dropTime,millis()-s.dropTime,255,0,999)):(s.fillC[0]=0,s.fillC[1]=175,s.fillC[2]=255,s.fillC[3]=255,s.strC[0]=255,s.strC[1]=255,s.strC[2]=255,s.strC[3]=255,s.boxY=height/2,s.size=1,s.w=s.size,s.h=s.size,to(),He="menu"))}function ys(e){if(e.length<=1)return e}fs.screens.accountSignedIn=function(){0<T.uuid.length&&!Bt.account.countryScreen&&!Bt.account.friendsScreen?us():Bt.account.countryScreen?vs():!1!==Bt.account.friendsScreen&&!1===Bt.account.viewFriend?ms():!1!==Bt.account.friendsScreen&&!1!==Bt.account.viewFriend&&$n("account")},fs.screens.accountSignedOut=function(){var e=width>height?width/64:height/64;Bt.account.overlayOn?(Ft("rcorner",3*e,height/16+height/32*3+7*e+height/16*8,width/8,height/16)?("haveCode"===Bt.account.mode?Bt.account.mode="resetPassword":"resetPasswordConf"===Bt.account.mode?Bt.account.mode="haveCode":(Bt.account.overlayOn=!1,Bt.account.user="",Bt.account.email="",Bt.account.pass="",Bt.account.passConf="",Bt.account.code="",Bt.account.codeUuid=""),Bt.account.errors=[],Bt.account.blankErrors=[],Bt.account.takenErrors=[],Bt.account.resetPassComplete=!1,Bt.account.buttonHover[2]/=2):Ft("rcorner",4*e+width/8,height/16+height/32*3+7*e+height/16*8,width/8,height/16)&&("signup"===Bt.account.mode?hn():"login"===Bt.account.mode?an():"resetPassword"===Bt.account.mode?fn():"haveCode"===Bt.account.mode?un():"resetPasswordConf"===Bt.account.mode&&vn(),Bt.account.buttonHover[3]/=2),"signup"===Bt.account.mode?Ft("rcorner",3*e,height/16+height/32*3+3*e+height/16,width/2,height/16)?Ri({var:[Bt.account,"user"],title:"menu_account_username",type:"string",allowEmpty:!0,after:function(){(Bt.account.blankErrors[0]||Bt.account.takenErrors[0])&&0<Bt.account.user.length&&(Bt.account.blankErrors[0]=!1,Bt.account.takenErrors[0]=!1)}}):Ft("rcorner",3*e,height/16+height/32*3+4*e+height/16*3,width/2,height/16)?Ri({var:[Bt.account,"email"],title:"menu_account_email",type:"string",allowEmpty:!0,after:function(){(Bt.account.blankErrors[1]||Bt.account.takenErrors[1])&&0<Bt.account.email.length&&(Bt.account.blankErrors[1]=!1,Bt.account.takenErrors[1]=!1)}}):Ft("rcorner",3*e,height/16+height/32*3+5*e+height/16*5,width/2,height/16)?Ri({var:[Bt.account,"pass"],title:"menu_account_password",type:"string",allowEmpty:!0,password:!0,after:function(){Bt.account.blankErrors[2]&&0<Bt.account.pass.length&&(Bt.account.blankErrors[2]=!1)}}):Ft("rcorner",3*e,height/16+height/32*3+6*e+height/16*7,width/2,height/16)&&Ri({var:[Bt.account,"passConf"],title:"menu_account_passwordConfirm",type:"string",allowEmpty:!0,password:!0,after:function(){Bt.account.blankErrors[3]&&0<Bt.account.passConf.length&&(Bt.account.blankErrors[3]=!1)}}):"login"===Bt.account.mode?Ft("rcorner",3*e,height/16+height/32*3+3*e+height/16,width/2,height/16)?Ri({var:[Bt.account,"email"],title:"menu_account_email",type:"string",allowEmpty:!0,after:function(){(Bt.account.blankErrors[1]||Bt.account.takenErrors[1])&&0<Bt.account.email.length&&(Bt.account.blankErrors[1]=!1,Bt.account.takenErrors[1]=!1)}}):Ft("rcorner",3*e,height/16+height/32*3+4*e+height/16*3,width/2,height/16)&&Ri({var:[Bt.account,"pass"],title:"menu_account_password",type:"string",allowEmpty:!0,password:!0,after:function(){Bt.account.blankErrors[2]&&0<Bt.account.pass.length&&(Bt.account.blankErrors[2]=!1)}}):"resetPassword"===Bt.account.mode?Ft("rcorner",3*e,height/16+height/32*3+3*e+height/16,width/2,height/16)?Ri({var:[Bt.account,"user"],title:"menu_account_username",type:"string",allowEmpty:!0,after:function(){(Bt.account.blankErrors[0]||Bt.account.takenErrors[0])&&0<Bt.account.user.length&&(Bt.account.blankErrors[0]=!1,Bt.account.takenErrors[0]=!1)}}):Ft("rcorner",3*e,height/16+height/32*3+4*e+height/16*3,width/2,height/16)?Ri({var:[Bt.account,"email"],title:"menu_account_email",type:"string",allowEmpty:!0,after:function(){(Bt.account.blankErrors[1]||Bt.account.takenErrors[0])&&0<Bt.account.email.length&&(Bt.account.blankErrors[1]=!1,Bt.account.takenErrors[0]=!1)}}):Ft("rcorner",5*e+width/8*2,height/16+height/32*3+7*e+height/16*8,width/2-2*e-width/8*2,height/16)&&(Bt.account.mode="haveCode",Bt.account.errors=[],Bt.account.blankErrors=[],Bt.account.takenErrors=[]):"haveCode"===Bt.account.mode?Ft("rcorner",3*e,height/16+height/32*3+3*e+height/16,width/2,height/16)&&Ri({var:[Bt.account,"code"],title:"menu_account_code",type:"string",allowEmpty:!0,after:function(){(Bt.account.blankErrors[4]||Bt.account.takenErrors[4])&&0<Bt.account.code.length&&(Bt.account.blankErrors[4]=!1,Bt.account.takenErrors[4]=!1)}}):"resetPasswordConf"===Bt.account.mode&&(Ft("rcorner",3*e,height/16+height/32*3+3*e+height/16,width/2,height/16)?Ri({var:[Bt.account,"pass"],title:"menu_account_passwordNew",type:"string",allowEmpty:!0,password:!0,after:function(){Bt.account.blankErrors[2]&&0<Bt.account.pass.length&&(Bt.account.blankErrors[2]=!1)}}):Ft("rcorner",3*e,height/16+height/32*3+4*e+height/16*3,width/2,height/16)&&Ri({var:[Bt.account,"passConf"],title:"menu_account_passwordConfirm",type:"string",allowEmpty:!0,password:!0,after:function(){Bt.account.blankErrors[3]&&0<Bt.account.passConf.length&&(Bt.account.blankErrors[3]=!1)}}))):Ft("rcorner",e,height/16+height/32*3+2*e,width/4,height/8)?(Bt.account.mode="signup",Bt.account.overlayOn=!0,Bt.account.buttonHover[0]/=2):Ft("rcorner",e,height/16+height/32*3+height/8+3*e,width/4,height/8)?(Bt.account.mode="login",Bt.account.overlayOn=!0,Bt.account.buttonHover[1]/=2):Ft("rcorner",e,height/16+height/32*3+height/8*2+4*e,width/4,height/8)&&(Bt.account.mode="resetPassword",Bt.account.overlayOn=!0,Bt.account.buttonHover[4]/=2)},fs.screens.click=function(){He="welcome",eo(),s.startTime=millis()},fs.screens.logo=function(){Ft("rcorner",width-7*kt,height-7*kt*(s.strC[3]/255),6*kt,6*kt)?(p(),Bt.lvl.buttonHover[19]/=2):(Bt.screen="main trans",s.pulse=0)},fs.screens.header=function(){Ft("rcorner",height/64-height/128/4,height/64-height/128/4,height/32+height/128/2,height/32+height/128/2)&&(Bt.side=!Bt.side)},fs.screens.nav=function(){for(var e=0;e<Bt.nav.length;e++)mouseX<abs(width/5+width/5*Bt.sideX)&&mouseY>height/16+height/16*e+height/16/2&&mouseY<height/16+height/16*e+(height/16+height/16/2)?Bt.nav[e][1]!==Bt.screen?(Bt.trans=Bt.nav[e][1],Bt.song.listening&&(Rt=[],Rt=O.search,Bt.song.listening=!1,soundManager.pause(Rt[Bt.song.sel]),soundManager.setVolume("menuMusic",Bt.settings.menuMusicVolume))):Bt.side=!1:mouseX>abs(width/5*Bt.sideW+Bt.sideX)&&mouseY>height/16&&(Bt.side=!1)},fs.notifications=function(e){for(var t=0;t<e.length;t++){var i=e[t];i.hitbox&&i.event(i.item)}},fs.prmpting=function(){Ft("rcorner",8*kt,height/2+2*kt,20*kt,4*kt)?ki("cancel"):Ft("rcorner",width-8*kt-20*kt,height/2+2*kt,20*kt,4*kt)&&ki("submit")},fs.prmptingColor=function(){g.hsbNSM.click(),g.rgbNSM.click(),Ft("rcorner",width/16*3+width/4*2,3*Ot(height/12*2)+height/16,width/4,4*kt)&&Qi("submit"),Ft("rcorner",width/16*3+width/4*2,Ot(height/12*2)+3*Ot(height/12*2)+height/16,width/4,4*kt)&&Qi("cancel")},c.account={},c.logo=function(){push(),rectMode(CENTER),push(),translate(width/2,height/2),noStroke(),rotate("menu trans"===Bt.screen?-s.theta:0),rectMode(CENTER),fill(255),rect(0,0,5*s.cross,height*s.cross),rotate(-s.theta),pop(),push(),translate(width/2,height/2),translate((width<height?width:height)/500*5,(width<height?width:height)/500*5),fill(0,100),noStroke(),rotate(s.theta),rect(0,0,s.w*s.pulse*((width<height?width:height)/3)+.05*s.size*((width<height?width:height)/3),s.h*s.pulse*((width<height?width:height)/3)+.05*s.size*((width<height?width:height)/3)),pop(),push(),translate(width/2,height/2),rotate(s.theta),fill(s.fillC[0],s.fillC[1]/175*125,s.fillC[2]/255*205,s.fillC[3]),strokeWeight(.05*s.size*((width<height?width:height)/3)),stroke(s.strC[0],s.strC[1],s.strC[2],s.strC[3]),rect(0,0,s.w*s.pulse*((width<height?width:height)/3),s.h*s.pulse*((width<height?width:height)/3)),pop(),push(),translate(width/2,height/2),translate((width<height?width:height)/500*5,(width<height?width:height)/500*5),fill(0,100),noStroke(),rotate(s.theta),rotate(22.5),rect(0,0,s.w*(s.pulse/3*2+1/3)*((width<height?width:height)/3)+.05*s.size*((width<height?width:height)/3),s.h*(s.pulse/3*2+1/3)*((width<height?width:height)/3)+.05*s.size*((width<height?width:height)/3)),pop(),push(),translate(width/2,height/2),rotate(s.theta),rotate(22.5),fill(s.fillC[0],s.fillC[1],s.fillC[2],s.fillC[3]),strokeWeight(.05*s.size*((width<height?width:height)/3)),stroke(s.strC[0],s.strC[1],s.strC[2],s.strC[3]),rect(0,0,s.w*(s.pulse/3*2+1/3)*((width<height?width:height)/3),s.h*(s.pulse/3*2+1/3)*((width<height?width:height)/3)),noStroke(),rotate(-22.5),rotate(-s.theta),textStyle(BOLD),$e="",textAlign(CENTER,CENTER),textSize(s.size*(s.pulse/3+2/3)/500*250*((width<height?width:height)/3)),fill(0,s.strC[3]/255*100),text("Pulsus",0+(width<height?width:height)/500*5,0+(width<height?width:height)/500*5),fill(s.strC[0],s.strC[1],s.strC[2],s.strC[3]),text("Pulsus",0,0),"Pulsus"!==Pt("title_transliteration",xt)&&(push(),scale(s.size*(s.pulse/3+2/3)),textSize((width<height?width:height)/3*.5/5),fill(0,s.strC[3]/255*100),text(Pt("title_transliteration",xt),4*-kt+(width<height?width:height)/500*1.15,3*kt+(width<height?width:height)/500*1.15),fill(s.strC[0],s.strC[1],s.strC[2],s.strC[3]),text(Pt("title_transliteration",xt),4*-kt,3*kt),pop()),!0===Xe.active&&(fill(255,0,0,s.strC[3]),text("ADMIN",0,height/4)),pop(),pop(),fill(s.strC[0],s.strC[1],s.strC[2],s.strC[3]),textAlign(CENTER,BOTTOM),textSize(kt),text(Pt("earlyAccess",xt),width/2,height-kt),Kt(width-7*kt,height-7*kt*(s.strC[3]/255),6*kt,6*kt,"",Bt.account.buttonHover,19,{discord:!0})},c.home=function(){fill(255),textSize(75),textAlign(LEFT,TOP),Dt(Pt("menu_home_title",xt),width/32,height/32*3,width,height/32*3)},c.lvl=function(){Yo("lvl")},c.settings=function(){Bt.settings.menu.draw({x:0,y:height/16,width:width,height:height-height/16,stacked:!1,maxBarHeight:height/16,buffer:(height-height/16)/64}),Bt.settings.menu.data.page!==Bt.settings.menu.pages.length-1||Ut(T.uuid,"uuid").patreon>w||(Bt.settings.menu.data.page=0,Bt.screen="patreon")},c.credits=function(){var e=width>height?width/64:height/64,t=(textAlign(CENTER,CENTER),fill($.text),[Pt("credits_client",xt),"TetroGem",Pt("credits_server",xt),U(["TetroGem","Epicness","Quintec"]),Pt("credits_programming",xt),"cg505",Pt("credits_security",xt),"Quintec",Pt("credits_art",xt),Pt("credits_and",xt,"TetroGem","Alexandre Declos"),Pt("credits_translation_de",xt),"Scath",Pt("credits_translation_es",xt),"Zemyro",Pt("credits_translation_fr",xt),Pt("credits_and",xt,"Alexandre Declos","Zemyro"),Pt("credits_translation_ru",xt),Pt("credits_and",xt,"ConfiG","Shiairo31"),Pt("credits_translation_nl",xt),"sbeve",Pt("credits_translation_th",xt),"oserottoNeko",Pt("credits_translation_ro",xt),"Stqrm26",Pt("credits_patreon",xt),U(["-Wiffles-","cg505","tokaku","Aero","ari","Lae_","Mungaru","rice","Tele_Crab","Tree42","AFasterSlowpoke","Arvid707","Cynth","Generic","ito","sbeve","sneaki"])]),i=(height-height/16)/(t.length+2);textSize(i);for(var o=0;o<t.length;o++)Dt(t[o],width/2,height/2+i*(-t.length/2+o)+i/2+i/1.5/2,width-2*e,i/(o%2==0?1:1.5),o%2==0&&"bold")},c.socialMedia=function(){var e=width>height?width/64:height/64;imageMode(CENTER),image(1===Bt.settings.themeSel?St.discordLogoInvert:St.discordLogo,width/2,height/2-height/8-e,height/8*2,height/8*2),Kt(width/2-width/4/2,height/2,width/4,height/8,Pt("socialMedia_discord",xt),Bt.socialMedia.buttonHover,0)},c.patreon=function(){var e=width>height?width/64:height/64;Ut(T.uuid,"uuid").patreon>w?(fill($.text),textAlign(CENTER,CENTER),Dt(Pt("patreon_thanks",xt),width/2,height-height/8,width,height/16),Dt(Pt("patreon_joined",xt),width/2,height/4,width,height/32),imageMode(CENTER),image(St.platinum,width/2,height/2,height/2,height/2)):(fill($.text),textAlign(CENTER,CENTER),Dt(Pt("patreon_1",xt),width/2,height/2-height/16*4-e,width,height/16),textSize(height/16/1.5),textAlign(CENTER,CENTER),text(Pt("patreon_2",xt),width/2-width/2/2,height/2-height/16*4/2,width/2,height/16*4),imageMode(CENTER),image(1===Bt.settings.themeSel?St.patreonLogoInvert:St.patreonLogo,width/16*7,height/2-height/8-e,height/8*(2430/495),height/8),image(St.platinum,width/16*11,height/2-height/8-e,height/8,height/8),Kt(width/2-width/4/2,height/2+height/8,width/4,height/8,Pt("patreon_button",xt),Bt.socialMedia.buttonHover,0))},c.changelog=function(){var e=width>height?width/64:height/64,t=(push(),0!==Mt()&&(Bt.changelog.scroll+=e*Mt()/100),Vt*=.25,e/1.5),i=e,o=height/16+e,t=(textSize(t),Di(l,t,textLeading())),n=height-height/16*2,s=t-n,n=(Bt.changelog.scroll=constrain(Bt.changelog.scroll,0,s),push(),(height-height/16-e)*(n/t));translate(0,height/16+e/2),translate(0,(height-(height/16+e/2)-n-e/2)*(Bt.changelog.scroll/s)),fill(255),rectMode(CORNER),rect(width-.75*e,0,e/2,n,e),pop(),translate(0,-Bt.changelog.scroll),fill(255),textAlign(LEFT,TOP),text(l,i,o,width,t),pop()},c.online=function(){if("main"===Bt.online.mode)Co("main");else if("viewUser"===Bt.online.mode)wo(Bt.online.viewUser,"public");else if("song"===Bt.online.mode)Yo("song");else if("newSong"===Bt.online.mode){if(fill(255),textAlign(LEFT,TOP),Dt(Pt("menu_newSong_title",xt),width/32,height/32*3,width/2,height/32*3),rectMode(CORNER),fill(65,80,90,255),rect(width/4+width/32/2,(height-(height/16+height/32*3))/16*2+(height/16+height/32*3),width/4*3-width/32,(height-(height/16+height/32*3))/8),textAlign(RIGHT,CENTER),fill(255),Dt(Pt("menu_newSong_songTitle",xt),width/4-width/32/2,(height-(height/16+height/32*3))/16*2+(height/16+height/32*3)+(height-(height/16+height/32*3))/8/2,(width/4-width/32)/1.5,(height-(height/16+height/32*3))/8/1.5),textAlign(CENTER,CENTER),fill(255),Dt(Bt.newSong.title,width/4+width/32/2+(width/4*3-width/32)/2,(height-(height/16+height/32*3))/16*2+(height/16+height/32*3)+(height-(height/16+height/32*3))/8/2,(width/4*3-width/32)/1.5,(height-(height/16+height/32*3))/8/1.5),rectMode(CORNER),fill(65,80,90,255),rect(width/4+width/32/2,(height-(height/16+height/32*3))/16*5+(height/16+height/32*3),width/4*3-width/32,(height-(height/16+height/32*3))/8),textAlign(RIGHT,CENTER),fill(255),Dt(Pt("menu_newSong_songArtist",xt),width/4-width/32/2,(height-(height/16+height/32*3))/16*5+(height/16+height/32*3)+(height-(height/16+height/32*3))/8/2,(width/4-width/32)/1.5,(height-(height/16+height/32*3))/8/1.5),textAlign(CENTER,CENTER),fill(255),Dt(Bt.newSong.artist,width/4+width/32/2+(width/4*3-width/32)/2,(height-(height/16+height/32*3))/16*5+(height/16+height/32*3)+(height-(height/16+height/32*3))/8/2,(width/4*3-width/32)/1.5,(height-(height/16+height/32*3))/8/1.5),rectMode(CORNER),fill(65,80,90,255),rect(width/4+width/32/2,(height-(height/16+height/32*3))/16*8+(height/16+height/32*3),width/4*3-width/32,(height-(height/16+height/32*3))/8),textAlign(RIGHT,CENTER),fill(255),Dt(Pt("menu_newSong_songLink",xt),width/4-width/32/2,(height-(height/16+height/32*3))/16*8+(height/16+height/32*3)+(height-(height/16+height/32*3))/8/2,(width/4-width/32)/1.5,(height-(height/16+height/32*3))/8/1.5),textAlign(CENTER,CENTER),fill(255),Dt(Bt.newSong.link,width/4+width/32/2+(width/4*3-width/32)/2,(height-(height/16+height/32*3))/16*8+(height/16+height/32*3)+(height-(height/16+height/32*3))/8/2,(width/4*3-width/32)/1.5,(height-(height/16+height/32*3))/8/1.5),rectMode(CORNER),fill(255),rect(width/4+width/32/2,(height-(height/16+height/32*3))/16*11+(height/16+height/32*3),(width/4*3-width/32)/3,(height-(height/16+height/32*3))/8,height/64),textAlign(CENTER,CENTER),fill(0),Dt(Pt("menu_newSong_verify",xt),width/4+width/32/2+(width/4*3-width/32)/3/2,(height-(height/16+height/32*3))/16*11+(height/16+height/32*3)+(height-(height/16+height/32*3))/8/2,(width/4*3-width/32)/3/1.5,(height-(height/16+height/32*3))/8/1.5),!0===Bt.newSong.verifyError&&(textAlign(LEFT,CENTER),fill(255,0,0,255),Dt(Pt("menu_newSong_verifyError",xt),width/4+width/32/2+(width/4*3-width/32)/3/2+(width/4*3-width/32)/3/1.5,(height-(height/16+height/32*3))/16*11+(height/16+height/32*3)+(height-(height/16+height/32*3))/8/2,(width/4*3-width/32)/3*2/1.5,(height-(height/16+height/32*3))/8/1.5)),rectMode(CORNER),fill(255),rect(width/32/2,(height-(height/16+height/32*3))/16*11+(height/16+height/32*3),(width/4*3-width/32)/3,(height-(height/16+height/32*3))/8,height/64),textAlign(CENTER,CENTER),fill(0),Dt(Pt("menu_back",xt),width/32/2+(width/4*3-width/32)/3/2,(height-(height/16+height/32*3))/16*11+(height/16+height/32*3)+(height-(height/16+height/32*3))/8/2,(width/4*3-width/32)/3/1.5,(height-(height/16+height/32*3))/8/1.5),!0===Bt.newSong.verify)if(Bt.newSong.verifyDim+=At(1,Bt.newSong.verifyDim,.2),Bt.loopVol+=At(0,Bt.loopVol,.2),soundManager.setVolume("menuMusic",Bt.loopVol),fill(0,200*Bt.newSong.verifyDim),rect(0,height/16,width,height-height/16),Bt.newSong.songObject=soundManager.getSoundById(Bt.newSong.link+"verify"),null===Bt.newSong.songObject||void 0===Bt.newSong.songObject)lo(Bt.newSong.link);else{!1===Bt.newSong.songLoading&&(soundManager.load(Bt.newSong.link+"verify"),Bt.newSong.songLoading=!0);for(var e=0;e<Bt.newSong.failedLinks.length;e++)Bt.newSong.failedLinks[e]===Bt.newSong.link&&(Bt.newSong.failedLinksCheck=!0);3===Bt.newSong.songObject.readyState&&!1===Bt.newSong.failedLinksCheck?(fill(255),Dt(Pt("menu_newSong_verify_testing",xt,Bt.newSong.artist,Bt.newSong.title),width/2,(height-height/16)/2,width/2,height/4),rectMode(CENTER),rect(width/16*5,(height-height/16)/4*3,width/4,height/8,height/64),fill(0),Dt(Pt("menu_newSong_verify_yes",xt),width/16*5,(height-height/16)/4*3,width/4/1.5,height/8/1.5),fill(255),rectMode(CENTER),rect(width/16*11,(height-height/16)/4*3,width/4,height/8,height/64),fill(0),Dt(Pt("menu_newSong_verify_no",xt),width/16*11,(height-height/16)/4*3,width/4/1.5,height/8/1.5),!1===Bt.newSong.songPlaying&&(soundManager.play(Bt.newSong.link+"verify"),Bt.newSong.songPlaying=!0),rect()):2===Bt.newSong.songObject.readyState||!0===Bt.newSong.failedLinksCheck?(fill(255),Dt(Pt("menu_newSong_verify_failed",xt),width/2,(height-height/16)/2,width/2,height/4),rectMode(CORNER),fill(255),rect(width/32/2,(height-(height/16+height/32*3))/16*11+(height/16+height/32*3),(width/4*3-width/32)/3,(height-(height/16+height/32*3))/8,height/64),textAlign(CENTER,CENTER),fill(0),Dt(Pt("menu_back",xt),width/32/2+(width/4*3-width/32)/3/2,(height-(height/16+height/32*3))/16*11+(height/16+height/32*3)+(height-(height/16+height/32*3))/8/2,(width/4*3-width/32)/3/1.5,(height-(height/16+height/32*3))/8/1.5)):(fill(255),Dt(Pt("menu_newSong_verify_downloading",xt),width/2,(height-height/16)/2,width/2,height/4))}"upload"===Bt.newSong.verify&&(fill(0,200*Bt.newSong.verifyDim),rect(0,height/16,width,height-height/16),!1===Bt.newSong.uploaded?(fill(255),Dt(Pt("menu_newSong_uploading",xt,Bt.newSong.artist,Bt.newSong.title),width/2,(height-height/16)/2,width/2,height/4)):(fill(255),Dt(Pt("menu_newSong_uploaded",xt,Bt.newSong.artist,Bt.newSong.title,Bt.newSong.uploadID),width/2,(height-height/16)/2,width/2,height/4),rectMode(CORNER),fill(255),rect(width/32/2,(height-(height/16+height/32*3))/16*11+(height/16+height/32*3),(width/4*3-width/32)/3,(height-(height/16+height/32*3))/8,height/64),textAlign(CENTER,CENTER),fill(0),Dt(Pt("menu_back",xt),width/32/2+(width/4*3-width/32)/3/2,(height-(height/16+height/32*3))/16*11+(height/16+height/32*3)+(height-(height/16+height/32*3))/8/2,(width/4*3-width/32)/3/1.5,(height-(height/16+height/32*3))/8/1.5)))}else"levels"===Bt.online.mode&&levelScreen("online")},c.morePulsus=function(){width>height?width:height;var e=Ut(T.uuid,"uuid")?.patreon>w??!1,t=Math.min(width,height),e=[{title:"pulsusPlatinum",subtitle:e?"patreon_thanks":"morePulsus_platinum_sub",image:St.platinum},{title:"morePulsus_discord",subtitle:"morePulsus_discord_sub",image:$.lightTheme?St.discordLogoInvert:St.discordLogo},{title:"morePulsus_wiki",subtitle:"morePulsus_wiki_sub",image:St.pulsusWiki},{title:"morePulsus_contribute",subtitle:"morePulsus_contribute_sub",image:St.contributorBadge}];push(),translate(width/16/2/2,height/16*1.5);let i=0;for(const o of e)push(),translate(0,height/8*1.5*i+height/8),imageMode(CENTER),Wt(o.image,"zoom",width/16,0,t/8,t/8),fill(255),textAlign(LEFT,CENTER),Dt(Pt(o.title,xt),width/8,-height/16*.5/2,width/2,height/16*1.5),Dt(Pt(o.subtitle,xt),width/8,height/16*1.5/2,width/2,height/16*.5,"italics"),Kt(width-width/4-width/16,-height/8/2,width/4,height/8,Pt("morePulsus_visit",xt),Bt.socialMedia.buttonHover,i),pop(),i++;pop()},c.pages=function(){switch(fill($.main),noStroke(),rectMode(CORNER),rect(0,0,width,height),Bt.screen){case"main":c.home();break;case"lvl":c.lvl();break;case"online":c.online();break;case"song":c.song();break;case"account":""===T.uuid?c.account.signedOut():Bt.account.countryScreen?c.account.countryScreen():!1!==Bt.account.friendsScreen?c.account.friendsScreen():c.account.signedIn();break;case"settings":c.settings();break;case"credits":c.credits();break;case"socialMedia":c.socialMedia();break;case"patreon":c.patreon();break;case"changelog":c.changelog();break;case"morePulsus":c.morePulsus()}fill($.shade),rectMode(CORNER),noStroke(),rect(0,0,width,ceil(height/16)),stroke($.text),strokeWeight(height/lerp(128,256,.25)),go(height/64,height/64,Bt.side),0===T.uuid.length?(fill(255),noStroke(),rectMode(CORNER),rect(height/16,(height/16-height/24)/2,height/24,height/24)):(imageMode(CORNER),"Loading..."!==Ut(T.uuid,"uuid").pp&&void 0!==Ut(T.uuid,"uuid").pp&&image(_t(Ut(T.uuid,"uuid").pp),height/16,(height/16-height/24)/2,height/24,height/24)),textAlign(LEFT,CENTER),fill($.text),noStroke(),Dt(0<T.uuid.length?Ut(T.uuid,"uuid").user+" / #"+Ut(T.uuid,"uuid").rank+" / "+Pt("performancePoints",xt,floor(100*Tn(T.uuid))/100):Pt("notLoggedIn",xt),height/16+height/32+height/64,height/32,width,height/32);var e=K();textAlign(RIGHT,CENTER),fill($.text),noStroke(),Dt(e<5e6?Pt("menu_lvl_saveData_ok",xt,ie(e),ie(5e6)):Pt(e<8e6?"menu_lvl_saveData_lots":"menu_lvl_saveData_max",xt,ie(e),ie(8e6)),width-height/32/2,height/32,width/4,height/32),imageMode(CENTER,CENTER),5e6<=e&&image(e<8e6?St.warningOrange:St.warningRed,width-height/32-width/4-height/32/2,height/32,height/32,height/32),Ft("rcorner",width-height/32-width/4-height/32,0,width,height/16)&&($t=Pt("saveData_info",xt)),!1===Bt.trans&&(!0===Bt.side?Bt.sideX+=At(0,Bt.sideX,.2):Bt.sideX+=At(-1,Bt.sideX,.2)),textAlign(LEFT,CENTER),fill($.shade),noStroke(),rectMode(CORNER),rect(width/5*Bt.sideX,height/16,width/5*Bt.sideW,height-height/16),Bt.sideHoverY+=At((Bt.sideHovering+1)*(height/16)+height/16/2,Bt.sideHoverY,.3),Bt.navBox+=At(Bt.sideHovering*(height/16)+22.5,Bt.navBox,.15);for(var t=0;t<Bt.nav.length;t++){mouseX<abs(width/5+width/5*Bt.sideX)&&mouseY>height/16+height/16*t+height/16/2&&mouseY<height/16+height/16*t+(height/16+height/16/2)&&(Bt.sideHovering=t),rectMode(CENTER),fill($.text,255*Bt.sideTextA),push(),translate(width/6*Bt.sideX+width/64,Bt.sideHoverY+height/32),rotate(Bt.navBox),rect(0,0,height/16/4,height/16/4),pop(),push(),drawingContext.globalAlpha=Bt.sideTextA;var i=Bt.screen===Bt.nav[t][1]?$.text:$.textDown,o=(textAlign(LEFT,CENTER),fill(i),Dt(Pt(Bt.nav[t][0],xt),width/6*Bt.sideX+width/32+height/32*1.5,height/8+height/16*t,width/6-width/32*2,height/32),St[Bt.nav[t][2]]),n=new OffscreenCanvas(o.width,o.height).getContext("2d"),s=new p5.Image(n.canvas.width,n.canvas.height);s.canvas=n.canvas,s.ctx=n,s.ctx.fillStyle=i.toString(),s.ctx.fillRect(0,0,n.canvas.width,n.canvas.height),s.ctx.globalCompositeOperation="destination-atop",s.ctx.drawImage(o.canvas,0,0),imageMode(CENTER),Wt(s,"contain",width/6*Bt.sideX+width/32+height/32/2,height/8+height/16*t,height/32,height/32),pop()}},c.song=function(){if(Yo("song"),Bt.song.overlayOn?Bt.song.overlayX+=At(1,Bt.song.overlayX,.2):Bt.song.overlayX+=At(0,Bt.song.overlayX,.2),push(),translate(Bt.song.overlayX*width-width,0),rectMode(CORNER),fill(lerpColor(color($.shade),color($.main),(Bt.song.overlayX*width-width/3)/(width/3*2))),rect(0,height/16,width,height-height/16),"verify"!==Bt.song.mode&&"upload"!==Bt.song.mode){"newSong"===Bt.song.mode&&(fill($.text),textAlign(LEFT,TOP),Dt(Pt("menu_newSong_title",xt),kt,height/16+kt,width-2*kt,height/32*3,"bold"),Wi(Bt.newSong.title,"Title",Pt("menu_newSong_songTitle",xt),3*kt,height/16+height/32*3+3*kt+height/16,width/2,height/16,!1),Wi(Bt.newSong.artist,"Artist",Pt("menu_newSong_songArtist",xt),3*kt,height/16+height/32*3+4*kt+height/16*3,width/2,height/16,!1),fill($.text),Dt(Pt("menu_newSong_songFile",xt),3*kt,height/16+height/32*3+5*kt+height/16*5-height/16/2-kt/1.5,width/2,height/16),Kt(3*kt,height/16+height/32*3+5*kt+height/16*5,width/2,height/16,0===Bt.newSong.link.length?"Upload Audio":Pt("uploadedFile",xt,se("audio"),ne(Bt.newSong.link),ie(oe(Bt.newSong.link)??0),ie(Bt.newSong.sizeLimit)),Bt.song.buttonHover,7)),Kt(3*kt,height/16+height/32*3+7*kt+height/16*8,width/8,height/16,Pt("menu_back",xt),Bt.song.buttonHover,4),Kt(4*kt+width/8,height/16+height/32*3+7*kt+height/16*8,width/8,height/16,Pt("menu_account_submit",xt),Bt.song.buttonHover,5),0<Bt.song.errors.length||-1!==Bt.song.blankErrors.indexOf(!0)||-1!==Bt.account.takenErrors.indexOf(!0)?Bt.song.errorY+=At(1,Bt.song.errorY,.2):Bt.song.errorY+=At(0,Bt.song.errorY,.2);var e=!1,t=!1,i=!1,o=!1;dn(),Bt.song.blankErrors[0]&&(e=Pt("menu_account_error_fieldBlank",xt)),Bt.song.blankErrors[1]&&(t=Pt("menu_account_error_fieldBlank",xt)),-1!==Bt.song.errors.indexOf("invalidFile")?i=Pt("menu_newSong_error_invalidFile",xt):Bt.song.blankErrors[2]&&(i=Pt("menu_account_error_fieldBlank",xt)),Bt.song.takenErrors[5]&&(o=Pt("menu_account_error_captcha",xt)),push(),translate(width-kt-(width/2-5*kt),height/16+kt),push(),translate(0,height-height*Bt.song.errorY),rectMode(CORNER),fill(0,25),rect(0,0,width/2-5*kt,height-height/16-2*kt,kt),fill(255),textAlign(LEFT,TOP),Dt("Error!",kt,kt,width/2-7*kt,2*kt),textAlign(LEFT,CENTER),imageMode(CORNER),!1!==o?(Wt(St.warning,"stretch",kt,height/16+height/32*3+2*kt,height/16,height/16),Dt(o,2*kt+height/16,height/16+height/32*3+2*kt+height/16/2,width/2-7*kt-(kt+height/16),kt)):(!1!==e&&(Wt(St.warning,"stretch",kt,height/16+height/32*3+2*kt,height/16,height/16),Dt(e,2*kt+height/16,height/16+height/32*3+2*kt+height/16/2,width/2-7*kt-(kt+height/16),kt)),!1!==t&&(Wt(St.warning,"stretch",kt,height/16+height/32*3+3*kt+height/16*2,height/16,height/16),Dt(t,2*kt+height/16,height/16+height/32*3+3*kt+height/16*2+height/16/2,width/2-7*kt-(kt+height/16),kt)),!1!==i&&(Wt(St.warning,"stretch",kt,height/16+height/32*3+4*kt+height/16*4,height/16,height/16),Dt(i,2*kt+height/16,height/16+height/32*3+4*kt+height/16*4+height/16/2,width/2-7*kt-(kt+height/16),kt))),pop(),pop()}else if("verify"===Bt.song.mode)if(Bt.newSong.songObject=soundManager.getSoundById(Bt.newSong.link+"verify"),null===Bt.newSong.songObject||void 0===Bt.newSong.songObject)lo(Bt.newSong.link);else{!1===Bt.newSong.songLoading&&(soundManager.load(Bt.newSong.link+"verify"),Bt.newSong.songLoading=!0);for(var n=0;n<Bt.newSong.failedLinks.length;n++)Bt.newSong.failedLinks[n]===Bt.newSong.link&&(Bt.newSong.failedLinksCheck=!0);textAlign(CENTER,CENTER),3===Bt.newSong.songObject.readyState&&!1===Bt.newSong.failedLinksCheck?(fill($.text),Dt(Pt("menu_newSong_verify_testing",xt,Bt.newSong.artist,Bt.newSong.title),width/2,(height-height/16)/2,width-2*kt,2*kt),Kt(width/16*5-width/4/2,(height-height/16)/4*3,width/4,height/8,Pt("menu_newSong_verify_yes",xt),Bt.song.buttonHover,7),Kt(width/16*11-width/4/2,(height-height/16)/4*3,width/4,height/8,Pt("menu_newSong_verify_no",xt),Bt.song.buttonHover,8),!1===Bt.newSong.songPlaying&&(soundManager.stop("menuMusic"),soundManager.play(Bt.newSong.link+"verify"),soundManager.setVolume(Bt.newSong.link+"verify",Bt.settings.musicVolume),Bt.newSong.songPlaying=!0)):2===Bt.newSong.songObject.readyState||!0===Bt.newSong.failedLinksCheck?(fill($.text),Dt(Pt("menu_newSong_verify_failedFile",xt),width/2,(height-height/16)/2,width-2*kt,2*kt),Kt(width/2-width/4/2,(height-height/16)/4*3,width/4,height/8,Pt("menu_back",xt),Bt.song.buttonHover,7)):(fill($.text),Dt(Pt("menu_newSong_verify_downloadingFile",xt),width/2,(height-height/16)/2,width-2*kt,2*kt))}else"upload"===Bt.song.mode&&(textAlign(CENTER,CENTER),!1===Bt.newSong.uploaded?(fill($.text),Dt(Pt("menu_newSong_uploading",xt,Bt.newSong.artist,Bt.newSong.title),width/2,(height-height/16)/2,width-2*kt,2*kt)):(fill($.text),Dt(Pt("menu_newSong_uploaded",xt,Bt.newSong.artist,Bt.newSong.title,Bt.newSong.uploadID),width/2,(height-height/16)/2,width-2*kt,2*kt),Kt(width/2-width/4/2,(height-height/16)/4*3,width/4,height/8,Pt("menu_back",xt),Bt.song.buttonHover,7)));pop()},c.account.signedIn=function(){wo(T.uuid,"self")},c.account.countryScreen=function(){textAlign(LEFT,CENTER);var e=width>height?width/64:height/64;if(0!==Mt()&&(Bt.account.countryScroll-=height/12/2*(Mt()/100)),Vt*=.25,Bt.account.countryScroll=constrain(Bt.account.countryScroll,-(height/16+e+2*e*floor((Object.keys(D.enC).length-1)/3)+e)+height-2*e,0),push(),translate(0,Bt.account.countryScroll),void 0===Me[xt]){Me[xt]=[];for(var t=0;t<Object.keys(D.enC).length;t++)Me[xt].push([W(Object.keys(D.enC)[t],xt),Object.keys(D.enC)[t]]);Me[xt].sort()}for(t=0;t<Me[xt].length;t++)height/16+e+2*e*floor(t/3)+e+Bt.account.countryScroll>2*-e&&height/16+e+2*e*floor(t/3)+e+Bt.account.countryScroll<height+2*e&&(Ft("rcorner",((width-9*e)/3+3*e)*(t%3)-((width-9*e)/3+3*e)/3,height/16+e+2*e*floor(t/3)+Bt.account.countryScroll,width-9*e+3*e,2*e)&&(Bt.account.countrySel=t),fill(255),Dt(W(Me[xt][t][1],xt),2*e+((width-9*e)/3+3*e)*(t%3),height/16+e+2*e*floor(t/3)+e,(width-9*e)/3,2*e));Bt.account.countrySelX+=At(e/2+((width-9*e)/3+3*e)*(Bt.account.countrySel%3),Bt.account.countrySelX,.3),Bt.account.countrySelY+=At(height/16+e+2*e*floor(Bt.account.countrySel/3)+e/2,Bt.account.countrySelY,.3),push(),fill(255),rectMode(CENTER),translate(Bt.account.countrySelX+e/2,Bt.account.countrySelY+e/2),rotate(Bt.account.countrySelX+Bt.account.countrySelY),rect(0,0,e,e),pop(),pop()},c.account.friendsScreen=function(){!1===Bt.account.viewFriend?Co(Bt.account.friendsScreen):wo(Bt.account.viewFriend,"public")},c.account.signedOut=function(){var e=width>height?width/64:height/64,t=(fill($.text),textAlign(LEFT,TOP),Dt(Pt("menu_account_greeting",xt,Pt("defaultUsername",xt)),e,height/16+e,width-2*e,height/32*3,"bold"),Kt(e,height/16+height/32*3+2*e,width/4,height/8,Pt("menu_account_signup",xt),Bt.account.buttonHover,0),Kt(e,height/16+height/32*3+height/8+3*e,width/4,height/8,Pt("menu_account_login",xt),Bt.account.buttonHover,1),Kt(e,height/16+height/32*3+height/8*2+4*e,width/4,height/8,Pt("menu_account_resetPassword",xt),Bt.account.buttonHover,4),Bt.account.resetPassComplete&&(fill(255),textAlign(LEFT,CENTER),Dt(Pt("menu_account_resetPasswordComplete",xt),e,height/16+height/32*3+height/8*3+5*e+height/8/2,width/4,height/8)),Bt.account.overlayOn?Bt.account.overlayX+=At(1,Bt.account.overlayX,.2):Bt.account.overlayX+=At(0,Bt.account.overlayX,.2),push(),translate(Bt.account.overlayX*width-width,0),rectMode(CORNER),fill(lerpColor(color($.shade),color($.main),(Bt.account.overlayX*width-width/3)/(width/3*2))),rect(0,height/16,width,height-height/16),"signup"===Bt.account.mode?(fill($.text),textAlign(LEFT,TOP),Dt(Pt("menu_account_signup",xt),e,height/16+e,width-2*e,height/32*3,"bold"),Wi(Bt.account.user,Pt("defaultUsername",xt),Pt("menu_account_username",xt),3*e,height/16+height/32*3+3*e+height/16,width/2,height/16,!1),Wi(Bt.account.email,"example@email.com",Pt("menu_account_email",xt),3*e,height/16+height/32*3+4*e+height/16*3,width/2,height/16,!1),Wi(Bt.account.pass,Pt("menu_account_password",xt),Pt("menu_account_password",xt),3*e,height/16+height/32*3+5*e+height/16*5,width/2,height/16,"password"),Wi(Bt.account.passConf,Pt("menu_account_password",xt),Pt("menu_account_passwordConfirm",xt),3*e,height/16+height/32*3+6*e+height/16*7,width/2,height/16,"password")):"login"===Bt.account.mode?(fill($.text),textAlign(LEFT,TOP),Dt(Pt("menu_account_login",xt),e,height/16+e,width-2*e,height/32*3,"bold"),Wi(Bt.account.email,"example@email.com",Pt("menu_account_email",xt),3*e,height/16+height/32*3+3*e+height/16,width/2,height/16,!1),Wi(Bt.account.pass,Pt("menu_account_password",xt),Pt("menu_account_password",xt),3*e,height/16+height/32*3+4*e+height/16*3,width/2,height/16,"password")):"resetPassword"===Bt.account.mode?(fill($.text),textAlign(LEFT,TOP),Dt(Pt("menu_account_resetPassword",xt),e,height/16+e,width-2*e,height/32*3,"bold"),Wi(Bt.account.user,Pt("defaultUsername",xt),Pt("menu_account_username",xt),3*e,height/16+height/32*3+3*e+height/16,width/2,height/16,!1),Wi(Bt.account.email,"example@email.com",Pt("menu_account_email",xt),3*e,height/16+height/32*3+4*e+height/16*3,width/2,height/16,!1)):"haveCode"===Bt.account.mode?(fill($.text),textAlign(LEFT,TOP),Dt(Pt("menu_account_resetPassword",xt),e,height/16+e,width-2*e,height/32*3,"bold"),Wi(Bt.account.code,"######",Pt("menu_account_code",xt),3*e,height/16+height/32*3+3*e+height/16,width/2,height/16,!1),fill(255),Dt("Please check your email for a password reset code!",3*e,height/16+height/32*3+4*e+height/16*3,width/2,height/16)):"resetPasswordConf"===Bt.account.mode&&(fill($.text),textAlign(LEFT,TOP),Dt(Pt("menu_account_resetPasswordConf",xt,Ut(Bt.account.codeUuid,"uuid").user),e,height/16+e,2*e+width/2,height/32*3,"bold"),Wi(Bt.account.pass,Pt("menu_account_password",xt),Pt("menu_account_passwordNew",xt),3*e,height/16+height/32*3+3*e+height/16,width/2,height/16,"password"),Wi(Bt.account.passConf,Pt("menu_account_password",xt),Pt("menu_account_passwordConfirm",xt),3*e,height/16+height/32*3+4*e+height/16*3,width/2,height/16,"password")),Kt(3*e,height/16+height/32*3+7*e+height/16*8,width/8,height/16,Pt("menu_back",xt),Bt.account.buttonHover,2),Kt(4*e+width/8,height/16+height/32*3+7*e+height/16*8,width/8,height/16,Pt("menu_account_submit",xt),Bt.account.buttonHover,3),"resetPassword"===Bt.account.mode&&Kt(5*e+width/8*2,height/16+height/32*3+7*e+height/16*8,width/2-2*e-width/8*2,height/16,Pt("menu_account_haveCode",xt),Bt.account.buttonHover,6),0<Bt.account.errors.length||-1!==Bt.account.blankErrors.indexOf(!0)||-1!==Bt.account.takenErrors.indexOf(!0)?Bt.account.errorY+=At(1,Bt.account.errorY,.2):Bt.account.errorY+=At(0,Bt.account.errorY,.2),!1),i=!1,o=!1,n=!1,s=0,r=!1,h=!1,a=!1;ln(),-1!==Bt.account.errors.indexOf("usernameLength")?t=Pt("menu_account_error_usernameLength",xt):-1!==Bt.account.errors.indexOf("usernameCharacters")?t=Pt("menu_account_error_usernameCharacters",xt):Bt.account.blankErrors[0]?t=Pt("menu_account_error_fieldBlank",xt):Bt.account.takenErrors[0]&&"signup"===Bt.account.mode?t=Pt("menu_account_error_usernameTaken",xt):Bt.account.takenErrors[0]&&"resetPassword"===Bt.account.mode&&(t=Pt("menu_account_error_couldntFindAccount",xt)),-1!==Bt.account.errors.indexOf("invalidEmail")?i=Pt("menu_account_error_invalidEmail",xt):Bt.account.blankErrors[1]?i=Pt("menu_account_error_fieldBlank",xt):Bt.account.takenErrors[1]&&"signup"===Bt.account.mode?i=Pt("menu_account_error_emailTaken",xt):Bt.account.takenErrors[1]&&"login"===Bt.account.mode&&(i=Pt("menu_account_error_emailNotTaken",xt)),Bt.account.blankErrors[2]?r=Pt("menu_account_error_fieldBlank",xt):Bt.account.takenErrors[2]&&"resetPasswordConf"!==Bt.account.mode?r=Pt("menu_account_error_incorrectPassword",xt):Bt.account.takenErrors[2]&&(r=Pt("menu_account_error_unexpected",xt)),-1!==Bt.account.errors.indexOf("passwordConfFail")?o=Pt("menu_account_error_passwordConfirmation",xt):Bt.account.blankErrors[3]&&(o=Pt("menu_account_error_fieldBlank",xt)),s=0,Bt.account.pass.match(/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^&\*])(?=.{12,})/g)?n=Pt("menu_account_passwordStrength",xt,Pt("menu_account_passwordStrength_strong",xt)):Bt.account.pass.match(/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})/g)?(n=Pt("menu_account_passwordStrength",xt,Pt("menu_account_passwordStrength_medium",xt)),s=2):0<Bt.account.pass.length&&(n=Pt("menu_account_passwordStrength",xt,Pt("menu_account_passwordStrength_weak",xt)),s=1),Bt.account.blankErrors[4]?h=Pt("menu_account_error_fieldBlank",xt):Bt.account.takenErrors[4]&&(h=Pt("menu_account_error_invalidCode",xt)),Bt.account.takenErrors[5]&&(a=Pt("menu_account_error_captcha",xt)),push(),translate(width-e-(width/2-5*e),height/16+e),push(),translate(0,height-height*Bt.account.errorY),rectMode(CORNER),fill(0,25),rect(0,0,width/2-5*e,height-height/16-2*e,e),fill(255),textAlign(LEFT,TOP),Dt("Error!",e,e,width/2-7*e,2*e),textAlign(LEFT,CENTER),!1!==a?(Wt(St.warning,"stretch",e,height/16+height/32*3+2*e,height/16,height/16),Dt(a,2*e+height/16,height/16+height/32*3+2*e+height/16/2,width/2-7*e-(e+height/16),e)):"signup"===Bt.account.mode?(!1!==t&&(Wt(St.warning,"stretch",e,height/16+height/32*3+2*e,height/16,height/16),Dt(t,2*e+height/16,height/16+height/32*3+2*e+height/16/2,width/2-7*e-(e+height/16),e)),!1!==i&&(Wt(St.warning,"stretch",e,height/16+height/32*3+3*e+height/16*2,height/16,height/16),Dt(i,2*e+height/16,height/16+height/32*3+3*e+height/16*2+height/16/2,width/2-7*e-(e+height/16),e)),!1!==r&&(Wt(St.warning,"stretch",e,height/16+height/32*3+4*e+height/16*4,height/16,height/16),Dt(r,2*e+height/16,height/16+height/32*3+4*e+height/16*4+height/16/2,width/2-7*e-(e+height/16),e)),!1!==o&&(Wt(St.warning,"stretch",e,height/16+height/32*3+5*e+height/16*6,height/16,height/16),Dt(o,2*e+height/16,height/16+height/32*3+5*e+height/16*6+height/16/2,width/2-7*e-(e+height/16),e))):"login"===Bt.account.mode?(!1!==i&&(Wt(St.warning,"stretch",e,height/16+height/32*3+2*e,height/16,height/16),Dt(i,2*e+height/16,height/16+height/32*3+2*e+height/16/2,width/2-7*e-(e+height/16),e)),!1!==r&&(Wt(St.warning,"stretch",e,height/16+height/32*3+3*e+height/16*2,height/16,height/16),Dt(r,2*e+height/16,height/16+height/32*3+3*e+height/16*2+height/16/2,width/2-7*e-(e+height/16),e))):"resetPassword"===Bt.account.mode?(!1!==t&&(Wt(St.warning,"stretch",e,height/16+height/32*3+2*e,height/16,height/16),Dt(t,2*e+height/16,height/16+height/32*3+2*e+height/16/2,width/2-7*e-(e+height/16),e)),!1!==i&&(Wt(St.warning,"stretch",e,height/16+height/32*3+3*e+height/16*2,height/16,height/16),Dt(i,2*e+height/16,height/16+height/32*3+3*e+height/16*2+height/16/2,width/2-7*e-(e+height/16),e))):"haveCode"===Bt.account.mode?!1!==h&&(Wt(St.warning,"stretch",e,height/16+height/32*3+2*e,height/16,height/16),Dt(h,2*e+height/16,height/16+height/32*3+2*e+height/16/2,width/2-7*e-(e+height/16),e)):"resetPasswordConf"===Bt.account.mode&&(!1!==r&&(Wt(St.warning,"stretch",e,height/16+height/32*3+2*e,height/16,height/16),Dt(r,2*e+height/16,height/16+height/32*3+2*e+height/16/2,width/2-7*e-(e+height/16),e)),!1!==o)&&(Wt(St.warning,"stretch",e,height/16+height/32*3+3*e+height/16*2,height/16,height/16),Dt(o,2*e+height/16,height/16+height/32*3+3*e+height/16*2+height/16/2,width/2-7*e-(e+height/16),e)),pop(),textAlign(LEFT,CENTER),fill(255),!1===n||r||("signup"===Bt.account.mode?(Wt(0===s?St.check:1===s?St.warningRed:St.warningOrange,"stretch",e,height/16+height/32*3+4*e+height/16*4,height/16,height/16),Dt(n,2*e+height/16,height/16+height/32*3+4*e+height/16*4+height/16/2,width/2-7*e-(e+height/16),e)):"resetPasswordConf"===Bt.account.mode&&(Wt(0===s?St.check:1===s?St.warningRed:St.warningOrange,"stretch",e,height/16+height/32*3+2*e,height/16,height/16),Dt(n,2*e+height/16,height/16+height/32*3+2*e+height/16/2,width/2-7*e-(e+height/16),e))),pop(),pop()};